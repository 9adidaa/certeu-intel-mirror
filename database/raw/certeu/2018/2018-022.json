{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2018-022.pdf"
  },
  "title": "Apache Struts -- Critical Remote Code Execution Vulnerability",
  "serial_number": "2018-022",
  "publish_date": "23-08-2018 14:57:00",
  "description": "Semmle researchers discovered and disclosed a critical remote code execution vulnerability (CVE-2018-11776) in the Apache Struts web application framework. That flaw could allow remote attackers to run malicious code on the affected servers.",
  "url_title": "2018-022",
  "content_markdown": "---\ntitle: 'Apache Struts -- Critical Remote Code Execution Vulnerability'\nversion: '1.0'\nnumber: '2018-022'\ndate: 'August 23, 2018'\n---\n\n_History:_\n\n* _23/08/2018 --- v1.0: Initial publication_\n\n# Summary\n\nSemmle researchers discovered and disclosed a critical remote code execution vulnerability (CVE-2018-11776) in the Apache Struts web application framework [1, 2]. That flaw could allow remote attackers to run malicious code on the affected servers.\n\n# Technical Details\n\nApache Struts is a widely used open source framework for developing web applications in the Java programming language. This vulnerability is caused by insufficient validation of user-provided inputs in the core of the Struts framework. The vulnerability is present in the servers that meet specific configuration requirements:\n\n1. The `alwaysSelectFullNamespace` flag is set to true in the Struts configuration (this is done automatically in the case of usage of the popular Struts Convention plugin).\n2. The application uses actions that are configured without specifying a namespace, or with a wildcard namespace. This applies to actions and namespaces specified in the Struts configuration file, but also to actions and namespaces specified in Java code if the Struts Convention plugin is in use [2].\n\n# Products Affected\n\nThe Apache Software Foundation announced that Struts versions 2.3 to 2.3.34 and 2.5 to 2.5.16 are affected.  Unsupported versions of the framework might be also affected.\n\n# Recommendations\n\nUpgrade to Apache Struts version 2.3.35 or 2.5.17.\n\n## Workarounds\n\nVerify that you have set namespace (if applicable) for all defined results in underlying configurations. Also verify that you have set value or action for all url tags in your JSPs. Both are needed only when their upper action(s) configurations have no or wildcard namespace.\n\n**Note:** This is a temporal workaround. The solution is to upgrade to Apache Struts version 2.3.35 or 2.5.17 ASAP because they also contain critical overall proactive security improvements. Moreover, accordingly to the researcher, even if an application is currently not vulnerable, _an inadvertent change to a Struts configuration file may render the application vulnerable in the future._ It is therefore strongly advised to upgrade Struts components [1, 3].\n\n# Exploits\n\nThe exploit can be triggered just by visiting a specially crafted URL on the affected web server, allowing attackers to execute malicious code and eventually take complete control over the targeted server running the vulnerable application [4].\n\n\n# References\n\n[1] <https://semmle.com/news/apache-struts-CVE-2018-11776>\n\n[2] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11776>\n\n[3] <https://cwiki.apache.org/confluence/display/WW/S2-057>\n\n[4] <https://thehackernews.com/2018/08/apache-struts-vulnerability.html>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>23/08/2018 --- v1.0: Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>Semmle researchers discovered and disclosed a critical remote code execution vulnerability (CVE-2018-11776) in the Apache Struts web application framework [1, 2]. That flaw could allow remote attackers to run malicious code on the affected servers.</p><h2 id=\"technical-details\">Technical Details</h2><p>Apache Struts is a widely used open source framework for developing web applications in the Java programming language. This vulnerability is caused by insufficient validation of user-provided inputs in the core of the Struts framework. The vulnerability is present in the servers that meet specific configuration requirements:</p><ol><li>The <code>alwaysSelectFullNamespace</code> flag is set to true in the Struts configuration (this is done automatically in the case of usage of the popular Struts Convention plugin).</li><li>The application uses actions that are configured without specifying a namespace, or with a wildcard namespace. This applies to actions and namespaces specified in the Struts configuration file, but also to actions and namespaces specified in Java code if the Struts Convention plugin is in use [2].</li></ol><h2 id=\"products-affected\">Products Affected</h2><p>The Apache Software Foundation announced that Struts versions 2.3 to 2.3.34 and 2.5 to 2.5.16 are affected. Unsupported versions of the framework might be also affected.</p><h2 id=\"recommendations\">Recommendations</h2><p>Upgrade to Apache Struts version 2.3.35 or 2.5.17.</p><h3 id=\"workarounds\">Workarounds</h3><p>Verify that you have set namespace (if applicable) for all defined results in underlying configurations. Also verify that you have set value or action for all url tags in your JSPs. Both are needed only when their upper action(s) configurations have no or wildcard namespace.</p><p><strong>Note:</strong> This is a temporal workaround. The solution is to upgrade to Apache Struts version 2.3.35 or 2.5.17 ASAP because they also contain critical overall proactive security improvements. Moreover, accordingly to the researcher, even if an application is currently not vulnerable, <em>an inadvertent change to a Struts configuration file may render the application vulnerable in the future.</em> It is therefore strongly advised to upgrade Struts components [1, 3].</p><h2 id=\"exploits\">Exploits</h2><p>The exploit can be triggered just by visiting a specially crafted URL on the affected web server, allowing attackers to execute malicious code and eventually take complete control over the targeted server running the vulnerable application [4].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://semmle.com/news/apache-struts-CVE-2018-11776\">https://semmle.com/news/apache-struts-CVE-2018-11776</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11776\">https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-11776</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://cwiki.apache.org/confluence/display/WW/S2-057\">https://cwiki.apache.org/confluence/display/WW/S2-057</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://thehackernews.com/2018/08/apache-struts-vulnerability.html\">https://thehackernews.com/2018/08/apache-struts-vulnerability.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}