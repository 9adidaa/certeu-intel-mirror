{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-072.pdf"
  },
  "title": "Apache Commons Text Vulnerability",
  "serial_number": "2022-072",
  "publish_date": "19-10-2022 09:00:00",
  "description": "A vulnerability, tracked as CVE-2022-42889 with a CVSS score of 9.8 was found in Apache Commons Text packages in versions 1.5 through 1.9. The affected versions allow an attacker to benefit from a variable interpolation process contained in Apache Commons Text, which can cause properties to be dynamically defined. Server applications are vulnerable to remote code execution (RCE) and unintentional contact with untrusted remote servers",
  "url_title": "2022-072",
  "content_markdown": "---\ntitle: 'Apache Commons Text Vulnerability'\nversion: '1.0'\nnumber: '2022-072'\noriginal_date: 'October 13, 2022'\ndate: 'October 19, 2022'\n---\n\n_History:_\n\n* _19/10/2022 --- v1.0 -- Initial publication_\n  \n# Summary\n\nA vulnerability, tracked as **CVE-2022-42889** with a CVSS score of **9.8** was found in _Apache Commons Text_ packages in versions 1.5 through 1.9. The affected versions allow an attacker to benefit from a variable interpolation process contained in Apache Commons Text, which can cause properties to be dynamically defined. Server applications are vulnerable to remote code execution (RCE) and unintentional contact with untrusted remote servers [1].\n\n# Technical Details\n\nApache Commons Text performs variable interpolation, allowing properties to be dynamically evaluated and expanded. The standard format for interpolation is `${prefix:name}` , where `prefix` is used to locate an instance of **org.apache.commons.text.lookup.StringLookup** that performs the interpolation. Starting with version 1.5 and continuing through 1.9, the set of default Lookup instances included interpolators that could result in arbitrary code execution or contact with remote servers. These lookups are: - `script` - execute expressions using the JVM script execution engine (`javax.script`) - `dns` - resolve dns records - `url` - load values from urls, including from remote servers Applications using the interpolation defaults in the affected versions may be vulnerable to remote code execution or unintentional contact with remote servers if untrusted configuration values are used [2, 3].\n\n# Affected Products\n\n* Apache Commons Text version 1.5 to 1.9\n\n# Recommendations\n\nCERT-EU recommends upgrading to Apache Commons Text 1.10.0, which disables the problematic interpolators by default. \nIf the setting has to be ON, text input should be accepted from trusted sources only. The flaw may be avoided by ensuring that any external inputs used with the Commons-Text lookup methods are sanitized properly [4].\n\n# References\n\n[1] <https://vulners.com/redhatcve/RH:CVE-2022-42889>\n\n[2] <https://nvd.nist.gov/vuln/detail/CVE-2022-42889#vulnCurrentDescriptionTitle>\n\n[3] <https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om>\n\n[4] <https://access.redhat.com/security/cve/cve-2022-42889>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>19/10/2022 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>A vulnerability, tracked as <strong>CVE-2022-42889</strong> with a CVSS score of <strong>9.8</strong> was found in <em>Apache Commons Text</em> packages in versions 1.5 through 1.9. The affected versions allow an attacker to benefit from a variable interpolation process contained in Apache Commons Text, which can cause properties to be dynamically defined. Server applications are vulnerable to remote code execution (RCE) and unintentional contact with untrusted remote servers [1].</p><h2 id=\"technical-details\">Technical Details</h2><p>Apache Commons Text performs variable interpolation, allowing properties to be dynamically evaluated and expanded. The standard format for interpolation is <code>${prefix:name}</code> , where <code>prefix</code> is used to locate an instance of <strong>org.apache.commons.text.lookup.StringLookup</strong> that performs the interpolation. Starting with version 1.5 and continuing through 1.9, the set of default Lookup instances included interpolators that could result in arbitrary code execution or contact with remote servers. These lookups are: - <code>script</code> - execute expressions using the JVM script execution engine (<code>javax.script</code>) - <code>dns</code> - resolve dns records - <code>url</code> - load values from urls, including from remote servers Applications using the interpolation defaults in the affected versions may be vulnerable to remote code execution or unintentional contact with remote servers if untrusted configuration values are used [2, 3].</p><h2 id=\"affected-products\">Affected Products</h2><ul><li>Apache Commons Text version 1.5 to 1.9</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends upgrading to Apache Commons Text 1.10.0, which disables the problematic interpolators by default. If the setting has to be ON, text input should be accepted from trusted sources only. The flaw may be avoided by ensuring that any external inputs used with the Commons-Text lookup methods are sanitized properly [4].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://vulners.com/redhatcve/RH:CVE-2022-42889\">https://vulners.com/redhatcve/RH:CVE-2022-42889</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-42889#vulnCurrentDescriptionTitle\">https://nvd.nist.gov/vuln/detail/CVE-2022-42889#vulnCurrentDescriptionTitle</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om\">https://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://access.redhat.com/security/cve/cve-2022-42889\">https://access.redhat.com/security/cve/cve-2022-42889</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}