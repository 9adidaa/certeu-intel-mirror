{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-034.pdf"
  },
  "title": "UPDATE: Multiple Critical Vulnerabilities in Microsoft Products",
  "serial_number": "2022-034",
  "publish_date": "11-05-2022 13:53:00",
  "description": "On May 11th, Microsoft issued May 2022 Patch Tuesday including fixes for three zero-day vulnerabilities and 75 flaws. Among the zero-days, the vulnerability tracked as CVE-2022-26925 is actively exploited in the wild. It is a new NTLM Relay Attack using an LSARPC flaw, allowing an unauthenticated attacker to coerce the domain controller to authenticate to the attacker using NTLM. The two other zero-days are a denial of service vulnerability in Hyper-V, tracked as CVE-2022-22713, and new remote code execution vulnerability in Azure Synapse and Azure Data Factory, tracked as CVE-2022-29972 and presented in CERT-EU Security Advisory 2022-033.<br>Out of the 75 flaws, eight are classified as Critical, allowing remote code execution or elevation of privilege. These vulnerabilities affect a lot of different Microsoft components, including Excel, Windows LDAP, Remote Desktop Protocol, LSA and others.<br>Bleepingcomputer released a full report, listing all the vulnerabilites assessed by Microsoft Security Updates, and giving a description of each vulnerability and also the systems that it affects.<br>On May 13, additional information became available about authentication issues followed by the installation of the patches on Domain Controller servers. However, on May 19, the issue related to authentication failures of Domain Controlers was resolved in out-of-band updates. Please see the [Recommendations] section of this advisory for details.",
  "url_title": "2022-034",
  "content_markdown": "---\ntitle: 'Multiple Critical Vulnerabilities in Microsoft Products'\nversion: '1.2'\nnumber: '2022-034'\ndate: 'May 20, 2022'\n---\n\n_History:_\n\n* _11/05/2022 --- v1.0 -- Initial publication_\n* _17/05/2022 --- v1.1 -- Updated with information about issues with Domain Controllers_\n* _20/05/2022 --- v1.2 -- Updated about resolved issues with Domain Controllers_\n\n# Summary\n\nOn May 11th, Microsoft issued May 2022 Patch Tuesday including fixes for three zero-day vulnerabilities and 75 flaws. Among the zero-days, the vulnerability tracked as CVE-2022-26925 [5] is actively exploited in the wild. It is a new NTLM Relay Attack using an LSARPC flaw, allowing an unauthenticated attacker to coerce the domain controller to authenticate to the attacker using NTLM [1]. The two other zero-days are a denial of service vulnerability in Hyper-V, tracked as CVE-2022-22713 [6], and new remote code execution vulnerability in Azure Synapse and Azure Data Factory, tracked as CVE-2022-29972 [7] and presented in CERT-EU Security Advisory 2022-033 [2].\n\nOut of the 75 flaws, eight are classified as **Critical**, allowing remote code execution or elevation of privilege. These vulnerabilities affect a lot of different Microsoft components, including Excel, Windows LDAP, Remote Desktop Protocol, LSA and others [1].\n\nBleepingcomputer released a full report, listing all the vulnerabilites assessed by Microsoft Security Updates, and giving a description of each vulnerability and also the systems that it affects [3].\n\nOn May 13, additional information became available about authentication issues followed by the installation of the patches on Domain Controller servers. However, on May 19, the issue related to authentication failures of Domain Controlers was resolved in out-of-band updates [12]. Please see the [Recommendations] section of this advisory for details. \n\n# Technical Details\n\nFew technical details have been released by Microsoft. We refer the interested readers to the sources in the references [1-7].\n\n# Affected products\n\nThe list of affected products is following: \n\n- .NET and Visual Studio\n- .NET Framework\n- Azure SHIR\n- Microsoft Exchange Server\n- Microsoft Graphics Component\n- Microsoft Local Security Authority Server (lsasrv)\n- Microsoft Office\n- Microsoft Office Excel\n- Microsoft Office SharePoint\n- Microsoft Windows ALPC\n- Remote Desktop Client\n- Role: Windows Fax Service\n- Role: Windows Hyper-V\n- Self-hosted Integration Runtime\n- Tablet Windows User Interface\n- Visual Studio\n- Visual Studio Code\n- Windows Active Directory\n- Windows Address Book\n- Windows Authentication Methods\n- Windows BitLocker\n- Windows Cluster Shared Volume (CSV)\n- Windows Failover Cluster Automation Server\n- Windows Kerberos\n- Windows Kernel\n- Windows LDAP - Lightweight Directory Access Protocol\n- Windows Media\n- Windows Network File System\n- Windows NTFS\n- Windows Point-to-Point Tunnelling Protocol\n- Windows Print Spooler Components\n- Windows Push Notifications\n- Windows Remote Access Connection Manager\n- Windows Remote Desktop\n- Windows Remote Procedure Call Runtime\n- Windows Server Service\n- Windows Storage Spaces Controller\n- Windows WLAN Auto Config Service\n\n# Recommendations\n\nMicrosoft strongly recommends to install security updates as soon as possible on client Windows devices and non-Domain Controller Windows Servers. \n\nOn May 13, CISA warned not to install May Windows update on domain controllers, because it might create authentication failures on the server or client for some services [8]. The patches for the two elevations privilege vulnerabilites in Windows Kerberos and Active Directory Domain Services, respectively tracked as CVE-2022-26931 and CVE-2022-26923, are responsible for this service authentication problems once deployed on Windows Server Domain Controlers [9]. However, CISA noted that the application of the updates released by Microsoft will not cause issues on Windows client and non-domain controller server [8].\n\nAccording to Microsoft, however, regarding Windows Server Domain Controlers, if the patch has been applied, Microsoft recommends to manually map the certificates to a machine account in Active Directory [10, 11]. This is needed until Microsoft issues an official update to address this services authentication problems caused by the security update.\n\nOn May 19, Microsoft resolved the issue in out-of-band updates for installation on Domain Controllers. There is no action needed on the client side to resolve authentication issue of Domain Controllers. If you used any workaround or mitigation for this issue, they are no longer needed, and Microsoft recommends you to remove them [12]. \n\nAdditionally, regarding CVE-2022-26925, Microsoft recommends to read the PetitPotam NTLM relay advisory [4] to have information on how to mitigate these types of attacks.\n\n# References\n\n[1] <https://www.bleepingcomputer.com/news/microsoft/microsoft-may-2022-patch-tuesday-fixes-3-zero-days-75-flaws/>\n\n[2] <https://media.cert.europa.eu/static/SecurityAdvisories/2022/CERT-EU-SA2022-033.pdf>\n\n[3] <https://www.bleepingcomputer.com/microsoft-patch-tuesday-reports/May-2022.html>\n\n[4] <https://msrc.microsoft.com/update-guide/vulnerability/ADV210003>\n\n[5] <https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-26925>\n\n[6] <https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-22713>\n\n[7] <https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-29972>\n\n[8] <https://www.cisa.gov/uscert/ncas/current-activity/2022/05/13/cisa-temporarily-removes-cve-2022-26925-known-exploited>\n\n[9] <https://www.bleepingcomputer.com/news/security/cisa-warns-not-to-install-may-windows-updates-on-domain-controllers>\n\n[10] <https://docs.microsoft.com/en-us/windows/release-health/status-windows-11-21h2#you-might-see-authentication-failures-on-the-server-or-client-for-services>\n\n[11] <https://support.microsoft.com/en-gb/topic/kb5014754-certificate-based-authentication-changes-on-windows-domain-controllers-ad2c23b0-15d8-4340-a468-4d4f3b188f16>\n\n[12] <https://docs.microsoft.com/en-us/windows/release-health/status-windows-10-21h2#2826msgdesc>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>11/05/2022 --- v1.0 -- Initial publication</em></li><li><em>17/05/2022 --- v1.1 -- Updated with information about issues with Domain Controllers</em></li><li><em>20/05/2022 --- v1.2 -- Updated about resolved issues with Domain Controllers</em></li></ul><h2 id=\"summary\">Summary</h2><p>On May 11th, Microsoft issued May 2022 Patch Tuesday including fixes for three zero-day vulnerabilities and 75 flaws. Among the zero-days, the vulnerability tracked as CVE-2022-26925 [5] is actively exploited in the wild. It is a new NTLM Relay Attack using an LSARPC flaw, allowing an unauthenticated attacker to coerce the domain controller to authenticate to the attacker using NTLM [1]. The two other zero-days are a denial of service vulnerability in Hyper-V, tracked as CVE-2022-22713 [6], and new remote code execution vulnerability in Azure Synapse and Azure Data Factory, tracked as CVE-2022-29972 [7] and presented in CERT-EU Security Advisory 2022-033 [2].</p><p>Out of the 75 flaws, eight are classified as <strong>Critical</strong>, allowing remote code execution or elevation of privilege. These vulnerabilities affect a lot of different Microsoft components, including Excel, Windows LDAP, Remote Desktop Protocol, LSA and others [1].</p><p>Bleepingcomputer released a full report, listing all the vulnerabilites assessed by Microsoft Security Updates, and giving a description of each vulnerability and also the systems that it affects [3].</p><p>On May 13, additional information became available about authentication issues followed by the installation of the patches on Domain Controller servers. However, on May 19, the issue related to authentication failures of Domain Controlers was resolved in out-of-band updates [12]. Please see the [Recommendations] section of this advisory for details. </p><h2 id=\"technical-details\">Technical Details</h2><p>Few technical details have been released by Microsoft. We refer the interested readers to the sources in the references [1-7].</p><h2 id=\"affected-products\">Affected products</h2><p>The list of affected products is following: </p><ul><li>.NET and Visual Studio</li><li>.NET Framework</li><li>Azure SHIR</li><li>Microsoft Exchange Server</li><li>Microsoft Graphics Component</li><li>Microsoft Local Security Authority Server (lsasrv)</li><li>Microsoft Office</li><li>Microsoft Office Excel</li><li>Microsoft Office SharePoint</li><li>Microsoft Windows ALPC</li><li>Remote Desktop Client</li><li>Role: Windows Fax Service</li><li>Role: Windows Hyper-V</li><li>Self-hosted Integration Runtime</li><li>Tablet Windows User Interface</li><li>Visual Studio</li><li>Visual Studio Code</li><li>Windows Active Directory</li><li>Windows Address Book</li><li>Windows Authentication Methods</li><li>Windows BitLocker</li><li>Windows Cluster Shared Volume (CSV)</li><li>Windows Failover Cluster Automation Server</li><li>Windows Kerberos</li><li>Windows Kernel</li><li>Windows LDAP - Lightweight Directory Access Protocol</li><li>Windows Media</li><li>Windows Network File System</li><li>Windows NTFS</li><li>Windows Point-to-Point Tunnelling Protocol</li><li>Windows Print Spooler Components</li><li>Windows Push Notifications</li><li>Windows Remote Access Connection Manager</li><li>Windows Remote Desktop</li><li>Windows Remote Procedure Call Runtime</li><li>Windows Server Service</li><li>Windows Storage Spaces Controller</li><li>Windows WLAN Auto Config Service</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>Microsoft strongly recommends to install security updates as soon as possible on client Windows devices and non-Domain Controller Windows Servers. </p><p>On May 13, CISA warned not to install May Windows update on domain controllers, because it might create authentication failures on the server or client for some services [8]. The patches for the two elevations privilege vulnerabilites in Windows Kerberos and Active Directory Domain Services, respectively tracked as CVE-2022-26931 and CVE-2022-26923, are responsible for this service authentication problems once deployed on Windows Server Domain Controlers [9]. However, CISA noted that the application of the updates released by Microsoft will not cause issues on Windows client and non-domain controller server [8].</p><p>According to Microsoft, however, regarding Windows Server Domain Controlers, if the patch has been applied, Microsoft recommends to manually map the certificates to a machine account in Active Directory [10, 11]. This is needed until Microsoft issues an official update to address this services authentication problems caused by the security update.</p><p>On May 19, Microsoft resolved the issue in out-of-band updates for installation on Domain Controllers. There is no action needed on the client side to resolve authentication issue of Domain Controllers. If you used any workaround or mitigation for this issue, they are no longer needed, and Microsoft recommends you to remove them [12]. </p><p>Additionally, regarding CVE-2022-26925, Microsoft recommends to read the PetitPotam NTLM relay advisory [4] to have information on how to mitigate these types of attacks.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/microsoft/microsoft-may-2022-patch-tuesday-fixes-3-zero-days-75-flaws/\">https://www.bleepingcomputer.com/news/microsoft/microsoft-may-2022-patch-tuesday-fixes-3-zero-days-75-flaws/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://media.cert.europa.eu/static/SecurityAdvisories/2022/CERT-EU-SA2022-033.pdf\">https://media.cert.europa.eu/static/SecurityAdvisories/2022/CERT-EU-SA2022-033.pdf</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/microsoft-patch-tuesday-reports/May-2022.html\">https://www.bleepingcomputer.com/microsoft-patch-tuesday-reports/May-2022.html</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc.microsoft.com/update-guide/vulnerability/ADV210003\">https://msrc.microsoft.com/update-guide/vulnerability/ADV210003</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-26925\">https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-26925</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-22713\">https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-22713</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-29972\">https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2022-29972</a></p><p>[8] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.cisa.gov/uscert/ncas/current-activity/2022/05/13/cisa-temporarily-removes-cve-2022-26925-known-exploited\">https://www.cisa.gov/uscert/ncas/current-activity/2022/05/13/cisa-temporarily-removes-cve-2022-26925-known-exploited</a></p><p>[9] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/cisa-warns-not-to-install-may-windows-updates-on-domain-controllers\">https://www.bleepingcomputer.com/news/security/cisa-warns-not-to-install-may-windows-updates-on-domain-controllers</a></p><p>[10] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.microsoft.com/en-us/windows/release-health/status-windows-11-21h2#you-might-see-authentication-failures-on-the-server-or-client-for-services\">https://docs.microsoft.com/en-us/windows/release-health/status-windows-11-21h2#you-might-see-authentication-failures-on-the-server-or-client-for-services</a></p><p>[11] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.microsoft.com/en-gb/topic/kb5014754-certificate-based-authentication-changes-on-windows-domain-controllers-ad2c23b0-15d8-4340-a468-4d4f3b188f16\">https://support.microsoft.com/en-gb/topic/kb5014754-certificate-based-authentication-changes-on-windows-domain-controllers-ad2c23b0-15d8-4340-a468-4d4f3b188f16</a></p><p>[12] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.microsoft.com/en-us/windows/release-health/status-windows-10-21h2#2826msgdesc\">https://docs.microsoft.com/en-us/windows/release-health/status-windows-10-21h2#2826msgdesc</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}