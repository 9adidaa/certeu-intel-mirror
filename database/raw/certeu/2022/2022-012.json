{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-012.pdf"
  },
  "title": "UPDATE: Critical Vulnerabilities in PHP Everywhere WordPress Plugin",
  "serial_number": "2022-012",
  "publish_date": "10-02-2022 18:50:00",
  "description": "On January 4th, researchers found three critical ‘PHP Everywhere’ plugin for WordPress. These vulnerabilities identified as \"CVE-2022-24663\", \"CVE-2022-24664\" and\"CVE-2022-24665\" affect many WordPress sites and can lead to remote code execution (RCE) that could be leveraged to achieve a complete site takeover. All three have a CVSS score of 9.9.<br>The vulnerabilities were found on January 4th, but due to the responsible disclosure process, the information about them has been publicly published 30 days after the release of patched version. No proof-of-concept or ongoing exploitation of these vulnerabilities have been observed yet. However, it is highly recommended to apply the patches as soon as possible.",
  "url_title": "2022-012",
  "content_markdown": "---\ntitle: 'Critical Vulnerabilities in PHP Everywhere WordPress Plugin'\nversion: '1.1'\nnumber: '2022-012'\ndate: 'February 11, 2022'\n---\n\n_History:_\n\n* _10/02/2022 --- v1.0 -- Initial publication_\n* _11/02/2022 --- v1.1 -- Fix the links in the references_\n\n\n# Summary\n\nOn January 4th, researchers found three critical ‘PHP Everywhere’ plugin for WordPress. These vulnerabilities identified as `CVE-2022-24663`, `CVE-2022-24664` and`CVE-2022-24665` affect many WordPress sites and can lead to **remote code execution (RCE)** that could be leveraged to achieve a complete site takeover. All three have a CVSS score of 9.9.\n\nThe vulnerabilities were found on January 4th, but due to the responsible disclosure process, the information about them has been publicly published 30 days after the release of patched version. No proof-of-concept or ongoing exploitation of these vulnerabilities have been observed yet. However, it is highly recommended to apply the patches as soon as possible [1].\n\n\n# Technical Details\n\nPHP Everywhere is a plugin that allows WordPress admins to insert PHP code into pages, posts, the sidebar, or any Gutenberg block, and use it to display dynamic content based on evaluated PHP expressions [2].\n\nWith the `CVE-2022-24663` vulnerability, any logged-in user, even a user with almost no permissions, such as a Subscriber or a Customer, is able to execute arbitrary PHP on a site by sending a request with the `shortcode` parameter set to `[php_everywhere]<arbitrary PHP>[/php_everywhere]`.\n\n\nThe `CVE-2022-24664` vulnerability consists of default rights for all users with the `edit_posts` capability to use the PHP Everywhere metabox. This means that untrusted Contributor-level users could use the PHP Everywhere metabox to achieve code execution on a site by creating a post, adding PHP code to the PHP Everywhere metabox, and then previewing the post. While this vulnerability has the same CVSS score as the shortcode vulnerability above, it is less severe, since it requires contributor-level permissions, which imply some degree of trust and are more difficult to obtain than subscriber-level permissions.\n\nThe last vulnerability - `CVE-2022-24665` - is pretty similar to the metabox one but this time with the PHP Everywhere Gutenberg block. Contributor-level users could execute arbitrary PHP code on a site by creating a post, adding the PHP everywhere Gutenberg block and adding code to it, and then previewing the post [1].\n\n# Affected Products\n\nPHP Everywhere plugins versions <= 2.0.3\n\n# Recommendations\n\nA version 3.0.0 of the plugin has been released. Upgrade to this newest version in order to avoid exploitation.\n\n# References\n\n[1] <https://www.wordfence.com/blog/2022/02/critical-vulnerabilities-in-php-everywhere-allow-remote-code-execution/>\n\n[2] <https://www.bleepingcomputer.com/news/security/php-everywhere-rce-flaws-threaten-thousands-of-wordpress-sites/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>10/02/2022 --- v1.0 -- Initial publication</em></li><li><em>11/02/2022 --- v1.1 -- Fix the links in the references</em></li></ul><h2 id=\"summary\">Summary</h2><p>On January 4th, researchers found three critical ‘PHP Everywhere’ plugin for WordPress. These vulnerabilities identified as <code>CVE-2022-24663</code>, <code>CVE-2022-24664</code> and<code>CVE-2022-24665</code> affect many WordPress sites and can lead to <strong>remote code execution (RCE)</strong> that could be leveraged to achieve a complete site takeover. All three have a CVSS score of 9.9.</p><p>The vulnerabilities were found on January 4th, but due to the responsible disclosure process, the information about them has been publicly published 30 days after the release of patched version. No proof-of-concept or ongoing exploitation of these vulnerabilities have been observed yet. However, it is highly recommended to apply the patches as soon as possible [1].</p><h2 id=\"technical-details\">Technical Details</h2><p>PHP Everywhere is a plugin that allows WordPress admins to insert PHP code into pages, posts, the sidebar, or any Gutenberg block, and use it to display dynamic content based on evaluated PHP expressions [2].</p><p>With the <code>CVE-2022-24663</code> vulnerability, any logged-in user, even a user with almost no permissions, such as a Subscriber or a Customer, is able to execute arbitrary PHP on a site by sending a request with the <code>shortcode</code> parameter set to <code>[php_everywhere]&lt;arbitrary PHP&gt;[/php_everywhere]</code>.</p><p>The <code>CVE-2022-24664</code> vulnerability consists of default rights for all users with the <code>edit_posts</code> capability to use the PHP Everywhere metabox. This means that untrusted Contributor-level users could use the PHP Everywhere metabox to achieve code execution on a site by creating a post, adding PHP code to the PHP Everywhere metabox, and then previewing the post. While this vulnerability has the same CVSS score as the shortcode vulnerability above, it is less severe, since it requires contributor-level permissions, which imply some degree of trust and are more difficult to obtain than subscriber-level permissions.</p><p>The last vulnerability - <code>CVE-2022-24665</code> - is pretty similar to the metabox one but this time with the PHP Everywhere Gutenberg block. Contributor-level users could execute arbitrary PHP code on a site by creating a post, adding the PHP everywhere Gutenberg block and adding code to it, and then previewing the post [1].</p><h2 id=\"affected-products\">Affected Products</h2><p>PHP Everywhere plugins versions &lt;= 2.0.3</p><h2 id=\"recommendations\">Recommendations</h2><p>A version 3.0.0 of the plugin has been released. Upgrade to this newest version in order to avoid exploitation.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.wordfence.com/blog/2022/02/critical-vulnerabilities-in-php-everywhere-allow-remote-code-execution/\">https://www.wordfence.com/blog/2022/02/critical-vulnerabilities-in-php-everywhere-allow-remote-code-execution/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/php-everywhere-rce-flaws-threaten-thousands-of-wordpress-sites/\">https://www.bleepingcomputer.com/news/security/php-everywhere-rce-flaws-threaten-thousands-of-wordpress-sites/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}