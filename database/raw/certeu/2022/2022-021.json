{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-021.pdf"
  },
  "title": "UPDATE: Critical RCE Vulnerability in Sophos Firewalls",
  "serial_number": "2022-021",
  "publish_date": "28-03-2022 08:28:00",
  "description": "On 25/03/2022, Sophos has fixed a critical vulnerability (CVE-2022-1040) in Sophos firewall product, which allows remote code execution. This vulnerability enables an unauthenticated attacker to gain control over the targeted system. This vulnerability has a score of 9.8 out of 10.<br>[Update] : This vulnerability is currently under active exploitation in the wild.<br>CERT-EU strongly recommends to patch this vulnerability as soon as possible.",
  "url_title": "2022-021",
  "content_markdown": "---\ntitle: 'Critical RCE Vulnerability in Sophos Firewalls'\nversion: '1.1'\nnumber: '2022-021'\ndate: 'March 31, 2022'\n---\n\n_History:_\n\n* _28/03/2022 --- v1.0 -- Initial publication_\n* _31/03/2022 --- v1.1 -- Update about active exploitation_\n  \n# Summary\n\nOn 25/03/2022, Sophos has fixed a critical vulnerability (CVE-2022-1040) [2] in Sophos firewall product, which allows remote code execution. This vulnerability enables an unauthenticated attacker to gain control over the targeted system. This vulnerability has a score of 9.8 out of 10 [1].\n\n_[Update]_ : This vulnerability is currently under **active exploitation** in the wild [3].\n\nCERT-EU strongly recommends to patch this vulnerability **as soon as possible**.\n\n# Technical Details\n\nAn authentication bypass vulnerability allowing remote code execution was discovered in the User Portal and Webadmin of Sophos Firewall and responsibly disclosed to Sophos. The vulnerability was reported to the security firm by an unnamed security researcher via its bug bounty program.\n\n# Affected Products\n\nSophos Firewall v18.5 MR3 (18.5.3) and older.\n\n# Recommendations and Workarounds\n\nSophos released hotfixes that should, by default, reach most instances automatically. _\"There is no action required for Sophos Firewall customers with the \"Allow automatic installation of hotfixes\" feature enabled. Enabled is the default setting.\"_ [4].\n\nBelow is the list of products that have their hotfixes ready to be installed: \n\n- Hotfixes for v17.0 MR10 EAL4+, v17.5 MR16 and MR17, v18.0 MR5(-1) and MR6, v18.5 MR1 and MR2, v18.5 MR3, and v19.0 EAP have been published.\n- Hotfixes for unsupported EOL versions v17.5 MR12 through MR15, v18.0 MR3 and MR4, and v18.5 GA have been published.\n- Fix included in v19.0 GA and v18.5 MR4 (18.5.4)\n- Users of older versions of Sophos Firewall are required to upgrade to receive the latest protections and fix. \n\nIn order to check if the issue has been fixed, Sophos has published an article on their website [5]. \n\nAs a general workaround, it is recommended to protect from external attackers by ensuring that the User Portal and Webadmin are not exposed to the Internet. \n\n# References\n\n[1] <https://nvd.nist.gov/vuln/detail/CVE-2022-1040>\n\n[2] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1040>\n\n[3] <https://thehackernews.com/2022/03/critical-sophos-firewall-rce.html>\n\n[4] <https://www.sophos.com/en-us/security-advisories/sophos-sa-20220325-sfos-rce>\n\n[5] <https://support.sophos.com/support/s/article/KB-000043853?language=en_US>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>28/03/2022 --- v1.0 -- Initial publication</em></li><li><em>31/03/2022 --- v1.1 -- Update about active exploitation</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 25/03/2022, Sophos has fixed a critical vulnerability (CVE-2022-1040) [2] in Sophos firewall product, which allows remote code execution. This vulnerability enables an unauthenticated attacker to gain control over the targeted system. This vulnerability has a score of 9.8 out of 10 [1].</p><p><em>[Update]</em> : This vulnerability is currently under <strong>active exploitation</strong> in the wild [3].</p><p>CERT-EU strongly recommends to patch this vulnerability <strong>as soon as possible</strong>.</p><h2 id=\"technical-details\">Technical Details</h2><p>An authentication bypass vulnerability allowing remote code execution was discovered in the User Portal and Webadmin of Sophos Firewall and responsibly disclosed to Sophos. The vulnerability was reported to the security firm by an unnamed security researcher via its bug bounty program.</p><h2 id=\"affected-products\">Affected Products</h2><p>Sophos Firewall v18.5 MR3 (18.5.3) and older.</p><h2 id=\"recommendations-and-workarounds\">Recommendations and Workarounds</h2><p>Sophos released hotfixes that should, by default, reach most instances automatically. <em>\"There is no action required for Sophos Firewall customers with the \"Allow automatic installation of hotfixes\" feature enabled. Enabled is the default setting.\"</em> [4].</p><p>Below is the list of products that have their hotfixes ready to be installed: </p><ul><li>Hotfixes for v17.0 MR10 EAL4+, v17.5 MR16 and MR17, v18.0 MR5(-1) and MR6, v18.5 MR1 and MR2, v18.5 MR3, and v19.0 EAP have been published.</li><li>Hotfixes for unsupported EOL versions v17.5 MR12 through MR15, v18.0 MR3 and MR4, and v18.5 GA have been published.</li><li>Fix included in v19.0 GA and v18.5 MR4 (18.5.4)</li><li>Users of older versions of Sophos Firewall are required to upgrade to receive the latest protections and fix. </li></ul><p>In order to check if the issue has been fixed, Sophos has published an article on their website [5]. </p><p>As a general workaround, it is recommended to protect from external attackers by ensuring that the User Portal and Webadmin are not exposed to the Internet. </p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-1040\">https://nvd.nist.gov/vuln/detail/CVE-2022-1040</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1040\">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1040</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://thehackernews.com/2022/03/critical-sophos-firewall-rce.html\">https://thehackernews.com/2022/03/critical-sophos-firewall-rce.html</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.sophos.com/en-us/security-advisories/sophos-sa-20220325-sfos-rce\">https://www.sophos.com/en-us/security-advisories/sophos-sa-20220325-sfos-rce</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.sophos.com/support/s/article/KB-000043853?language=en_US\">https://support.sophos.com/support/s/article/KB-000043853?language=en_US</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}