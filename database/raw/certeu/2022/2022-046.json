{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-046.pdf"
  },
  "title": "Critical PHP Flaw Exposes QNAP NAS Devices to RCE Attacks",
  "serial_number": "2022-046",
  "publish_date": "22-06-2022 16:36:00",
  "description": "On 22nd of June 2022, QNAP published an advisory about specific products that are vulnerable to remote code execution (RCE) when certain conditions are met. The CVE-2019-11043 is reported to affect PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11. In certain configurations of FPM setup, it is possible to cause FPM module to write past allocated buffers into the space reserved for FCGI protocol data, thus opening the possibility of remote code execution.",
  "url_title": "2022-046",
  "content_markdown": "---\ntitle: 'Critical PHP Flaw Exposes QNAP NAS Devices to RCE Attacks'\nversion: '1.0'\nnumber: '2022-046'\noriginal_date: 'June 22, 2022'\ndate: 'June 22, 2022'\n---\n\n_History:_\n\n* _22/06/2022 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn 22nd of June 2022, QNAP published an advisory [1] about specific products that are vulnerable to remote code execution (RCE) when certain conditions are met. The CVE-2019-11043 is reported to affect PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11. In certain configurations of FPM setup, it is possible to cause FPM module to write past allocated buffers into the space reserved for FCGI protocol data, thus opening the possibility of remote code execution.\n\n# Technical Details\n\nCertain QNAP NAS are vulnerable to RCE when the user has installed and is running `nginx` and `php-fpm`. QTS, QuTS hero or QuTScloud does not have `nginx` installed by default, thus QNAP NAS are not affected by this vulnerability in the default state. If `nginx` is installed by the user and running, then the update should be applied as soon as possible to mitigate associated risks.\n\n# Affected Products\n\nThe vulnerability affects the following QNAP operating system versions:\n\n- QTS 5.0.x and later\n- QTS 4.5.x and later\n- QuTS hero h5.0.x and later\n- QuTS hero h4.5.x and later\n- QuTScloud c5.0.x and later\n\n# Recommendations\n\nQNAP provided advice [2] for available updates and information on how to update the affected products. \n\n# References\n\n[1] <https://www.qnap.com/en/security-advisory/QSA-22-20>\n\n[2] <https://www.qnap.com/en/product/status>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>22/06/2022 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 22nd of June 2022, QNAP published an advisory [1] about specific products that are vulnerable to remote code execution (RCE) when certain conditions are met. The CVE-2019-11043 is reported to affect PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11. In certain configurations of FPM setup, it is possible to cause FPM module to write past allocated buffers into the space reserved for FCGI protocol data, thus opening the possibility of remote code execution.</p><h2 id=\"technical-details\">Technical Details</h2><p>Certain QNAP NAS are vulnerable to RCE when the user has installed and is running <code>nginx</code> and <code>php-fpm</code>. QTS, QuTS hero or QuTScloud does not have <code>nginx</code> installed by default, thus QNAP NAS are not affected by this vulnerability in the default state. If <code>nginx</code> is installed by the user and running, then the update should be applied as soon as possible to mitigate associated risks.</p><h2 id=\"affected-products\">Affected Products</h2><p>The vulnerability affects the following QNAP operating system versions:</p><ul><li>QTS 5.0.x and later</li><li>QTS 4.5.x and later</li><li>QuTS hero h5.0.x and later</li><li>QuTS hero h4.5.x and later</li><li>QuTScloud c5.0.x and later</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>QNAP provided advice [2] for available updates and information on how to update the affected products. </p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.qnap.com/en/security-advisory/QSA-22-20\">https://www.qnap.com/en/security-advisory/QSA-22-20</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.qnap.com/en/product/status\">https://www.qnap.com/en/product/status</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}