{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2017-013.pdf"
  },
  "title": "Privileges Escalation Vulnerabilities in Unix Operating Systems",
  "serial_number": "2017-013",
  "publish_date": "20-06-2017 13:40:00",
  "description": "On 19th of June 2017, Qualys Research Team published a blog post and a security advisory about vulnerabilities in the memory management of several UNIX operating systems. These vulnerabilities can lead to privilege escalation on these systems, by corrupting memory and executing arbitrary code. They named the bug Stack Clash as it exploits flaws in the way these operating system are handling the stack in memory.",
  "url_title": "2017-013",
  "content_markdown": "---\ntitle: 'Privileges Escalation Vulnerabilities inÂ Unix Operating Systems'\nversion: '1.0'\nnumber: '2017-013'\ndate: 'June 20, 2017'\n---\n\n_History:_\n\n* _20/06/2017 --- v1.0: Initial publication_\n\n# Summary\n\nOn 19th of June 2017, Qualys Research Team published a blog post [1] and a security advisory [2] about vulnerabilities in the memory management of several UNIX operating systems. These vulnerabilities can lead to privilege escalation on these systems, by corrupting memory and executing arbitrary code. They named the bug **Stack Clash** as it exploits flaws in the way these operating system are handling the stack in memory.\n\nQualys Research Team validated the exploitation of the **Stack Clash** bug on the following systems: Linux, OpenBSD, NetBSD, FreeBSD, and Solaris, on i386 and amd64 architectures. They worked with vendors to have patches available.\n\n# Technical Details\n\nThe **Stack Clash** bug and other findings discovered by Qualys Research Team received the following CVEs:\n\n * CVE-2017-1000364 - issue in the size of the stack guard page on Linux [3]\n * CVE-2017-1000365 - bypass of size restriction limit for arguments and environmental strings in Linux [4]\n * CVE-2017-1000366 - arbitrary code execution in `glibc` [5]\n * CVE-2017-1000367 - _sudoer-to-root_ exploit [6]\n * CVE-2017-1000369 - arbitrary code execution in Exim [7]\n * CVE-2017-1000370 - local-root exploit against `ld.so` and most SUID-root binaries on i386 Debian, Fedora, and CentOS [8]\n * CVE-2017-1000371 - local-root exploit against `ld.so` and most SUID-root PIEs on i386 Debian, Fedora, and CentOS [9]\n * CVE-2017-1000372 - arbitrary code execution in OpenBSD implementation of the stack guard page [10]\n * CVE-2017-1000373 - stack memory manipulation in OpenBSD `qsort` function [11]\n * CVE-2017-1000374 - arbitrary code execution in NetBSD implementation of the stack guard page [12]\n * CVE-2017-1000375 - memory manipulation and arbitrary code execution in NetBSD [13]\n * CVE-2017-1000376 - arbitrary code execution in `libffi 3.2.1` [14]\n * CVE-2017-1000377 - bypass of stack guard page in PAX Linux kernel [15]\n * CVE-2017-1000378 - memory manipulation and arbitrary code execution in NetBSD via `qsort` function [16]\n * CVE-2017-1000379 - stack manipulation in AMD64 Linux kernel [17]\n\nQualys Research Team decided to answer a question from 2005 regarding the way operating systems manage large memory: _If the heap grows up, and the stack grows down, what happens when they clash? Is it exploitable? How?_. During their research, they exploited such _stack-clashes_, even with protection against such attacks (a _guard-page_ mapped below the stack) implemented in Linux (2010).\n\nThe particularity of the stack is that it will automatically grow when more memory is needed. When it grows to much, part of it can get overwritten by another memory region, leading potentially to code execution and privilege escalation.\n\n# Products Affected\n\n**Impacted:** Most distributions of Linux, OpenBSD, NetBSD, FreeBSD, and Solaris, on i386 oand amd64 architectures.\n\nThese vulnerabilities require at least a local account on the targeted machines and are not remotely exploitable.\n\n# Recommendations\n\nApply patches provided by the vendors on all affected systems.\n\nAs a workaround, local access to affected systems can be restrict, and a hard `RLIMIT_STACK` and `RLIMIT_AS` limits can be set for local users and remote services to some reasonably low values [18].\n\n# References\n\n[1] Qualys Research Team blog post <https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash>\n\n[2] Qualys Security Advisory <https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt>\n\n[3] CVE-2017-1000364 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000364>\n\n[4] CVE-2017-1000365 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000365>\n\n[5] CVE-2017-1000366 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000366>\n\n[6] CVE-2017-1000367 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000367>\n\n[7] CVE-2017-1000369 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000369>\n\n[8] CVE-2017-1000370 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000370>\n\n[9] CVE-2017-1000371 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000371>\n\n[10] CVE-2017-1000372 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000372>\n\n[11] CVE-2017-1000373 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000373>\n\n[12] CVE-2017-1000374 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000374>\n\n[13] CVE-2017-1000375 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000375>\n\n[14] CVE-2017-1000376 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000376>\n\n[15] CVE-2017-1000377 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000377>\n\n[16] CVE-2017-1000378 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000378>\n\n[17] CVE-2017-1000379 <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000379>\n\n[18] Setrlimit manual <https://linux.die.net/man/2/setrlimit>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>20/06/2017 --- v1.0: Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 19th of June 2017, Qualys Research Team published a blog post [1] and a security advisory [2] about vulnerabilities in the memory management of several UNIX operating systems. These vulnerabilities can lead to privilege escalation on these systems, by corrupting memory and executing arbitrary code. They named the bug <strong>Stack Clash</strong> as it exploits flaws in the way these operating system are handling the stack in memory.</p><p>Qualys Research Team validated the exploitation of the <strong>Stack Clash</strong> bug on the following systems: Linux, OpenBSD, NetBSD, FreeBSD, and Solaris, on i386 and amd64 architectures. They worked with vendors to have patches available.</p><h2 id=\"technical-details\">Technical Details</h2><p>The <strong>Stack Clash</strong> bug and other findings discovered by Qualys Research Team received the following CVEs:</p><ul><li>CVE-2017-1000364 - issue in the size of the stack guard page on Linux [3]</li><li>CVE-2017-1000365 - bypass of size restriction limit for arguments and environmental strings in Linux [4]</li><li>CVE-2017-1000366 - arbitrary code execution in <code>glibc</code> [5]</li><li>CVE-2017-1000367 - <em>sudoer-to-root</em> exploit [6]</li><li>CVE-2017-1000369 - arbitrary code execution in Exim [7]</li><li>CVE-2017-1000370 - local-root exploit against <code>ld.so</code> and most SUID-root binaries on i386 Debian, Fedora, and CentOS [8]</li><li>CVE-2017-1000371 - local-root exploit against <code>ld.so</code> and most SUID-root PIEs on i386 Debian, Fedora, and CentOS [9]</li><li>CVE-2017-1000372 - arbitrary code execution in OpenBSD implementation of the stack guard page [10]</li><li>CVE-2017-1000373 - stack memory manipulation in OpenBSD <code>qsort</code> function [11]</li><li>CVE-2017-1000374 - arbitrary code execution in NetBSD implementation of the stack guard page [12]</li><li>CVE-2017-1000375 - memory manipulation and arbitrary code execution in NetBSD [13]</li><li>CVE-2017-1000376 - arbitrary code execution in <code>libffi 3.2.1</code> [14]</li><li>CVE-2017-1000377 - bypass of stack guard page in PAX Linux kernel [15]</li><li>CVE-2017-1000378 - memory manipulation and arbitrary code execution in NetBSD via <code>qsort</code> function [16]</li><li>CVE-2017-1000379 - stack manipulation in AMD64 Linux kernel [17]</li></ul><p>Qualys Research Team decided to answer a question from 2005 regarding the way operating systems manage large memory: <em>If the heap grows up, and the stack grows down, what happens when they clash? Is it exploitable? How?</em>. During their research, they exploited such <em>stack-clashes</em>, even with protection against such attacks (a <em>guard-page</em> mapped below the stack) implemented in Linux (2010).</p><p>The particularity of the stack is that it will automatically grow when more memory is needed. When it grows to much, part of it can get overwritten by another memory region, leading potentially to code execution and privilege escalation.</p><h2 id=\"products-affected\">Products Affected</h2><p><strong>Impacted:</strong> Most distributions of Linux, OpenBSD, NetBSD, FreeBSD, and Solaris, on i386 oand amd64 architectures.</p><p>These vulnerabilities require at least a local account on the targeted machines and are not remotely exploitable.</p><h2 id=\"recommendations\">Recommendations</h2><p>Apply patches provided by the vendors on all affected systems.</p><p>As a workaround, local access to affected systems can be restrict, and a hard <code>RLIMIT_STACK</code> and <code>RLIMIT_AS</code> limits can be set for local users and remote services to some reasonably low values [18].</p><h2 id=\"references\">References</h2><p>[1] Qualys Research Team blog post <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash\">https://blog.qualys.com/securitylabs/2017/06/19/the-stack-clash</a></p><p>[2] Qualys Security Advisory <a rel=\"noopener\" target=\"_blank\" href=\"https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt\">https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt</a></p><p>[3] CVE-2017-1000364 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000364\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000364</a></p><p>[4] CVE-2017-1000365 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000365\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000365</a></p><p>[5] CVE-2017-1000366 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000366\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000366</a></p><p>[6] CVE-2017-1000367 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000367\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000367</a></p><p>[7] CVE-2017-1000369 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000369\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000369</a></p><p>[8] CVE-2017-1000370 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000370\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000370</a></p><p>[9] CVE-2017-1000371 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000371\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000371</a></p><p>[10] CVE-2017-1000372 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000372\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000372</a></p><p>[11] CVE-2017-1000373 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000373\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000373</a></p><p>[12] CVE-2017-1000374 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000374\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000374</a></p><p>[13] CVE-2017-1000375 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000375\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000375</a></p><p>[14] CVE-2017-1000376 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000376\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000376</a></p><p>[15] CVE-2017-1000377 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000377\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000377</a></p><p>[16] CVE-2017-1000378 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000378\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000378</a></p><p>[17] CVE-2017-1000379 <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000379\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000379</a></p><p>[18] Setrlimit manual <a rel=\"noopener\" target=\"_blank\" href=\"https://linux.die.net/man/2/setrlimit\">https://linux.die.net/man/2/setrlimit</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}