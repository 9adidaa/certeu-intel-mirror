{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2017-023.pdf"
  },
  "title": "UPDATE RSA Key Generation Prone to Factorization Attack",
  "serial_number": "2017-023",
  "publish_date": "18-10-2017 10:17:00",
  "description": "A vulnerability (CVE-2017-15361) in the procedure of RSA key generation used by a software library allows a practical factorization attack. As a result it is possible to compute the private part of an RSA key based only on its public part. The vulnerable library is used in cryptographic smartcards, security tokens, and other secure hardware chips manufactured by Infineon Technologies AG. An attack is feasible for commonly used key lengths - including 1024 and 2048 bits - and it<br>affects chips manufactured as early as 2012.",
  "url_title": "2017-023",
  "content_markdown": "---\ntitle: 'RSA Key Generation Prone toÂ Factorization Attack'\nversion: '1.1'\nnumber: '2017-023'\nfontsize: '11pt'\ndate: 'November 7, 2017'\n---\n\n_History:_\n\n* _17/10/2017 --- v1.0 -- Initial publication_\n* _07/11/2017 --- v1.1 -- More efficient ways of attack reported_\n\n\n# Summary\n\nA vulnerability (CVE-2017-15361) [4] in the procedure of RSA key generation used by a software library allows a practical factorization attack. As a result it is possible to compute the private part of an RSA key based only on its public part. The vulnerable library is used in cryptographic smartcards, security tokens, and other secure hardware chips manufactured by Infineon Technologies AG. An attack is feasible for commonly used key lengths -- including 1024 and 2048 bits -- and it affects chips manufactured as early as 2012 [1].\n\n# Technical Details\n\nThe faulty software is the Infineon-developed RSA library version 1.02.013, more specifically the algorithm it implements for RSA primes generation. Only RSA encryption keys are affected, when they were generated on a smartcard or other embedded device using the mentioned software.\n\nFor performance reasons the Infineon library constructs the key pairs underlying prime numbers in a way that the secret key can be deducted from the public key through factorization.\n\nAn RSA key with 2048 bits should require -- when generated properly -- several quadrillion years to be factorized with a general-purpose computer. Factorizing a 2048-bit RSA key generated with the faulty Infineon library, by contrast, takes a maximum of 100 years, and on average only half that. Keys with 1024 bits take a maximum of only three months. The factorization can be dramatically accelerated by spreading the load onto multiple computers. While costs and times vary for each vulnerable key, the worst case for a **2048-bit** one would require no more than **17 days and $40,300** using a 1,000-instance machine on Amazon Web Service and **$76 and 45 minutes** to factorize an affected **1024-bit key**. On average, it would require half the cost and time to factorize the affected keys [1, 2].\n\nThe researchers who discovered the issue are providing also tools [1] to quickly verify if a key is vulnerable. Those tools can be used also, by potential attackers, to asses if the key is exploitable.\n\nThe flaw is the subject of a research paper titled _The Return of Coppersmith's Attack(ROCA): Practical Factorization of Widely Used RSA Moduli_, which will be presented on the 2nd of November 2017 at the ACM Conference on Computer and Communications Security, Dallas, USA. In order to provide time for keys change, the paper describing the factorization method will not be published until the above mentioned conference [2].\n\nA significantly more efficient way of performing the attack was recently announced [9], which could improve the attack in some cases more than **10x**. It can be further improved by using specialized hardware. In the meantime the Estonian authorities reevaluated the threat and decided to update the 760 000 ID cards certificates affected by the vulnerability [10, 11].\n\n# Products Affected\n\nInfineon products can be affected under a specific combination of conditions:\n\n* The acceleration algorithm was used for the key generation.\n* Cryptographic keys have to be generated on a card or token, which uses this algorithm.\n\nProducts that can be affected are typically the TPM (Trusted Platform Modules), e.g. used in professional notebooks, and smartcards for signature applications with self-generated keys. The chip hardware (symmetric and asymmetric co-processors) is not affected [6].\n\nExamples of affected technologies include BitLocker with TPM 1.2, YubiKey 4 PGP key generation, and the Cached User Data encryption feature in Chrome OS, Electronic IDs [2, 5].\n\nThe vulnerability is also present in at least some NIST FIPS 140-2 and CC EAL 5+ certified devices since at least the year 2012 [1].\n\n# Recommendations\n\nVerify with the vendors or with the provided tools [3] if the technologies or keys in use in your organization are affected.  The researchers are providing offline [7], online [3, 8], or email S-MIME/PGP key testers.\n\nVulnerable key pairs and devices should be replaced with secure ones. Major vendors including Microsoft, Google, HP, Lenovo, Fujitsu already released the software updates and guidelines for a mitigation [1].\n\n# References\n\n[1] <https://crocs.fi.muni.cz/public/papers/rsa_ccs17>\n\n[2] <https://arstechnica.com/information-technology/2017/10/crypto-failure-cripples-millions-of-high-security-keys-750k-estonian-ids/>\n\n[3] <https://keychest.net/roca>\n\n[4] <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361>\n\n[5] <https://nvd.nist.gov/vuln/detail/CVE-2017-15361>\n\n[6] <https://www.infineon.com/cms/en/product/promopages/rsa-update/?redirId=59206>\n\n[7] <https://github.com/crocs-muni/roca>\n\n[8] <https://keytester.cryptosense.com>\n\n[9] <https://blog.cr.yp.to/20171105-infineon.html>\n\n[10] <https://arstechnica.com/information-technology/2017/11/flaw-crippling-millions-of-crypto-keys-is-worse-than-first-disclosed/>\n\n[11] <https://medium.com/e-residency-blog/estonia-is-enhancing-the-security-of-its-digital-identities-361b9a3c9c52>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>17/10/2017 --- v1.0 -- Initial publication</em></li><li><em>07/11/2017 --- v1.1 -- More efficient ways of attack reported</em></li></ul><h2 id=\"summary\">Summary</h2><p>A vulnerability (CVE-2017-15361) [4] in the procedure of RSA key generation used by a software library allows a practical factorization attack. As a result it is possible to compute the private part of an RSA key based only on its public part. The vulnerable library is used in cryptographic smartcards, security tokens, and other secure hardware chips manufactured by Infineon Technologies AG. An attack is feasible for commonly used key lengths -- including 1024 and 2048 bits -- and it affects chips manufactured as early as 2012 [1].</p><h2 id=\"technical-details\">Technical Details</h2><p>The faulty software is the Infineon-developed RSA library version 1.02.013, more specifically the algorithm it implements for RSA primes generation. Only RSA encryption keys are affected, when they were generated on a smartcard or other embedded device using the mentioned software.</p><p>For performance reasons the Infineon library constructs the key pairs underlying prime numbers in a way that the secret key can be deducted from the public key through factorization.</p><p>An RSA key with 2048 bits should require -- when generated properly -- several quadrillion years to be factorized with a general-purpose computer. Factorizing a 2048-bit RSA key generated with the faulty Infineon library, by contrast, takes a maximum of 100 years, and on average only half that. Keys with 1024 bits take a maximum of only three months. The factorization can be dramatically accelerated by spreading the load onto multiple computers. While costs and times vary for each vulnerable key, the worst case for a <strong>2048-bit</strong> one would require no more than <strong>17 days and $40,300</strong> using a 1,000-instance machine on Amazon Web Service and <strong>$76 and 45 minutes</strong> to factorize an affected <strong>1024-bit key</strong>. On average, it would require half the cost and time to factorize the affected keys [1, 2].</p><p>The researchers who discovered the issue are providing also tools [1] to quickly verify if a key is vulnerable. Those tools can be used also, by potential attackers, to asses if the key is exploitable.</p><p>The flaw is the subject of a research paper titled <em>The Return of Coppersmith's Attack(ROCA): Practical Factorization of Widely Used RSA Moduli</em>, which will be presented on the 2nd of November 2017 at the ACM Conference on Computer and Communications Security, Dallas, USA. In order to provide time for keys change, the paper describing the factorization method will not be published until the above mentioned conference [2].</p><p>A significantly more efficient way of performing the attack was recently announced [9], which could improve the attack in some cases more than <strong>10x</strong>. It can be further improved by using specialized hardware. In the meantime the Estonian authorities reevaluated the threat and decided to update the 760 000 ID cards certificates affected by the vulnerability [10, 11].</p><h2 id=\"products-affected\">Products Affected</h2><p>Infineon products can be affected under a specific combination of conditions:</p><ul><li>The acceleration algorithm was used for the key generation.</li><li>Cryptographic keys have to be generated on a card or token, which uses this algorithm.</li></ul><p>Products that can be affected are typically the TPM (Trusted Platform Modules), e.g. used in professional notebooks, and smartcards for signature applications with self-generated keys. The chip hardware (symmetric and asymmetric co-processors) is not affected [6].</p><p>Examples of affected technologies include BitLocker with TPM 1.2, YubiKey 4 PGP key generation, and the Cached User Data encryption feature in Chrome OS, Electronic IDs [2, 5].</p><p>The vulnerability is also present in at least some NIST FIPS 140-2 and CC EAL 5+ certified devices since at least the year 2012 [1].</p><h2 id=\"recommendations\">Recommendations</h2><p>Verify with the vendors or with the provided tools [3] if the technologies or keys in use in your organization are affected. The researchers are providing offline [7], online [3, 8], or email S-MIME/PGP key testers.</p><p>Vulnerable key pairs and devices should be replaced with secure ones. Major vendors including Microsoft, Google, HP, Lenovo, Fujitsu already released the software updates and guidelines for a mitigation [1].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://crocs.fi.muni.cz/public/papers/rsa_ccs17\">https://crocs.fi.muni.cz/public/papers/rsa_ccs17</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://arstechnica.com/information-technology/2017/10/crypto-failure-cripples-millions-of-high-security-keys-750k-estonian-ids/\">https://arstechnica.com/information-technology/2017/10/crypto-failure-cripples-millions-of-high-security-keys-750k-estonian-ids/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://keychest.net/roca\">https://keychest.net/roca</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361\">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15361</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-15361\">https://nvd.nist.gov/vuln/detail/CVE-2017-15361</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.infineon.com/cms/en/product/promopages/rsa-update/?redirId=59206\">https://www.infineon.com/cms/en/product/promopages/rsa-update/?redirId=59206</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/crocs-muni/roca\">https://github.com/crocs-muni/roca</a></p><p>[8] <a rel=\"noopener\" target=\"_blank\" href=\"https://keytester.cryptosense.com\">https://keytester.cryptosense.com</a></p><p>[9] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.cr.yp.to/20171105-infineon.html\">https://blog.cr.yp.to/20171105-infineon.html</a></p><p>[10] <a rel=\"noopener\" target=\"_blank\" href=\"https://arstechnica.com/information-technology/2017/11/flaw-crippling-millions-of-crypto-keys-is-worse-than-first-disclosed/\">https://arstechnica.com/information-technology/2017/11/flaw-crippling-millions-of-crypto-keys-is-worse-than-first-disclosed/</a></p><p>[11] <a rel=\"noopener\" target=\"_blank\" href=\"https://medium.com/e-residency-blog/estonia-is-enhancing-the-security-of-its-digital-identities-361b9a3c9c52\">https://medium.com/e-residency-blog/estonia-is-enhancing-the-security-of-its-digital-identities-361b9a3c9c52</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}