{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2017-024.pdf"
  },
  "title": "Increased Use of Browser Cryptojacking",
  "serial_number": "2017-024",
  "publish_date": "15-11-2017 15:40:00",
  "description": "Since summer 2017 -- mostly due to significant increase of the price of Bitcoin -- browser-based mining services have increased their popularity. By providing easy to use JavaScript libraries they allow website owners to increase their revenues by hijacking visitors' browsers for cryptocurrency mining. The browser-based mining service will then award part of the profit to the site owners. As cryptocurrency<br>mining is extremely resource-consuming, it may impact the performance of the visitors' browser and operating system, as well as waste electricity on behalf of the owners of the infrastructure.",
  "url_title": "2017-024",
  "content_markdown": "---\ntitle: 'Increased Use of Browser Cryptojacking'\nversion: '1.0'\nnumber: '2017-024'\nfontsize: '11pt'\ndate: 'November 15, 2017'\n---\n\n_History:_\n\n* _15/11/2017 --- v1.0 -- Initial publication_\n\n# Summary\n\nSince summer 2017 -- mostly due to significant increase of the price of Bitcoin -- browser-based mining services have increased their popularity [1]. By providing easy to use JavaScript libraries they allow website owners to increase their revenues by hijacking visitors' browsers for cryptocurrency mining. The browser-based mining service will then award part of the profit to the site owners.\n\nWebsite owners may voluntarily add the browser-based mining services code to their pages, but malicious actors could also exploit vulnerable websites and add JavaScript code to hijack visitors CPUs [3, 4].\n\nAs cryptocurrency mining is extremely resource-consuming, it may impact the performance of the visitors' browser and operating system [1], as well as waste electricity on behalf of the owners of the infrastructure.\n\n# Technical Details\n\nThe most popular service today providing browser-based mining libraries is **Coinhive**, but other services are being created to follow the trend. Based on the Coinhive documentation [5], in order to integrate Coinhive mining on websites, the owner (or malicious actor) needs to add some JavaScript code. The first step is loading the Coinhive library:\n\n\t<script src=\"https://coinhive.com/lib/coinhive.min.js\"></script>\n\nThen loading the Coinhive user key and starting mining:\n\n\t<script>\n\t\tvar miner = new CoinHive.Anonymous('YOUR_SITE_KEY');\n\t\tminer.start();\n\t</script>\n\nA more complex code is available for users willing to fine-tune the way visitors are mining.\n\nIn this version of Coinhive library, no permission is asked to the visitors. Coinhive also proposes another version requiring an explicit opt-in from the end-user.^[`https://authedmine.com/lib/authedmine.min.js`] We may assume that this option will not be the one exploited by malicious actors.\n\nIn both cases, blocking access to the domain hosting the library will prevent the mining from starting. Although Coinhive is the most popular provider at the moment, others exist. A list of other known mining domains is also available in [6]. While most of them currently do not provide infrastructure for browser-based mining, many already do. Others allow for mining with dedicated miners and may provide browser-based mining capabilities in the future.\n\n# Recommendations\n\nMost ad-blocker plugins for browsers, as well as some of the anti-virus products, are blocking known browser-based mining services.\n\nFor large-scale network, it is recommended to block known mining domains [6], unless the users are explicitly allowed to participate in cryptocurrency mining.\n\n# References\n\n[1] <https://www.bleepingcomputer.com/news/security/coinhive-is-rapidly-becoming-a-favorite-tool-among-malware-devs/>\n\n[2] <https://researchcenter.paloaltonetworks.com/2017/10/unit42-unauthorized-coin-mining-browser/>\n\n[3] <https://gwillem.gitlab.io/2017/11/07/cryptojacking-found-on-2496-stores/>\n\n[4] <https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html>\n\n[5] <https://coinhive.com/documentation/miner>\n\n[6] <https://github.com/ZeroDot1/CoinBlockerLists>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>15/11/2017 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>Since summer 2017 -- mostly due to significant increase of the price of Bitcoin -- browser-based mining services have increased their popularity [1]. By providing easy to use JavaScript libraries they allow website owners to increase their revenues by hijacking visitors' browsers for cryptocurrency mining. The browser-based mining service will then award part of the profit to the site owners.</p><p>Website owners may voluntarily add the browser-based mining services code to their pages, but malicious actors could also exploit vulnerable websites and add JavaScript code to hijack visitors CPUs [3, 4].</p><p>As cryptocurrency mining is extremely resource-consuming, it may impact the performance of the visitors' browser and operating system [1], as well as waste electricity on behalf of the owners of the infrastructure.</p><h2 id=\"technical-details\">Technical Details</h2><p>The most popular service today providing browser-based mining libraries is <strong>Coinhive</strong>, but other services are being created to follow the trend. Based on the Coinhive documentation [5], in order to integrate Coinhive mining on websites, the owner (or malicious actor) needs to add some JavaScript code. The first step is loading the Coinhive library:</p><pre><code>&lt;script src=\"https://coinhive.com/lib/coinhive.min.js\"&gt;&lt;/script&gt;\n</code></pre><p>Then loading the Coinhive user key and starting mining:</p><pre><code>&lt;script&gt;\n    var miner = new CoinHive.Anonymous('YOUR_SITE_KEY');\n    miner.start();\n&lt;/script&gt;\n</code></pre><p>A more complex code is available for users willing to fine-tune the way visitors are mining.</p><p>In this version of Coinhive library, no permission is asked to the visitors. Coinhive also proposes another version requiring an explicit opt-in from the end-user.^[<code>https://authedmine.com/lib/authedmine.min.js</code>] We may assume that this option will not be the one exploited by malicious actors.</p><p>In both cases, blocking access to the domain hosting the library will prevent the mining from starting. Although Coinhive is the most popular provider at the moment, others exist. A list of other known mining domains is also available in [6]. While most of them currently do not provide infrastructure for browser-based mining, many already do. Others allow for mining with dedicated miners and may provide browser-based mining capabilities in the future.</p><h2 id=\"recommendations\">Recommendations</h2><p>Most ad-blocker plugins for browsers, as well as some of the anti-virus products, are blocking known browser-based mining services.</p><p>For large-scale network, it is recommended to block known mining domains [6], unless the users are explicitly allowed to participate in cryptocurrency mining.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/coinhive-is-rapidly-becoming-a-favorite-tool-among-malware-devs/\">https://www.bleepingcomputer.com/news/security/coinhive-is-rapidly-becoming-a-favorite-tool-among-malware-devs/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://researchcenter.paloaltonetworks.com/2017/10/unit42-unauthorized-coin-mining-browser/\">https://researchcenter.paloaltonetworks.com/2017/10/unit42-unauthorized-coin-mining-browser/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://gwillem.gitlab.io/2017/11/07/cryptojacking-found-on-2496-stores/\">https://gwillem.gitlab.io/2017/11/07/cryptojacking-found-on-2496-stores/</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html\">https://blog.sucuri.net/2017/09/hacked-websites-mine-crypocurrencies.html</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://coinhive.com/documentation/miner\">https://coinhive.com/documentation/miner</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/ZeroDot1/CoinBlockerLists\">https://github.com/ZeroDot1/CoinBlockerLists</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}