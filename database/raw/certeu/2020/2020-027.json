{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-027.pdf"
  },
  "title": "DNS Protocol Vulnerability",
  "serial_number": "2020-027",
  "publish_date": "20-05-2020 10:07:00",
  "description": "On 19th of May 2020 a new DNS protocol vulnerability was made public. It was discovered by researchers from Tel Aviv University and the Interdisciplinary Center in Israel.<br>Disclosed vulnerability abuses DNS delegation mechanism to force DNS resolvers to generate more DNS queries to authoritative servers of attacker’s choice.<br>Unlike traditional random subdomain attacks, in case of this attack , the queries are generated by resolver itself. The researchers called this attack the NXNSAttack. It appears that pretty much all vendors of DNS resolvers are affected.",
  "url_title": "2020-027",
  "content_markdown": "---\ntitle: 'DNS Protocol Vulnerability'\nversion: '1.0'\nnumber: '2020-027'\ndate: 'May 20, 2020'\n---\n\n_History:_\n\n* _20/05/2020 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn 19th of May 2020 a new DNS protocol vulnerability was made public. It was discovered by researchers from Tel Aviv University and the Interdisciplinary Center in Israel [1].\n\nDisclosed vulnerability abuses DNS delegation mechanism to force DNS resolvers to generate more DNS queries to authoritative servers of attacker’s choice.\nUnlike traditional random subdomain attacks, in case of this attack , the queries are generated by resolver itself [2]. The researchers called this attack the **NXNSAttack**. It appears that pretty much all vendors of DNS resolvers are affected [1].\n\n# Technical Details\n\nThe main principle of NXNSAttack is that attackers are able to amplify a single DNS query toward DNS resolver plus single DNS answer with fake delegations to fire multiple random queries at victim authoritative servers, effectively using standard-compliant DNS resolver as an amplifier for random subdomain attack [2].\n\nThe details of the vulnerabilities are as follows.\n\n- Internet Systems Consortium (ISC) BIND does not sufficiently limit the number of fetches performed when processing referrals (CVE-2020-8616) [3]\n- NLnet Labs Unbound can be tricked into amplifying an incoming query into a large number of queries directed to a target (CVE-2020-12662) [4]\n- Malformed answers from upstream name servers can be used to make Unbound unresponsive (CVE-2020-12663) [4]\n- NIC.CZ Knot Resolver before 5.1.1 allows traffic amplification via a crafted DNS answer from an attacker-controlled server (CVE-2020-12667) [5]\n- PowerDNS Denial of Service (CVE-2020-10995) [6]\n\nMoreover, PowerDNS Recursor 4.1.16, 4.2.2 and 4.3.1 contain a mitigation to limit the impact of this DNS protocol issue [6].\n\nFinally, DoH (DNS over HTTP) is irrelevant to this vulnerability because it deals with the communication channel between a client and its recursive resolver while the issues are on the communications between the recursive resolver and the authoritative structure [1].\n\n# Affected Products\n\nList of all affected products and versions:\n\n* Internet Systems Consortium (ISC) BIND from 9.0.0 up to 9.11.18, from 9.12.0 up to 9.12.4-P2, from 9.14.0 up to 9.14.11, from 9.16.0 up to 9.16.2, and releases from 9.17.0 up to 9.17.1 of the 9.17 experimental development branch. All releases in the obsolete 9.13 and 9.15 development branches. All releases of BIND Supported Preview Edition from 9.9.3-S1 up to 9.11.18-S1 [3];\n* All versions of NLnet Labs Unbound up to and including 1.10.0 [4];\n* NIC.CZ Knot Resolver before 5.1.1 [5];\n* PowerDNS Recursor from 4.1.0 up to and including 4.3.0 is affected [6].\n\nOthers products implementing the vulnerable DNS protocol may also be affected.\n\n# Recommendations\n\nThe security updates were released and CERT-EU highly recommends to upgrade all mentioned DNS software to a non-affected latest version.\n\n# References\n\n[1] <http://www.nxnsattack.com/>\n\n[2] <https://en.blog.nic.cz/2020/05/19/nxnsattack-upgrade-resolvers-to-stop-new-kind-of-random-subdomain-attack/>\n\n[3] <https://kb.isc.org/docs/cve-2020-8616>\n\n[4] <https://nlnetlabs.nl/downloads/unbound/CVE-2020-12662_2020-12663.txt>\n\n[5] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12667>\n\n[6] <https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2020-01.html>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>20/05/2020 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 19th of May 2020 a new DNS protocol vulnerability was made public. It was discovered by researchers from Tel Aviv University and the Interdisciplinary Center in Israel [1].</p><p>Disclosed vulnerability abuses DNS delegation mechanism to force DNS resolvers to generate more DNS queries to authoritative servers of attacker’s choice. Unlike traditional random subdomain attacks, in case of this attack , the queries are generated by resolver itself [2]. The researchers called this attack the <strong>NXNSAttack</strong>. It appears that pretty much all vendors of DNS resolvers are affected [1].</p><h2 id=\"technical-details\">Technical Details</h2><p>The main principle of NXNSAttack is that attackers are able to amplify a single DNS query toward DNS resolver plus single DNS answer with fake delegations to fire multiple random queries at victim authoritative servers, effectively using standard-compliant DNS resolver as an amplifier for random subdomain attack [2].</p><p>The details of the vulnerabilities are as follows.</p><ul><li>Internet Systems Consortium (ISC) BIND does not sufficiently limit the number of fetches performed when processing referrals (CVE-2020-8616) [3]</li><li>NLnet Labs Unbound can be tricked into amplifying an incoming query into a large number of queries directed to a target (CVE-2020-12662) [4]</li><li>Malformed answers from upstream name servers can be used to make Unbound unresponsive (CVE-2020-12663) [4]</li><li>NIC.CZ Knot Resolver before 5.1.1 allows traffic amplification via a crafted DNS answer from an attacker-controlled server (CVE-2020-12667) [5]</li><li>PowerDNS Denial of Service (CVE-2020-10995) [6]</li></ul><p>Moreover, PowerDNS Recursor 4.1.16, 4.2.2 and 4.3.1 contain a mitigation to limit the impact of this DNS protocol issue [6].</p><p>Finally, DoH (DNS over HTTP) is irrelevant to this vulnerability because it deals with the communication channel between a client and its recursive resolver while the issues are on the communications between the recursive resolver and the authoritative structure [1].</p><h2 id=\"affected-products\">Affected Products</h2><p>List of all affected products and versions:</p><ul><li>Internet Systems Consortium (ISC) BIND from 9.0.0 up to 9.11.18, from 9.12.0 up to 9.12.4-P2, from 9.14.0 up to 9.14.11, from 9.16.0 up to 9.16.2, and releases from 9.17.0 up to 9.17.1 of the 9.17 experimental development branch. All releases in the obsolete 9.13 and 9.15 development branches. All releases of BIND Supported Preview Edition from 9.9.3-S1 up to 9.11.18-S1 [3];</li><li>All versions of NLnet Labs Unbound up to and including 1.10.0 [4];</li><li>NIC.CZ Knot Resolver before 5.1.1 [5];</li><li>PowerDNS Recursor from 4.1.0 up to and including 4.3.0 is affected [6].</li></ul><p>Others products implementing the vulnerable DNS protocol may also be affected.</p><h2 id=\"recommendations\">Recommendations</h2><p>The security updates were released and CERT-EU highly recommends to upgrade all mentioned DNS software to a non-affected latest version.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"http://www.nxnsattack.com/\">http://www.nxnsattack.com/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://en.blog.nic.cz/2020/05/19/nxnsattack-upgrade-resolvers-to-stop-new-kind-of-random-subdomain-attack/\">https://en.blog.nic.cz/2020/05/19/nxnsattack-upgrade-resolvers-to-stop-new-kind-of-random-subdomain-attack/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.isc.org/docs/cve-2020-8616\">https://kb.isc.org/docs/cve-2020-8616</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://nlnetlabs.nl/downloads/unbound/CVE-2020-12662_2020-12663.txt\">https://nlnetlabs.nl/downloads/unbound/CVE-2020-12662_2020-12663.txt</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12667\">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12667</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2020-01.html\">https://docs.powerdns.com/recursor/security-advisories/powerdns-advisory-2020-01.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}