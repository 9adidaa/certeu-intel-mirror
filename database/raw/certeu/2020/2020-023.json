{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-023.pdf"
  },
  "title": "Pulse Connect Secure Severe Vulnerabilities",
  "serial_number": "2020-023",
  "publish_date": "23-04-2020 09:29:00",
  "description": "On April 6, 2020, three issues were discovered in Host Checker policy enforcement on Pulse Secure Pulse Connect Secure (PCS). These vulnerabilities were encoded as CVE-2020-11580 (No certificate Validation), CVE-2020-11581 (Command Injection), CVE-2020-11582 (DNS Rebindig). These vulnerabilities could allow a man-in-the-middle (MITM) attacker to perform a remote code execution (RCE) attack.<br>CERT-EU is not aware of any malicious exploitation for those vulnerabilities, but we have to take into consideration that the file on which these vulnerabilities are built (\"tncc.jar\") is not obfuscated in any way and the original source code can be obtained with almost any Java decompiler and customized in a malicious manner.",
  "url_title": "2020-023",
  "content_markdown": "---\ntitle: 'Pulse Connect Secure SevereÂ Vulnerabilities'\nversion: '1.0'\nnumber: '2020-023'\ndate: 'April 23, 2020'\n---\n\n_History:_\n\n* _23/04/2020 --- v1.0 -- Initial publication_\n\n\n# Summary\n\nOn April 6, 2020, three issues were discovered in Host Checker policy enforcement on Pulse Secure Pulse Connect Secure (PCS). These vulnerabilities were encoded as CVE-2020-11580 (_No certificate Validation_) [1], CVE-2020-11581 (_Command Injection_) [2], CVE-2020-11582 (_DNS Rebindig_) [3]. These vulnerabilities could allow a man-in-the-middle (MITM) attacker to perform a remote code execution (RCE) attack.\n\nCERT-EU is not aware of any malicious exploitation for those vulnerabilities, but we have to take into consideration that the file on which these vulnerabilities are built (`tncc.jar`) is not obfuscated in any way and the original source code can be obtained with almost any Java decompiler and customized in a malicious manner.\n\n# Technical Details\n\nThe Host Checker is a client side component that the Pulse Connect Secure appliance may require in order to connect to the VPN. The Host Checker requests a policy from the server and perform basic checks on the client accordingly. Checks may include MAC Addresses, running process (i.e., checking for an antivirus) and some others. While on Windows, the plugin is an ActiveX component, in Linux, Solaris and OSX it is a Java Applet [4].\n\nAn attacker who is in a position where he/she can perform a man-in-the-middle attack may spoof the server and send a malicious cookie along with a policy that is impossible to comply with. An example cookie could be any method of command injection on Linux. The client will then fail to comply with the policy and execute the command with the appended value when trying to show remediation instructions.\n\nAll the vulnerabilities are based on the applet in `tncc.jar`, executed on macOS, Linux, and Solaris clients when a Host Checker policy is enforced. In this case, three things can happen:\n\n1. It accepts an arbitrary SSL certificate (CVE-2020-11580).\n2. It allows a man-in-the-middle attacker to perform OS command injection attacks (against a client) via shell meta-characters to the `doCustomRemediateInstructions` method, because `Runtime.getRuntime().exec()` is used (CVE-2020-11581).\n3. It launches a TCP server that accepts local connections on a random port that can be reached by local HTTP clients, because up to 25 invalid lines are ignored, and DNS rebinding can occur (CVE-2020-11582).\n\n# Products Affected\n\n* All the existing versions of Pulse Connect Secure and Pulse Policy Secure as **servers**.\n* For the clients, this issue is reported only on macOS, Linux and Solaris clients regardless of the installed version.\n* Agent-less Host Checker uses an applet to send information to the PCS appliance. To launch the Host Checker Applet, Browsers should support NPAPI support (technology required for Java applets). As of September, 2018, Firefox, Chrome and Safari Browsers no longer offers a version which supports NPAPI. Firefox version 52ESR is the last release to support the technology.\n\n# Recommendations\n\nA patch for these vulnerabilities has not been released yet, but some workarounds can be put in place in order to mitigate them:\n\n- Safari 12 and above no longer supports NPAPI. If you are using older version, please upgrade your browsers to latest version.\n- Google's Chrome version 45 and above have dropped support for NPAPI, and therefore Java Plugin do not work on these browsers anymore.\n- Firefox no longer offers a version which supports NPAPI. Firefox version 52ESR is the last release to support the technology. If end users are using 52ESR, please recommend to upgrade the browser to latest version or use Pulse Secure Client.\n- If Host Checker is not enabled on the PCS Appliance, end-users are not vulnerable to CVE-2020-11580, CVE-2020-11581, and CVE-2020-11582 [5].\n\n# References\n\n[1] <https://nvd.nist.gov/vuln/detail/CVE-2020-11580>\n\n[2] <https://nvd.nist.gov/vuln/detail/CVE-2020-11581>\n\n[3] <https://nvd.nist.gov/vuln/detail/CVE-2020-11582>\n\n[4] <https://git.lsd.cat/g/pulse-host-checker-rce>\n\n[5] <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44426>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>23/04/2020 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On April 6, 2020, three issues were discovered in Host Checker policy enforcement on Pulse Secure Pulse Connect Secure (PCS). These vulnerabilities were encoded as CVE-2020-11580 (<em>No certificate Validation</em>) [1], CVE-2020-11581 (<em>Command Injection</em>) [2], CVE-2020-11582 (<em>DNS Rebindig</em>) [3]. These vulnerabilities could allow a man-in-the-middle (MITM) attacker to perform a remote code execution (RCE) attack.</p><p>CERT-EU is not aware of any malicious exploitation for those vulnerabilities, but we have to take into consideration that the file on which these vulnerabilities are built (<code>tncc.jar</code>) is not obfuscated in any way and the original source code can be obtained with almost any Java decompiler and customized in a malicious manner.</p><h2 id=\"technical-details\">Technical Details</h2><p>The Host Checker is a client side component that the Pulse Connect Secure appliance may require in order to connect to the VPN. The Host Checker requests a policy from the server and perform basic checks on the client accordingly. Checks may include MAC Addresses, running process (i.e., checking for an antivirus) and some others. While on Windows, the plugin is an ActiveX component, in Linux, Solaris and OSX it is a Java Applet [4].</p><p>An attacker who is in a position where he/she can perform a man-in-the-middle attack may spoof the server and send a malicious cookie along with a policy that is impossible to comply with. An example cookie could be any method of command injection on Linux. The client will then fail to comply with the policy and execute the command with the appended value when trying to show remediation instructions.</p><p>All the vulnerabilities are based on the applet in <code>tncc.jar</code>, executed on macOS, Linux, and Solaris clients when a Host Checker policy is enforced. In this case, three things can happen:</p><ol><li>It accepts an arbitrary SSL certificate (CVE-2020-11580).</li><li>It allows a man-in-the-middle attacker to perform OS command injection attacks (against a client) via shell meta-characters to the <code>doCustomRemediateInstructions</code> method, because <code>Runtime.getRuntime().exec()</code> is used (CVE-2020-11581).</li><li>It launches a TCP server that accepts local connections on a random port that can be reached by local HTTP clients, because up to 25 invalid lines are ignored, and DNS rebinding can occur (CVE-2020-11582).</li></ol><h2 id=\"products-affected\">Products Affected</h2><ul><li>All the existing versions of Pulse Connect Secure and Pulse Policy Secure as <strong>servers</strong>.</li><li>For the clients, this issue is reported only on macOS, Linux and Solaris clients regardless of the installed version.</li><li>Agent-less Host Checker uses an applet to send information to the PCS appliance. To launch the Host Checker Applet, Browsers should support NPAPI support (technology required for Java applets). As of September, 2018, Firefox, Chrome and Safari Browsers no longer offers a version which supports NPAPI. Firefox version 52ESR is the last release to support the technology.</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>A patch for these vulnerabilities has not been released yet, but some workarounds can be put in place in order to mitigate them:</p><ul><li>Safari 12 and above no longer supports NPAPI. If you are using older version, please upgrade your browsers to latest version.</li><li>Google's Chrome version 45 and above have dropped support for NPAPI, and therefore Java Plugin do not work on these browsers anymore.</li><li>Firefox no longer offers a version which supports NPAPI. Firefox version 52ESR is the last release to support the technology. If end users are using 52ESR, please recommend to upgrade the browser to latest version or use Pulse Secure Client.</li><li>If Host Checker is not enabled on the PCS Appliance, end-users are not vulnerable to CVE-2020-11580, CVE-2020-11581, and CVE-2020-11582 [5].</li></ul><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-11580\">https://nvd.nist.gov/vuln/detail/CVE-2020-11580</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-11581\">https://nvd.nist.gov/vuln/detail/CVE-2020-11581</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-11582\">https://nvd.nist.gov/vuln/detail/CVE-2020-11582</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://git.lsd.cat/g/pulse-host-checker-rce\">https://git.lsd.cat/g/pulse-host-checker-rce</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44426\">https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44426</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}