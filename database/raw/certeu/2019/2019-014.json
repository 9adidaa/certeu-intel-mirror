{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2019-014.pdf"
  },
  "title": "Critical Vulnerabilities in Microsoft NTLM",
  "serial_number": "2019-014",
  "publish_date": "13-06-2019 13:56:00",
  "description": "Two critical Microsoft vulnerabilities were discovered by the research team Preempt. The vulnerabilities consist of three logical flaws in NTLM (NT Lan Manager). The vulnerabilities allow an attacker to potentially execute malicious code remotely or authenticate to any HTTP server that supports Windows Integrated Authentication (WIA) such as Exchange or ADFS.",
  "url_title": "2019-014",
  "content_markdown": "---\ntitle: 'Critical Vulnerabilities in Microsoft NTLM'\nversion: '1.0'\nnumber: '2019-014'\ndate: 'June 13, 2019'\n---\n\n_History:_\n\n* _13/06/2019 --- v1.0: Initial publication_\n\n# Summary\n\nTwo critical Microsoft vulnerabilities were discovered by the research team Preempt [1]. The vulnerabilities consist of three logical flaws in NTLM (NT Lan Manager).  The vulnerabilities allow an attacker to potentially execute malicious code remotely or authenticate to any HTTP server that supports Windows Integrated Authentication (WIA) such as Exchange or ADFS.\n\n# Technical Details\n\nThe NTLM-relay attack has been out in the wild for some time. In short, it allows lateral movement in the target's network. Over the years, Microsoft has built defensive features to mitigate such an attack. However, in a proof of concept, the researchers from Preempt managed to bypass successfully the following mechanisms:\n\n* Message Integrity Code (MIC)\n* SMB Session Signing\n* Enhanced Protection for Authentication (EPA, more details [4])\n\nMicrosoft has released two patches for CVE-2019-1040 [2] and CVE-2019-1019 [3] to address the issue, but a proper configuration is also required to be fully protected.\n\n# Products Affected\n\n* All versions of Windows are affected.\n\n# Recommendations\n\n* Apply patches to the workstations and servers.\n\nAdditionally, ensure a secure configuration by:\n\n* Enforce SMB Signing\n* Block NTLMv1\n* Enforce LDAP/S Signing\n* Enforce Enhanced Protection for Authentication\n* Reduce NTLM usage\n\n# References\n\n[1] <https://blog.preempt.com/security-advisory-critical-vulnerabilities-in-ntlm>\n\n[2] <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1040>\n\n[3] <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1019>\n\n[4] <https://blog.preempt.com/how-to-easily-bypass-epa>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>13/06/2019 --- v1.0: Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>Two critical Microsoft vulnerabilities were discovered by the research team Preempt [1]. The vulnerabilities consist of three logical flaws in NTLM (NT Lan Manager). The vulnerabilities allow an attacker to potentially execute malicious code remotely or authenticate to any HTTP server that supports Windows Integrated Authentication (WIA) such as Exchange or ADFS.</p><h2 id=\"technical-details\">Technical Details</h2><p>The NTLM-relay attack has been out in the wild for some time. In short, it allows lateral movement in the target's network. Over the years, Microsoft has built defensive features to mitigate such an attack. However, in a proof of concept, the researchers from Preempt managed to bypass successfully the following mechanisms:</p><ul><li>Message Integrity Code (MIC)</li><li>SMB Session Signing</li><li>Enhanced Protection for Authentication (EPA, more details [4])</li></ul><p>Microsoft has released two patches for CVE-2019-1040 [2] and CVE-2019-1019 [3] to address the issue, but a proper configuration is also required to be fully protected.</p><h2 id=\"products-affected\">Products Affected</h2><ul><li>All versions of Windows are affected.</li></ul><h2 id=\"recommendations\">Recommendations</h2><ul><li>Apply patches to the workstations and servers.</li></ul><p>Additionally, ensure a secure configuration by:</p><ul><li>Enforce SMB Signing</li><li>Block NTLMv1</li><li>Enforce LDAP/S Signing</li><li>Enforce Enhanced Protection for Authentication</li><li>Reduce NTLM usage</li></ul><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.preempt.com/security-advisory-critical-vulnerabilities-in-ntlm\">https://blog.preempt.com/security-advisory-critical-vulnerabilities-in-ntlm</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1040\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1040</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1019\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1019</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.preempt.com/how-to-easily-bypass-epa\">https://blog.preempt.com/how-to-easily-bypass-epa</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}