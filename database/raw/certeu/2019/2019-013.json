{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2019-013.pdf"
  },
  "title": "UPDATED 07/2019: Remote Desktop Services -- Remote Code Execution Vulnerability",
  "serial_number": "2019-013",
  "publish_date": "16-05-2019 14:22:00",
  "description": "Microsoft released fixes for a critical Remote Code Execution vulnerability (CVE-2019-0708) in Remote Desktop Services that affects some older versions of Windows. The vulnerability has been since named BlueKeep.The Remote Desktop Protocol (RDP) itself is not vulnerable. This vulnerability is pre-authentication and requires no user interaction. In other words, the vulnerability is \"wormable\", meaning that any malware that exploits this vulnerability could propagate from vulnerable computer to vulnerable computer in a similar way as the WannaCry malware spread across the globe in 2017. Exploits seem to already exist.",
  "url_title": "2019-013",
  "content_markdown": "---\ntitle: 'Remote Desktop Services -- Remote Code Execution Vulnerability'\nversion: '1.1'\nnumber: '2019-013'\ndate: 'July 24, 2019'\n---\n\n_History:_\n\n* _16/05/2019 --- v1.0 -- Initial publication_\n* _24/07/2019 --- v1.1 -- Additional information about exploits and patches for older versions of Windows available_\n\n\n# Summary\n\nMicrosoft released fixes for a critical Remote Code Execution vulnerability (CVE-2019-0708) in Remote Desktop Services that affects some older versions of Windows. The vulnerability has been since named **BlueKeep**. The Remote Desktop Protocol (RDP) itself is not vulnerable. This vulnerability is pre-authentication and requires no user interaction. In other words, the vulnerability is _wormable_, meaning that any malware that exploits this vulnerability could propagate from vulnerable computer to vulnerable computer in a similar way as the WannaCry malware spread across the globe in 2017 [1]. Exploits seem to already exist [4, 5, 6].\n\n# Technical Details\n\nA remote code execution vulnerability exists in Remote Desktop Services – formerly known as Terminal Services – when an unauthenticated attacker connects to the target system using RDP and sends specially crafted requests. This vulnerability is pre-authentication and requires no user interaction. An attacker who successfully exploits this vulnerability could execute arbitrary code on the target system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.\n\nTo exploit this vulnerability, an attacker would need to send a specially crafted request to the target systems Remote Desktop Service via RDP [2]. Exploit seems relatively easy [4, 5, 6] so the attacks are probably imminent. Also, the exploits are being now included in popular exploit development frameworks, such as CANVAS [6, 7].\n\n# Products Affected\n\n* Vulnerable supported systems include Windows 7, Windows Server 2008 R2, and Windows Server 2008.\n* Vulnerable out-of-support systems include Windows 2003 and Windows XP.\n* Windows 8 and Windows 10 are not affected by this vulnerability.\n\n# Recommendations\n\nDownloads for supported versions of Windows can be found in the Microsoft Security Update Guide [2]. Customers who use a supported version of Windows and have automatic updates enabled are automatically protected. Customers who use an out-of-support version should address this vulnerability by upgrading to the latest version of Windows. Even so, Microsoft is making fixes available for these out-of-support versions of Windows in KB4500705 [3].\n\nMicrosoft has exceptionally also issued patches for older, out of support versions of the Windows operating system including XP, Vista, and Server 2003. They can be found in [8].\n\nIn all cases, Microsoft strongly recommends to install the updates for this vulnerability as soon as possible even if you plan to leave Remote Desktop Services disabled.\n\n# Workarounds\n\nThe following workarounds may be helpful in your situation. In all cases, Microsoft strongly recommends that you install the updates for this vulnerability as soon as possible even if you plan to leave these workarounds in place:\n\n* Enable Network Level Authentication (NLA) on systems running supported editions of Windows 7, Windows Server 2008, and Windows Server 2008 R2\n\nYou can enable Network Level Authentication to block unauthenticated attackers from exploiting this vulnerability. With NLA turned on, an attacker would first need to authenticate to Remote Desktop Services using a valid account on the target system before the attacker could exploit the vulnerability.\n\n* Block TCP port 3389 at the enterprise perimeter firewall\n\nTCP port 3389 is used to initiate a connection with the affected component. Blocking this port at the network perimeter firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. This can help protect networks from attacks that originate outside the enterprise perimeter. Blocking the affected ports at the enterprise perimeter is the best defense to help avoid Internet-based attacks. However, systems could still be vulnerable to attacks from within their enterprise perimeter.\n\n# References\n\n[1] <https://blogs.technet.microsoft.com/msrc/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/>\n\n[2] <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708>\n\n[3] <https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708>\n\n[4] <https://twitter.com/cBekrar/status/1128712967845961728>\n\n[5] <https://arstechnica.com/information-technology/2019/07/explainer-for-exploiting-wormable-bluekeep-flaw-posted-on-github/>\n\n[6] <https://twitter.com/Immunityinc/status/1153752470130221057?s=19>\n\n[7] <https://www.immunityinc.com/products/canvas/>\n\n[8] <https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>16/05/2019 --- v1.0 -- Initial publication</em></li><li><em>24/07/2019 --- v1.1 -- Additional information about exploits and patches for older versions of Windows available</em></li></ul><h2 id=\"summary\">Summary</h2><p>Microsoft released fixes for a critical Remote Code Execution vulnerability (CVE-2019-0708) in Remote Desktop Services that affects some older versions of Windows. The vulnerability has been since named <strong>BlueKeep</strong>. The Remote Desktop Protocol (RDP) itself is not vulnerable. This vulnerability is pre-authentication and requires no user interaction. In other words, the vulnerability is <em>wormable</em>, meaning that any malware that exploits this vulnerability could propagate from vulnerable computer to vulnerable computer in a similar way as the WannaCry malware spread across the globe in 2017 [1]. Exploits seem to already exist [4, 5, 6].</p><h2 id=\"technical-details\">Technical Details</h2><p>A remote code execution vulnerability exists in Remote Desktop Services – formerly known as Terminal Services – when an unauthenticated attacker connects to the target system using RDP and sends specially crafted requests. This vulnerability is pre-authentication and requires no user interaction. An attacker who successfully exploits this vulnerability could execute arbitrary code on the target system. An attacker could then install programs; view, change, or delete data; or create new accounts with full user rights.</p><p>To exploit this vulnerability, an attacker would need to send a specially crafted request to the target systems Remote Desktop Service via RDP [2]. Exploit seems relatively easy [4, 5, 6] so the attacks are probably imminent. Also, the exploits are being now included in popular exploit development frameworks, such as CANVAS [6, 7].</p><h2 id=\"products-affected\">Products Affected</h2><ul><li>Vulnerable supported systems include Windows 7, Windows Server 2008 R2, and Windows Server 2008.</li><li>Vulnerable out-of-support systems include Windows 2003 and Windows XP.</li><li>Windows 8 and Windows 10 are not affected by this vulnerability.</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>Downloads for supported versions of Windows can be found in the Microsoft Security Update Guide [2]. Customers who use a supported version of Windows and have automatic updates enabled are automatically protected. Customers who use an out-of-support version should address this vulnerability by upgrading to the latest version of Windows. Even so, Microsoft is making fixes available for these out-of-support versions of Windows in KB4500705 [3].</p><p>Microsoft has exceptionally also issued patches for older, out of support versions of the Windows operating system including XP, Vista, and Server 2003. They can be found in [8].</p><p>In all cases, Microsoft strongly recommends to install the updates for this vulnerability as soon as possible even if you plan to leave Remote Desktop Services disabled.</p><h2 id=\"workarounds\">Workarounds</h2><p>The following workarounds may be helpful in your situation. In all cases, Microsoft strongly recommends that you install the updates for this vulnerability as soon as possible even if you plan to leave these workarounds in place:</p><ul><li>Enable Network Level Authentication (NLA) on systems running supported editions of Windows 7, Windows Server 2008, and Windows Server 2008 R2</li></ul><p>You can enable Network Level Authentication to block unauthenticated attackers from exploiting this vulnerability. With NLA turned on, an attacker would first need to authenticate to Remote Desktop Services using a valid account on the target system before the attacker could exploit the vulnerability.</p><ul><li>Block TCP port 3389 at the enterprise perimeter firewall</li></ul><p>TCP port 3389 is used to initiate a connection with the affected component. Blocking this port at the network perimeter firewall will help protect systems that are behind that firewall from attempts to exploit this vulnerability. This can help protect networks from attacks that originate outside the enterprise perimeter. Blocking the affected ports at the enterprise perimeter is the best defense to help avoid Internet-based attacks. However, systems could still be vulnerable to attacks from within their enterprise perimeter.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://blogs.technet.microsoft.com/msrc/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/\">https://blogs.technet.microsoft.com/msrc/2019/05/14/prevent-a-worm-by-updating-remote-desktop-services-cve-2019-0708/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708\">https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://twitter.com/cBekrar/status/1128712967845961728\">https://twitter.com/cBekrar/status/1128712967845961728</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://arstechnica.com/information-technology/2019/07/explainer-for-exploiting-wormable-bluekeep-flaw-posted-on-github/\">https://arstechnica.com/information-technology/2019/07/explainer-for-exploiting-wormable-bluekeep-flaw-posted-on-github/</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://twitter.com/Immunityinc/status/1153752470130221057?s=19\">https://twitter.com/Immunityinc/status/1153752470130221057?s=19</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.immunityinc.com/products/canvas/\">https://www.immunityinc.com/products/canvas/</a></p><p>[8] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708\">https://support.microsoft.com/en-us/help/4500705/customer-guidance-for-cve-2019-0708</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}