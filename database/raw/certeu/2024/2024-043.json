{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2024-043.pdf"
  },
  "title": "Vulnerabilities in Cisco ASA and FTD Software",
  "serial_number": "2024-043",
  "publish_date": "24-04-2024 19:12:03",
  "description": "On April 24, 2024, Cisco disclosed three vulnerabilities in its management and VPN web servers for Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software product. <br>\nSome of these vulnerabilities are currently being exploited[1]. It is recommended upgrading affected products as soon as possible, and checking for possible compromise.<br>\n",
  "url_title": "2024-043",
  "content_markdown": "---\ntitle: 'Vulnerabilities in Cisco ASA and FTD Software'\nnumber: '2024-043'\nversion: '1.0'\noriginal_date: 'April 24, 2024'\ndate: 'April 24, 2024'\n---\n\n_History:_\n\n* _24/04/2024 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn April 24, 2024, Cisco disclosed three vulnerabilities in its management and VPN web servers for Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software product. \n\nSome of these vulnerabilities are currently being exploited[1]. It is recommended upgrading affected products as soon as possible, and checking for possible compromise.\n\n# Technical Details\n\nThe vulnerability **CVE-2024-20353** [1], with a CVSS score of 8.6, allows an attacker to cause a DoS condition by sending a crafted HTTP request to the web server on a targeted device. A successful exploit would result in an unexpected reloading of the device. This vulnerability is due to incomplete error checking when parsing an HTTP header.\n\nThe vulnerability **CVE-2024-20359** [2], with a CVSS score of 6.0, allows an authenticated, local attacker to execute arbitrary code with root-level privileges on the affected device by copying a crafted file to its `disk0:` file system. The execution occurs after the next reload of the targeted device. This vulnerability is due to improper validation of a file when it is read from system flash memory. It is also important to note that the injected code could persist across device reboots. Administrator-level privileges are required to exploit this vulnerability.\n\nThe vulnerability **CVE-2024-20358** [3], with a CVSS score of 6.0, allows an authenticated, local attacker to execute arbitrary commands on the underlying operating system (i.e., Linux) with root-level privileges. An attacker could exploit this vulnerability by restoring a crafted backup file to an affected device. This vulnerability exists because the contents of a backup file are improperly sanitised at restore time. Administrator-level privileges are required to exploit this vulnerability.\n\n# Affected Products\n\nThese vulnerabilities affect Cisco ASA and FTD appliances. In order to understand if one version is affected, Cisco provides its [Cisco Software Checker tool](https://sec.cloudapps.cisco.com/security/center/softwarechecker.x).\n\n## CVE-2024-20353\n\nThis vulnerability affects Cisco ASA Software and FTD Software if they have one or more of the vulnerable configurations listed below\n\nTo determine whether a device that is running Cisco ASA Software or FTD Software is affected, use the `show asp table socket | include SSL` command and look for an SSL listen socket on any TCP port. If a socket is present in the output, the device should be considered vulnerable. The following example shows the output for a Cisco ASA device with two SSL listen sockets on TCP port 443 and TCP port 8443:\n\n```\n\n    ciscoasa#  show asp table socket | include SSL\n    SSL       00185038  LISTEN     172.16.0.250:443    0.0.0.0:*\n    SSL       00188638  LISTEN      10.0.0.250:8443    0.0.0.0:*   \n\n```\n\n### ASA Software Vulnerable Configuration\n\nIn the following table, the left column lists Cisco ASA Software features that are potentially vulnerable. The right column indicates the basic configuration for the feature from the `show running-config` CLI command, if it can be determined. These features could cause the SSL listen sockets to be enabled.\n\n|Cisco ASA Software Feature | Possible Vulnerable Configuration |\n|---|---|\n|AnyConnect IKEv2 Remote Access (with client services) | crypto ikev2 enable [...] client-services port |\n|Local Certificate Authority (CA) | crypto ca server \\\\  no shutdown |\n|Management Web Server Access (including ASDM and CSM) | http server enable \\\\ http |\n|Mobile User Security (MUS) | webvpn \\\\  mus password \\\\  mus server enable port \\\\ mus |\n|REST API | rest-api image disk0:/rest-api agent |\n|SSL VPN | webvpn \\\\  enable |\n\n_Note: `Management Web Server Access` and `REST API` would only be vulnerable from an IP address in the configured http command range._\n\n\n### FTD Software Vulnerable Configuration\n\nIn the following table, the left column lists Cisco FTD Software features that are potentially vulnerable. The right column indicates the basic configuration for the feature from the `show running-config` CLI command, if it can be determined. These features could cause the SSL listen sockets to be enabled.\n\n|Cisco FTD Software Feature | Possible Vulnerable Configuration |\n|---|---|\n|AnyConnect IKEv2 Remote Access (with client services) | crypto ikev2 enable [...] client-services port |\n|AnyConnect SSL VPN | webvpn \\ enable |\n|HTTP server enabled | http server enable \\ http |\n\n## CVE-2024-20358 \n\nCisco FTD Software is affected only when lockdown mode has been enabled to restrict Linux shell access. Lockdown mode is disabled by default.\n\n# Recommendations\n\nCERT-EU recommends updating to the latest version of Cisco Adaptive Security Appliance (ASA) Software and/or Cisco Firepower Threat Defense (FTD) Software product as soon as possible to mitigate these vulnerabilities.\n\nCERT-EU also recommends following the compromise assessment steps to ensure that vulnerable devices have not been exploited.\n\n## Compromise assessment\n\nCisco Talos has released a blog post to explain how some of these vulnerabilities have been found to be exploited [1]. \n\n1. First, organisations should look for any flows to/from ASA devices to any of the IP addresses present in the IOC list provided at the bottom of this blog. This is one indication that further investigation is necessary.\n2. Additionally, organisations can issue the command `show memory region | include lina` to identify another indicator of compromise. If the output indicates more than one executable memory region (memory regions having `r-xp` permissions), especially if one of these memory sections is exactly 0x1000 bytes, then this is a sign of potential tampering. \n3. It is also recommended, even in the absence of more than one executable memory region, to follow the \"Forensic Recovery and Identification of Line Runner\" steps provided in the blog post.\n\n# References\n\n[1] <https://blog.talosintelligence.com/arcanedoor-new-espionage-focused-campaign-found-targeting-perimeter-network-devices/>\n\n[2] <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-websrvs-dos-X8gNucD2>\n\n[3] <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-persist-rce-FLsNXF4h>\n\n[4] <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-cmd-inj-ZJV8Wysm>",
  "content_html": "<p><em>History:</em></p><ul><li><em>24/04/2024 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On April 24, 2024, Cisco disclosed three vulnerabilities in its management and VPN web servers for Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software product. </p><p>Some of these vulnerabilities are currently being exploited[1]. It is recommended upgrading affected products as soon as possible, and checking for possible compromise.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability <strong>CVE-2024-20353</strong> [1], with a CVSS score of 8.6, allows an attacker to cause a DoS condition by sending a crafted HTTP request to the web server on a targeted device. A successful exploit would result in an unexpected reloading of the device. This vulnerability is due to incomplete error checking when parsing an HTTP header.</p><p>The vulnerability <strong>CVE-2024-20359</strong> [2], with a CVSS score of 6.0, allows an authenticated, local attacker to execute arbitrary code with root-level privileges on the affected device by copying a crafted file to its <code>disk0:</code> file system. The execution occurs after the next reload of the targeted device. This vulnerability is due to improper validation of a file when it is read from system flash memory. It is also important to note that the injected code could persist across device reboots. Administrator-level privileges are required to exploit this vulnerability.</p><p>The vulnerability <strong>CVE-2024-20358</strong> [3], with a CVSS score of 6.0, allows an authenticated, local attacker to execute arbitrary commands on the underlying operating system (i.e., Linux) with root-level privileges. An attacker could exploit this vulnerability by restoring a crafted backup file to an affected device. This vulnerability exists because the contents of a backup file are improperly sanitised at restore time. Administrator-level privileges are required to exploit this vulnerability.</p><h2 id=\"affected-products\">Affected Products</h2><p>These vulnerabilities affect Cisco ASA and FTD appliances. In order to understand if one version is affected, Cisco provides its <a rel=\"noopener\" target=\"_blank\" href=\"https://sec.cloudapps.cisco.com/security/center/softwarechecker.x\">Cisco Software Checker tool</a>.</p><h3 id=\"cve-2024-20353\">CVE-2024-20353</h3><p>This vulnerability affects Cisco ASA Software and FTD Software if they have one or more of the vulnerable configurations listed below</p><p>To determine whether a device that is running Cisco ASA Software or FTD Software is affected, use the <code>show asp table socket | include SSL</code> command and look for an SSL listen socket on any TCP port. If a socket is present in the output, the device should be considered vulnerable. The following example shows the output for a Cisco ASA device with two SSL listen sockets on TCP port 443 and TCP port 8443:</p><pre><code>ciscoasa#  show asp table socket | include SSL\n    SSL       00185038  LISTEN     172.16.0.250:443    0.0.0.0:*\n    SSL       00188638  LISTEN      10.0.0.250:8443    0.0.0.0:*   \n\n</code></pre><h4 id=\"asa-software-vulnerable-configuration\">ASA Software Vulnerable Configuration</h4><p>In the following table, the left column lists Cisco ASA Software features that are potentially vulnerable. The right column indicates the basic configuration for the feature from the <code>show running-config</code> CLI command, if it can be determined. These features could cause the SSL listen sockets to be enabled.</p><table><thead><tr><th>Cisco ASA Software Feature</th><th>Possible Vulnerable Configuration</th></tr></thead><tbody><tr><td>AnyConnect IKEv2 Remote Access (with client services)</td><td>crypto ikev2 enable [...] client-services port</td></tr><tr><td>Local Certificate Authority (CA)</td><td>crypto ca server \\ no shutdown</td></tr><tr><td>Management Web Server Access (including ASDM and CSM)</td><td>http server enable \\ http</td></tr><tr><td>Mobile User Security (MUS)</td><td>webvpn \\ mus password \\ mus server enable port \\ mus</td></tr><tr><td>REST API</td><td>rest-api image disk0:/rest-api agent</td></tr><tr><td>SSL VPN</td><td>webvpn \\ enable</td></tr></tbody></table><p><em>Note: <code>Management Web Server Access</code> and <code>REST API</code> would only be vulnerable from an IP address in the configured http command range.</em></p><h4 id=\"ftd-software-vulnerable-configuration\">FTD Software Vulnerable Configuration</h4><p>In the following table, the left column lists Cisco FTD Software features that are potentially vulnerable. The right column indicates the basic configuration for the feature from the <code>show running-config</code> CLI command, if it can be determined. These features could cause the SSL listen sockets to be enabled.</p><table><thead><tr><th>Cisco FTD Software Feature</th><th>Possible Vulnerable Configuration</th></tr></thead><tbody><tr><td>AnyConnect IKEv2 Remote Access (with client services)</td><td>crypto ikev2 enable [...] client-services port</td></tr><tr><td>AnyConnect SSL VPN</td><td>webvpn \\ enable</td></tr><tr><td>HTTP server enabled</td><td>http server enable \\ http</td></tr></tbody></table><h3 id=\"cve-2024-20358\">CVE-2024-20358</h3><p>Cisco FTD Software is affected only when lockdown mode has been enabled to restrict Linux shell access. Lockdown mode is disabled by default.</p><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends updating to the latest version of Cisco Adaptive Security Appliance (ASA) Software and/or Cisco Firepower Threat Defense (FTD) Software product as soon as possible to mitigate these vulnerabilities.</p><p>CERT-EU also recommends following the compromise assessment steps to ensure that vulnerable devices have not been exploited.</p><h3 id=\"compromise-assessment\">Compromise assessment</h3><p>Cisco Talos has released a blog post to explain how some of these vulnerabilities have been found to be exploited [1]. </p><ol><li>First, organisations should look for any flows to/from ASA devices to any of the IP addresses present in the IOC list provided at the bottom of this blog. This is one indication that further investigation is necessary.</li><li>Additionally, organisations can issue the command <code>show memory region | include lina</code> to identify another indicator of compromise. If the output indicates more than one executable memory region (memory regions having <code>r-xp</code> permissions), especially if one of these memory sections is exactly 0x1000 bytes, then this is a sign of potential tampering. </li><li>It is also recommended, even in the absence of more than one executable memory region, to follow the \"Forensic Recovery and Identification of Line Runner\" steps provided in the blog post.</li></ol><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.talosintelligence.com/arcanedoor-new-espionage-focused-campaign-found-targeting-perimeter-network-devices/\">https://blog.talosintelligence.com/arcanedoor-new-espionage-focused-campaign-found-targeting-perimeter-network-devices/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-websrvs-dos-X8gNucD2\">https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-websrvs-dos-X8gNucD2</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-persist-rce-FLsNXF4h\">https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-persist-rce-FLsNXF4h</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-cmd-inj-ZJV8Wysm\">https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-cmd-inj-ZJV8Wysm</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}