{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2023-033.pdf"
  },
  "title": "Critical Vulnerability in MOVEit Transfer",
  "serial_number": "2023-033",
  "publish_date": "19-06-2023 10:23:44",
  "description": "On May 31, 2023, an SQL injection vulnerability has been found in the MOVEit Transfer web application. This critical vulnerability could lead to escalated privileges and potential unauthorised access to the environment. Associated CVE is CVE-2023-34362 with CVSS score of 9.8 and it is actively exploited in the wild. <br>\nOn June 9, 2023, a second patch was released to address several parts of an exploit chain that were not fully mitigated by the first patch. CVE-2023-35036 (CVSS score 9.1) was assigned to the second vulnerability on June 11.<br>\nResearchers have released proof-of-concept (PoC) exploit code for CVE-2023-34362, as well as technical root cause analysis of the flaw.<br>\nCERT-EU highly recommends taking immediate action if you are using this product.<br>\n",
  "url_title": "2023-033",
  "content_markdown": "--- \ntitle: 'Critical Vulnerability in MOVEit Transfer' \nversion: '1.1'\nnumber: '2023-033'\noriginal_date: 'May 31, 2023'\ndate: 'Jun 19, 2023'\n---\n\n_History:_\n\n* _02/06/2023 --- v1.0 -- Initial publication_\n* _19/06/2023 --- v1.1 -- Updated with information regarding the POC and technical details_\n\n# Summary\n\nOn May 31, 2023, an SQL injection vulnerability has been found in the MOVEit Transfer web application. This critical vulnerability could lead to escalated privileges and potential unauthorised access to the environment. Associated CVE is CVE-2023-34362 with CVSS score of 9.8 [1] and it is actively exploited in the wild [2, 6]. \n\nOn June 9, 2023, a second patch was released to address several parts of an exploit chain that were not fully mitigated by the first patch. CVE-2023-35036 (CVSS score 9.1) was assigned to the second vulnerability on June 11 [7].\n\nResearchers have released proof-of-concept (PoC) exploit code for CVE-2023-34362 [3], as well as technical root cause analysis of the flaw [4, 5].\n\nCERT-EU highly recommends taking immediate action if you are using this product.\n\n# Technical Details\n\nA successful attack could allow unauthenticated remote access to any folder or file within a MOVEit system. Moreover, depending on the database engine being used (MySQL, Microsoft SQL Server, or Azure SQL), an attacker may be able to infer information about the structure and contents of the database in addition to executing SQL statements that alter or delete database elements [4, 5].  \n\n## Detection \n\nAn attacker can leverage the SQLi to clear the database of almost all IOC’s. However there is one entry in the database the attacker cannot clear. When performing the final SQLi to delete all IOCs from the database, a single log entry will remain. This log entry is generated after the SQLi is performed and as such cannot be deleted via SQLi.\n\nThis log entry will have an Action of `msg_post` and will contain the IP address of the attacker in the `IPAddress` field and a timestamp in the `LogTime` field. The other fields may contain values the attacker used when performing the SQLi, such as the `MyGuestEmailAddr` value from the forged package used during SQLi.\n\nA strong IOC may be present in the log file `C:\\MOVEitTransfer\\Logs\\DMZ_WebApi.log`. During deserialisation of the malicious gadget an exception of type `TargetInvocationException` will be thrown and the call stack will show the method: \n\n```\nMOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream\n```\n\nwhich is the method that contains the deserialisation vulnerability [5]. \n\n# Affected Products\n\nThe affected product are:\n\n- MOVEit Transfer before 2023.0.0, 2022.1.x, 2022.0.x, 2021.1.x, 2021.0.x.\n\n# Recommendations\n\nTo mitigate this vulnerability, upgrade MOVEit Transfer to 2023.0.1, 2022.1.5, 2022.0.4, 2021.1.4 and 2021.0.6.\n\nAccording to Progress’ mitigations [1], before applying the patches, the HTTP (TCP/80) and HTTPS (TCP/443) traffic should be denied to the MOVEit environment and activated after that. Also, any potential unauthorised files or user accounts should be cleaned from the system. \n\nNote that this will block all access to the system, but SFTP/FTP will still work, which currently appears unaffected.\n\n# References\n\n[1] <https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023> \n\n[2] <https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/>\n\n[3] <https://www.horizon3.ai/moveit-transfer-cve-2023-34362-deep-dive-and-indicators-of-compromise/>\n\n[4] <https://github.com/horizon3ai/CVE-2023-34362>\n\n[5] <https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis>\n\n[6] <https://www.helpnetsecurity.com/2023/06/05/cve-2023-34362-exploited/>\n\n[7] <https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-CVE-2023-35036-June-9-2023>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>02/06/2023 --- v1.0 -- Initial publication</em></li><li><em>19/06/2023 --- v1.1 -- Updated with information regarding the POC and technical details</em></li></ul><h2 id=\"summary\">Summary</h2><p>On May 31, 2023, an SQL injection vulnerability has been found in the MOVEit Transfer web application. This critical vulnerability could lead to escalated privileges and potential unauthorised access to the environment. Associated CVE is CVE-2023-34362 with CVSS score of 9.8 [1] and it is actively exploited in the wild [2, 6]. </p><p>On June 9, 2023, a second patch was released to address several parts of an exploit chain that were not fully mitigated by the first patch. CVE-2023-35036 (CVSS score 9.1) was assigned to the second vulnerability on June 11 [7].</p><p>Researchers have released proof-of-concept (PoC) exploit code for CVE-2023-34362 [3], as well as technical root cause analysis of the flaw [4, 5].</p><p>CERT-EU highly recommends taking immediate action if you are using this product.</p><h2 id=\"technical-details\">Technical Details</h2><p>A successful attack could allow unauthenticated remote access to any folder or file within a MOVEit system. Moreover, depending on the database engine being used (MySQL, Microsoft SQL Server, or Azure SQL), an attacker may be able to infer information about the structure and contents of the database in addition to executing SQL statements that alter or delete database elements [4, 5]. </p><h3 id=\"detection\">Detection</h3><p>An attacker can leverage the SQLi to clear the database of almost all IOC’s. However there is one entry in the database the attacker cannot clear. When performing the final SQLi to delete all IOCs from the database, a single log entry will remain. This log entry is generated after the SQLi is performed and as such cannot be deleted via SQLi.</p><p>This log entry will have an Action of <code>msg_post</code> and will contain the IP address of the attacker in the <code>IPAddress</code> field and a timestamp in the <code>LogTime</code> field. The other fields may contain values the attacker used when performing the SQLi, such as the <code>MyGuestEmailAddr</code> value from the forged package used during SQLi.</p><p>A strong IOC may be present in the log file <code>C:\\MOVEitTransfer\\Logs\\DMZ_WebApi.log</code>. During deserialisation of the malicious gadget an exception of type <code>TargetInvocationException</code> will be thrown and the call stack will show the method: </p><pre><code>MOVEit.DMZ.Application.Folders.ResumableUploadFilePartHandler.DeserializeFileUploadStream\n</code></pre><p>which is the method that contains the deserialisation vulnerability [5]. </p><h2 id=\"affected-products\">Affected Products</h2><p>The affected product are:</p><ul><li>MOVEit Transfer before 2023.0.0, 2022.1.x, 2022.0.x, 2021.1.x, 2021.0.x.</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>To mitigate this vulnerability, upgrade MOVEit Transfer to 2023.0.1, 2022.1.5, 2022.0.4, 2021.1.4 and 2021.0.6.</p><p>According to Progress’ mitigations [1], before applying the patches, the HTTP (TCP/80) and HTTPS (TCP/443) traffic should be denied to the MOVEit environment and activated after that. Also, any potential unauthorised files or user accounts should be cleaned from the system. </p><p>Note that this will block all access to the system, but SFTP/FTP will still work, which currently appears unaffected.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023\">https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-31May2023</a> </p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/\">https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.horizon3.ai/moveit-transfer-cve-2023-34362-deep-dive-and-indicators-of-compromise/\">https://www.horizon3.ai/moveit-transfer-cve-2023-34362-deep-dive-and-indicators-of-compromise/</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/horizon3ai/CVE-2023-34362\">https://github.com/horizon3ai/CVE-2023-34362</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis\">https://attackerkb.com/topics/mXmV0YpC3W/cve-2023-34362/rapid7-analysis</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.helpnetsecurity.com/2023/06/05/cve-2023-34362-exploited/\">https://www.helpnetsecurity.com/2023/06/05/cve-2023-34362-exploited/</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-CVE-2023-35036-June-9-2023\">https://community.progress.com/s/article/MOVEit-Transfer-Critical-Vulnerability-CVE-2023-35036-June-9-2023</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}