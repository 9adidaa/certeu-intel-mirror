{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2023-043.pdf"
  },
  "title": "Grafana Authentication Bypass Using Azure AD OAuth",
  "serial_number": "2023-043",
  "publish_date": "29-06-2023 08:51:07",
  "description": "On the 22nd of June, 2023, a critical security vulnerability - CVE-2023-3128 - was identified in Grafana. Grafana was found to be validating Azure Active Directory (AD) accounts based on the email claim. However, on Azure AD, the profile email field is not unique and can be easily altered. This issue can lead to Grafana account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant Azure AD OAuth application.<br>\n",
  "url_title": "2023-043",
  "content_markdown": "---\ntitle: 'Grafana Authentication Bypass Using Azure AD OAuth'\nversion: '1.0'\nnumber: '2023-043'\noriginal_date: 'June 22, 2023'\ndate: 'June 29, 2023'\n---\n\n_History:_\n\n* _29/06/2023 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn the 22nd of June, 2023, a critical security vulnerability -- CVE-2023-3128 -- was identified in Grafana. Grafana was found to be validating Azure Active Directory (AD) accounts based on the email claim. However, on Azure AD, the profile email field is not unique and can be easily altered. This issue can lead to Grafana account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant Azure AD OAuth application [1,2].\n\n# Technical Details\n\nGrafana is validating Azure AD accounts based on the email claim. On Azure AD, the profile email field is not unique and can be easily modified. This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app [1].\n\nThe impact extends to all Grafana deployments that utilise Azure AD OAuth with a multi-tenant Azure application and lack of restrictions on user groups allowed to authenticate [1].\n\n# Affected Products\n\nThe vulnerability affects all Grafana versions from 6.7.0 onwards.\n\n# Recommendations\n\nCERT-EU recommends to upgrade all Grafana deployments. Appropriate patches have been applied to Grafana Cloud. Grafana provide alternative mitigation solution that one can implement [1].\n\n# References\n\n[1] <https://grafana.com/blog/2023/06/22/grafana-security-release-for-cve-2023-3128/>\n\n[2] <https://grafana.com/security/security-advisories/cve-2023-3128/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>29/06/2023 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On the 22nd of June, 2023, a critical security vulnerability -- CVE-2023-3128 -- was identified in Grafana. Grafana was found to be validating Azure Active Directory (AD) accounts based on the email claim. However, on Azure AD, the profile email field is not unique and can be easily altered. This issue can lead to Grafana account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant Azure AD OAuth application [1,2].</p><h2 id=\"technical-details\">Technical Details</h2><p>Grafana is validating Azure AD accounts based on the email claim. On Azure AD, the profile email field is not unique and can be easily modified. This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app [1].</p><p>The impact extends to all Grafana deployments that utilise Azure AD OAuth with a multi-tenant Azure application and lack of restrictions on user groups allowed to authenticate [1].</p><h2 id=\"affected-products\">Affected Products</h2><p>The vulnerability affects all Grafana versions from 6.7.0 onwards.</p><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends to upgrade all Grafana deployments. Appropriate patches have been applied to Grafana Cloud. Grafana provide alternative mitigation solution that one can implement [1].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://grafana.com/blog/2023/06/22/grafana-security-release-for-cve-2023-3128/\">https://grafana.com/blog/2023/06/22/grafana-security-release-for-cve-2023-3128/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://grafana.com/security/security-advisories/cve-2023-3128/\">https://grafana.com/security/security-advisories/cve-2023-3128/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}