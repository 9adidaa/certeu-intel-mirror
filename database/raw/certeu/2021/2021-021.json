{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-021.pdf"
  },
  "title": "UPDATE: Critical Vulnerability in Pulse Connect Secure",
  "serial_number": "2021-021",
  "publish_date": "21-04-2021 15:13:00",
  "description": "On April 20, 2021, Ivanti has announced that a vulnerability (CVE-2021-22893) was discovered in their Pulse Connect Secure (PCS) product. While initially a patch was not available, the vendor released information on how to mitigate the vulnerability. Furthermore, on 3 May 2021, Ivanti has released PCS version 9.1R11.4, which fixes the initially identified vulnerability along with three others. Three of the identified vulnerabilities have a critical CVSS score, the first of which has been observed to be exploited in the wild. These vulnerabilities pose significant risks and have been widely reported on.<br><br>On May 14, 2021, Ivanti has released another security advisory addressing yet another vulnerability (CVE-2021-22908) also affecting the recently released version 9.1R11.4 which fixes the aforementioned ones. The newly discovered vulnerability is a buffer overflow with a CVSS score of 8.5. At the time the vendor provided mitigation measures to apply until the vulnerability is patched.<br><br>On June 11, 2021, PCS version 9.1R11.5 was released, which provides the security hardening required to patch this latest vulnerability.<br><br>On August 5, 2021, Ivanti has published another security advisory addressing multiple vulnerablities affecting Pulse Connect Secure versions prior to 9.1R12. This last release fixes all vulnerabilities and also includes enhanced features such as the incorporation of the Pulse Security Integrity Checker Tool directly into the product.",
  "url_title": "2021-021",
  "content_markdown": "---\ntitle: 'Critical Vulnerability in Pulse Connect Secure'\nversion: '1.4'\nnumber: '2021-021'\ndate: 'August 5, 2021'\n---\n\nHistory:\n\n- 21/04/2021 --- v1.0 -- Initial publication\n- 03/05/2021 --- v1.1 -- Update about new PCS release (9.1R11.4)\n- 17/05/2021 --- v1.2 -- Update about newly discovered vulnerability\n- 14/06/2021 --- v1.3 -- Update about new PCS release (9.1R11.5)\n- 05/08/2021 --- v1.4 -- Update about new PCS release (9.1R12)\n\n# Summary\n\nOn April 20, 2021, Ivanti has announced that a vulnerability (CVE-2021-22893) was discovered in their Pulse Connect Secure (PCS) product. While initially a patch was not available, the vendor released information on how to mitigate the vulnerability. Furthermore, on 3 May 2021, Ivanti has released PCS version 9.1R11.4, which fixes the initially identified vulnerability along with three others [1, 2]. Three of the identified vulnerabilities have a **critical CVSS score**, the first of which has been observed to be exploited in the wild. These vulnerabilities pose significant risks and have been widely reported on [4, 5, 6, 7].\n\nOn May 14, 2021, Ivanti has released another security advisory addressing yet another vulnerability (CVE-2021-22908) also affecting the recently released version 9.1R11.4 which fixes the aforementioned ones [8]. The newly discovered vulnerability is a _buffer overflow_ with a CVSS score of 8.5. At the time the vendor provided mitigation measures to apply until the vulnerability is patched.\n\nOn June 11, 2021, PCS version 9.1R11.5 was released [9], which provides the security hardening required to patch this latest vulnerability.\n\nOn August 5, 2021, Ivanti has published another security advisory [10] addressing multiple vulnerabilities affecting Pulse Connect Secure versions prior to 9.1R12. This last release fixes all vulnerabilities and also includes enhanced features such as the incorporation of the Pulse Security Integrity Checker Tool directly into the product.\n\n# Technical Details\n\nVulnerabilities patched on 3rd of May, 2021 in PCS version 9.1R11.4 [1]:\n\n- **CVE-2021-22893** _(CVSS Score 10.0)_ - Multiple use after free in Pulse Connect Secure before 9.1R11.4 allows a remote unauthenticated attacker to execute arbitrary code via license services.\n- **CVE-2021-22894** _(CVSS Score 9.9)_ - Buffer overflow in Pulse Connect Secure Collaboration Suite before 9.1R11.4 allows a remote authenticated users to execute arbitrary code as the root user via maliciously crafted meeting room.\n- **CVE-2021-22899** _(CVSS Score 9.9)_ - Command Injection in Pulse Connect Secure before 9.1R11.4 allows a remote authenticated users to perform remote code execution via Windows File Resource Profiles.\n- **CVE-2021-22900** _(CVSS Score 7.2)_ - Multiple unrestricted uploads in Pulse Connect Secure before 9.1R11.4 allow an authenticated administrator to perform a file write via a maliciously crafted archive upload in the administrator web interface.\n\nVulnerabilities reported on 14 May 2021 - patched on 11th of June, 2021 in PCS version 9.1R11.5 [8, 9]:\n\n- **CVE-2021-22908** - _(CVSS Score 8.5)_ - Buffer Overflow in Windows File Resource Profiles in 9.X allows a remote authenticated user with privileges to browse SMB shares to execute arbitrary code as the root user. As of version 9.1R3, this permission is not enabled by default.\n\nVulnerabilities reported on 5 August 2021 - patched on 2nd of August, 2021 in PCS version 9.1R12 [10]:\n\n- **CVE-2021-22937** _(CVSS Score 9.1)_ - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform a file write via a maliciously crafted archive uploaded in the administrator web interface. \n\n- **CVE-2021-22933** _(CVSS Score 7.6)_ - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform an arbitrary file delete via a maliciously crafted web request. \n\n- **CVE-2021-22934** _(CVSS Score 8.0)_ - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator or compromised Pulse Connect Secure device in a load-balanced configuration to perform a buffer overflow via a malicious crafted web request. \n\n- **CVE-2021-22935** _(CVSS Score 9.1)_ - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform command injection via an unsanitized web parameter. \n\n- **CVE-2021-22936** _(CVSS Score 8.2)_ - A vulnerability in Pulse Connect Secure before 9.1R12 could allow a threat actor to perform a cross-site script attack against an authenticated administrator via an unsanitized web parameter. \n\n- **CVE-2021-22938** _(CVSS Score 7.9)_ - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform command injection via an unsanitized web parameter in the administrator web console. \n\n## Detection\n\nAccess to the following URLs may facilitate the exploitation of some vulnerabilities [1]:\n\n\t^/+dana/+meeting\n\t^/+dana/+fb/+smb\n\t^/+dana-cached/+fb/+smb\n\t^/+dana-ws/+namedusers\n\t^/+dana-ws/+metric\n\nInvestigation of past and current logs may help identify potential exploitation attempts. Access to these URLs should be blocked once the mitigations described below are applied.\n\n# Products Affected\n\n- By CVE-2021-22893 - PCS 9.0R3/9.1R1 up to PCS 9.1R11.3\n- By CVE-2021-22894, CVE-2021-22899, CVE-2021-22900 - PCS 9.1Rx and 9.0Rx up to PCS 9.1R11.3\n- By CVE-2021-22908 - PCS 9.0RX and 9.1RX up to 9.1R11.4\n- By CVE-2021-22937, CVE-2021-22933, CVE-2021-22934, CVE-2021-22935, CVE-2021-22936, CVE-2021-22938 - PCS before 9.1R12\n\n# Recommendations\n\nThe vulnerabilities listed above have been included in the latest version of PCS, 9.1R12, which was released on 2 August 2021 [10]. We strongly encourage you to upgrade to ensure your organization is protected.  \n\nThe vendor has released an Integrity Tool [3], which allows to verify if the PCS device might have been compromised. It is important to note that the tool should be able to detect infections related to this new vulnerability as well as any previous infections that may have remained undetected. **It is hence strongly recommended to use this tool, on a very regular basis, to ensure the integrity of the PCS**. However, please note that running the tool will require a reboot. In case the Integrity Tool finds mismatched files or newly detected files, please download the *Admin Generated Snapshot* post-reboot and create a *Support Ticket* with Ivanti for further investigation [3]. In the latest version (9.1R12), the Pulse Security Integrity Checker Tool is directly built into the product. This built-in feature eliminates the need for scheduled downtime to run an integrity check [10].  \n\n## Mitigations\n\nWhile patches are available, the vendor also provided mitigation measures that prevent exploitation of these vulnerabilities. They can be mitigated by importing the `Workaround-2104.xml` file as described in [1] and `Workaround-2105.xml`. Furthermore, customers should disable the Windows File Browser - also as described in [1].\n\nPlease note that while PCS version 9.1R11.4 does not fully protect currently against the exploitation of CVE-2021-22908 and require deploying `Workaround-2105.xml`. PCS version 9.1R11.3 with applied mitigation `Workaround-2104.xml` also protects against CVE-2021-22908. In this case, deploying `Workaround-2105.xml` is not needed [8]. PCS version 9.1R11.5 fully protects against the known vulnerabilities.\n\n# References\n\n[1] <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784>\n\n[2] <https://blog.pulsesecure.net/pulse-connect-secure-security-update/>\n\n[3] <https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755>\n\n[4] <https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html>\n\n[5] <https://www.reuters.com/technology/china-linked-hackers-used-pulse-secure-flaw-target-us-defense-industry-2021-04-20/>\n\n[6] <https://www.bleepingcomputer.com/news/security/pulse-secure-vpn-zero-day-used-to-hack-defense-firms-govt-orgs/>\n\n[7] <https://www.cyberscoop.com/pulse-secure-china-exploit-mandiant/>\n\n[8] <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800>\n\n[9] <https://www-prev.pulsesecure.net/download/techpubs/current/2373/pulse-connect-secure/pcs/9.1rx/9.1r11/ps-pcs-sa-9.1r11.5-releasenotes.pdf>\n\n[10] <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44858/>\n",
  "content_html": "<p>History:</p><ul><li>21/04/2021 --- v1.0 -- Initial publication</li><li>03/05/2021 --- v1.1 -- Update about new PCS release (9.1R11.4)</li><li>17/05/2021 --- v1.2 -- Update about newly discovered vulnerability</li><li>14/06/2021 --- v1.3 -- Update about new PCS release (9.1R11.5)</li><li>05/08/2021 --- v1.4 -- Update about new PCS release (9.1R12)</li></ul><h2 id=\"summary\">Summary</h2><p>On April 20, 2021, Ivanti has announced that a vulnerability (CVE-2021-22893) was discovered in their Pulse Connect Secure (PCS) product. While initially a patch was not available, the vendor released information on how to mitigate the vulnerability. Furthermore, on 3 May 2021, Ivanti has released PCS version 9.1R11.4, which fixes the initially identified vulnerability along with three others [1, 2]. Three of the identified vulnerabilities have a <strong>critical CVSS score</strong>, the first of which has been observed to be exploited in the wild. These vulnerabilities pose significant risks and have been widely reported on [4, 5, 6, 7].</p><p>On May 14, 2021, Ivanti has released another security advisory addressing yet another vulnerability (CVE-2021-22908) also affecting the recently released version 9.1R11.4 which fixes the aforementioned ones [8]. The newly discovered vulnerability is a <em>buffer overflow</em> with a CVSS score of 8.5. At the time the vendor provided mitigation measures to apply until the vulnerability is patched.</p><p>On June 11, 2021, PCS version 9.1R11.5 was released [9], which provides the security hardening required to patch this latest vulnerability.</p><p>On August 5, 2021, Ivanti has published another security advisory [10] addressing multiple vulnerabilities affecting Pulse Connect Secure versions prior to 9.1R12. This last release fixes all vulnerabilities and also includes enhanced features such as the incorporation of the Pulse Security Integrity Checker Tool directly into the product.</p><h2 id=\"technical-details\">Technical Details</h2><p>Vulnerabilities patched on 3rd of May, 2021 in PCS version 9.1R11.4 [1]:</p><ul><li><strong>CVE-2021-22893</strong> <em>(CVSS Score 10.0)</em> - Multiple use after free in Pulse Connect Secure before 9.1R11.4 allows a remote unauthenticated attacker to execute arbitrary code via license services.</li><li><strong>CVE-2021-22894</strong> <em>(CVSS Score 9.9)</em> - Buffer overflow in Pulse Connect Secure Collaboration Suite before 9.1R11.4 allows a remote authenticated users to execute arbitrary code as the root user via maliciously crafted meeting room.</li><li><strong>CVE-2021-22899</strong> <em>(CVSS Score 9.9)</em> - Command Injection in Pulse Connect Secure before 9.1R11.4 allows a remote authenticated users to perform remote code execution via Windows File Resource Profiles.</li><li><strong>CVE-2021-22900</strong> <em>(CVSS Score 7.2)</em> - Multiple unrestricted uploads in Pulse Connect Secure before 9.1R11.4 allow an authenticated administrator to perform a file write via a maliciously crafted archive upload in the administrator web interface.</li></ul><p>Vulnerabilities reported on 14 May 2021 - patched on 11th of June, 2021 in PCS version 9.1R11.5 [8, 9]:</p><ul><li><strong>CVE-2021-22908</strong> - <em>(CVSS Score 8.5)</em> - Buffer Overflow in Windows File Resource Profiles in 9.X allows a remote authenticated user with privileges to browse SMB shares to execute arbitrary code as the root user. As of version 9.1R3, this permission is not enabled by default.</li></ul><p>Vulnerabilities reported on 5 August 2021 - patched on 2nd of August, 2021 in PCS version 9.1R12 [10]:</p><ul><li><p><strong>CVE-2021-22937</strong> <em>(CVSS Score 9.1)</em> - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform a file write via a maliciously crafted archive uploaded in the administrator web interface. </p></li><li><p><strong>CVE-2021-22933</strong> <em>(CVSS Score 7.6)</em> - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform an arbitrary file delete via a maliciously crafted web request. </p></li><li><p><strong>CVE-2021-22934</strong> <em>(CVSS Score 8.0)</em> - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator or compromised Pulse Connect Secure device in a load-balanced configuration to perform a buffer overflow via a malicious crafted web request. </p></li><li><p><strong>CVE-2021-22935</strong> <em>(CVSS Score 9.1)</em> - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform command injection via an unsanitized web parameter. </p></li><li><p><strong>CVE-2021-22936</strong> <em>(CVSS Score 8.2)</em> - A vulnerability in Pulse Connect Secure before 9.1R12 could allow a threat actor to perform a cross-site script attack against an authenticated administrator via an unsanitized web parameter. </p></li><li><p><strong>CVE-2021-22938</strong> <em>(CVSS Score 7.9)</em> - A vulnerability in Pulse Connect Secure before 9.1R12 could allow an authenticated administrator to perform command injection via an unsanitized web parameter in the administrator web console. </p></li></ul><h3 id=\"detection\">Detection</h3><p>Access to the following URLs may facilitate the exploitation of some vulnerabilities [1]:</p><pre><code>^/+dana/+meeting\n^/+dana/+fb/+smb\n^/+dana-cached/+fb/+smb\n^/+dana-ws/+namedusers\n^/+dana-ws/+metric\n</code></pre><p>Investigation of past and current logs may help identify potential exploitation attempts. Access to these URLs should be blocked once the mitigations described below are applied.</p><h2 id=\"products-affected\">Products Affected</h2><ul><li>By CVE-2021-22893 - PCS 9.0R3/9.1R1 up to PCS 9.1R11.3</li><li>By CVE-2021-22894, CVE-2021-22899, CVE-2021-22900 - PCS 9.1Rx and 9.0Rx up to PCS 9.1R11.3</li><li>By CVE-2021-22908 - PCS 9.0RX and 9.1RX up to 9.1R11.4</li><li>By CVE-2021-22937, CVE-2021-22933, CVE-2021-22934, CVE-2021-22935, CVE-2021-22936, CVE-2021-22938 - PCS before 9.1R12</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>The vulnerabilities listed above have been included in the latest version of PCS, 9.1R12, which was released on 2 August 2021 [10]. We strongly encourage you to upgrade to ensure your organization is protected. </p><p>The vendor has released an Integrity Tool [3], which allows to verify if the PCS device might have been compromised. It is important to note that the tool should be able to detect infections related to this new vulnerability as well as any previous infections that may have remained undetected. <strong>It is hence strongly recommended to use this tool, on a very regular basis, to ensure the integrity of the PCS</strong>. However, please note that running the tool will require a reboot. In case the Integrity Tool finds mismatched files or newly detected files, please download the <em>Admin Generated Snapshot</em> post-reboot and create a <em>Support Ticket</em> with Ivanti for further investigation [3]. In the latest version (9.1R12), the Pulse Security Integrity Checker Tool is directly built into the product. This built-in feature eliminates the need for scheduled downtime to run an integrity check [10]. </p><h3 id=\"mitigations\">Mitigations</h3><p>While patches are available, the vendor also provided mitigation measures that prevent exploitation of these vulnerabilities. They can be mitigated by importing the <code>Workaround-2104.xml</code> file as described in [1] and <code>Workaround-2105.xml</code>. Furthermore, customers should disable the Windows File Browser - also as described in [1].</p><p>Please note that while PCS version 9.1R11.4 does not fully protect currently against the exploitation of CVE-2021-22908 and require deploying <code>Workaround-2105.xml</code>. PCS version 9.1R11.3 with applied mitigation <code>Workaround-2104.xml</code> also protects against CVE-2021-22908. In this case, deploying <code>Workaround-2105.xml</code> is not needed [8]. PCS version 9.1R11.5 fully protects against the known vulnerabilities.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784\">https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.pulsesecure.net/pulse-connect-secure-security-update/\">https://blog.pulsesecure.net/pulse-connect-secure-security-update/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755\">https://kb.pulsesecure.net/articles/Pulse_Secure_Article/KB44755</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html\">https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.reuters.com/technology/china-linked-hackers-used-pulse-secure-flaw-target-us-defense-industry-2021-04-20/\">https://www.reuters.com/technology/china-linked-hackers-used-pulse-secure-flaw-target-us-defense-industry-2021-04-20/</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/pulse-secure-vpn-zero-day-used-to-hack-defense-firms-govt-orgs/\">https://www.bleepingcomputer.com/news/security/pulse-secure-vpn-zero-day-used-to-hack-defense-firms-govt-orgs/</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.cyberscoop.com/pulse-secure-china-exploit-mandiant/\">https://www.cyberscoop.com/pulse-secure-china-exploit-mandiant/</a></p><p>[8] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800\">https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44800</a></p><p>[9] <a rel=\"noopener\" target=\"_blank\" href=\"https://www-prev.pulsesecure.net/download/techpubs/current/2373/pulse-connect-secure/pcs/9.1rx/9.1r11/ps-pcs-sa-9.1r11.5-releasenotes.pdf\">https://www-prev.pulsesecure.net/download/techpubs/current/2373/pulse-connect-secure/pcs/9.1rx/9.1r11/ps-pcs-sa-9.1r11.5-releasenotes.pdf</a></p><p>[10] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44858/\">https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44858/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}