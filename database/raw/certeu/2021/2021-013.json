{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-013.pdf"
  },
  "title": "UDATE: Zero-Day Vulnerabilities in Microsoft Exchange",
  "serial_number": "2021-013",
  "publish_date": "03-03-2021 09:23:00",
  "description": "Several Zero Day vulnerabilities affecting Microsoft Exchange servers were observed exploited in the wild. Vulnerabilities are critical, so it is extremely important to apply the patches as soon as possible.<br>It has been confirmed that the attacks have started before the patch was available and thousands of Exchange installation have been compromised. At this stage, simply patching is not sufficient. Proper investigation has to be performed to asses the potential compromise.<br>Microsoft has now released a mitigation tool that can help security teams.",
  "url_title": "2021-013",
  "content_markdown": "---\ntitle: 'Zero-Day Vulnerabilities in Microsoft Exchange'\nversion: '1.2'\nnumber: '2021-013'\ndate: 'March 16, 2021'\n---\n\n_History:_\n\n* _03/03/2021 --- v1.0 -- Initial publication_\n* _11/03/2021 --- v1.1 -- Update concerning recommended investigation_\n* _16/03/2021 --- v1.2 -- Update concerning Microsoft mitigation tool_\n\n# Summary\n\nSeveral Zero Day vulnerabilities affecting Microsoft Exchange servers were observed exploited in the wild [1]. Vulnerabilities are critical, so it is extremely important to **apply the patches as soon as possible** [2].\n\nIt has been confirmed that the attacks have started before the patch was available and **thousands** of Exchange installation have been compromised. At this stage, simply patching is **not sufficient**. Proper investigation has to be performed to asses the **potential compromise**.\n\nMicrosoft has now released a mitigation tool that can help security teams [7].\n\n# Technical Details\n\nMicrosoft Exchange vulnerabilities were used to steal e-mails and compromise networks:\n\n* **CVE-2021-26855** -- a server-side request forgery (SSRF) vulnerability in Exchange which allows the attacker to send arbitrary HTTP requests and authenticate as the Exchange server.\n\n* **CVE-2021-26857** -- an insecure deserialisation vulnerability in the Unified Messaging service. Insecure deserialisation is where untrusted user-controllable data is deserialised by a program. Exploiting this vulnerability gives attackers the ability to run code as SYSTEM on the Exchange server. This requires administrator permission or another vulnerability to exploit.\n\n* **CVE-2021-26858** -- a post-authentication arbitrary file write vulnerability in Exchange. When authenticated, the attackers can use this vulnerability to write a file to any path on the server. They could authenticate by exploiting the CVE-2021-26855 SSRF vulnerability or by compromising a legitimate Administrator credentials.\n\n* **CVE-2021-27065** -- a post-authentication arbitrary file write vulnerability in Exchange. This vulnerability can be used to write a file to any path on the server.\n\nAs part of an incident investigation, exploitation of these vulnerabilities was observed starting at least 6th of January 2021. We are not aware of publicly available code to exploit these Exchange vulnerabilities, but given the exposure it may arise soon.\n\n# Affected Products\n\n* Microsoft Exchange Server 2013, 2016 and 2019.\n\nExchange Online service is not affected.\n\n# Recommendations\n\nApply the patches as soon as possible [2]. It is recommended to prioritise the updates on Internet-facing Exchange Servers.\n\nEven for patched, on-premises servers that are (or were) exposing to Internet any other services than SMTP (such as OWA or ActiveSync), we recommend performing the following checks:\n\n- Perform the checks mentioned in the Microsoft paper on your Exchange server [4].\n- Scan Exchange server with Microsoft detection tool [5].\n- Check your logs for the IoCs mentioned in [6].\n\n## Mitigation\n\nThis vulnerability is part of an attack chain. The initial attack requires the ability to make an untrusted connection to Exchange server port 443. This can be protected against by restricting untrusted connections, or by setting up a VPN to separate the Exchange server from external access. Using this mitigation will only protect against the initial portion of the attack. Other portions of the chain can still be triggered if an attacker already has access or can convince an administrator to open a malicious file.\n\nTo help quickly protect the Exchange environments, Microsoft produced an additional series of security updates (SUs) that can be applied to some older (and unsupported) Cumulative Updates (CUs). This is intended only as a temporary measure to help protect vulnerable machines right now. You still need to update to the latest supported CU and then apply the applicable SUs [3].\n\nMicrosoft has released recently a tool that checks if the server is vulnerable, mitigates CVE-2021-26855, downloads and runs the Microsoft Safety Scanner in order to remove any malicious files found [7].\n\n# References\n\n[1] <https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/>\n\n[2] <https://msrc.microsoft.com/update-guide/vulnerability>\n\n[3] <https://techcommunity.microsoft.com/t5/exchange-team-blog/march-2021-exchange-server-security-updates-for-older-cumulative/ba-p/2192020>\n\n[4] <https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/>\n\n[5] <https://www.bleepingcomputer.com/news/security/microsofts-msert-tool-now-finds-web-shells-from-exchange-server-attacks/>\n\n[6] <https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/>\n\n[7] <https://www.bleepingcomputer.com/news/microsoft/microsoft-releases-one-click-exchange-on-premises-mitigation-tool/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>03/03/2021 --- v1.0 -- Initial publication</em></li><li><em>11/03/2021 --- v1.1 -- Update concerning recommended investigation</em></li><li><em>16/03/2021 --- v1.2 -- Update concerning Microsoft mitigation tool</em></li></ul><h2 id=\"summary\">Summary</h2><p>Several Zero Day vulnerabilities affecting Microsoft Exchange servers were observed exploited in the wild [1]. Vulnerabilities are critical, so it is extremely important to <strong>apply the patches as soon as possible</strong> [2].</p><p>It has been confirmed that the attacks have started before the patch was available and <strong>thousands</strong> of Exchange installation have been compromised. At this stage, simply patching is <strong>not sufficient</strong>. Proper investigation has to be performed to asses the <strong>potential compromise</strong>.</p><p>Microsoft has now released a mitigation tool that can help security teams [7].</p><h2 id=\"technical-details\">Technical Details</h2><p>Microsoft Exchange vulnerabilities were used to steal e-mails and compromise networks:</p><ul><li><p><strong>CVE-2021-26855</strong> -- a server-side request forgery (SSRF) vulnerability in Exchange which allows the attacker to send arbitrary HTTP requests and authenticate as the Exchange server.</p></li><li><p><strong>CVE-2021-26857</strong> -- an insecure deserialisation vulnerability in the Unified Messaging service. Insecure deserialisation is where untrusted user-controllable data is deserialised by a program. Exploiting this vulnerability gives attackers the ability to run code as SYSTEM on the Exchange server. This requires administrator permission or another vulnerability to exploit.</p></li><li><p><strong>CVE-2021-26858</strong> -- a post-authentication arbitrary file write vulnerability in Exchange. When authenticated, the attackers can use this vulnerability to write a file to any path on the server. They could authenticate by exploiting the CVE-2021-26855 SSRF vulnerability or by compromising a legitimate Administrator credentials.</p></li><li><p><strong>CVE-2021-27065</strong> -- a post-authentication arbitrary file write vulnerability in Exchange. This vulnerability can be used to write a file to any path on the server.</p></li></ul><p>As part of an incident investigation, exploitation of these vulnerabilities was observed starting at least 6th of January 2021. We are not aware of publicly available code to exploit these Exchange vulnerabilities, but given the exposure it may arise soon.</p><h2 id=\"affected-products\">Affected Products</h2><ul><li>Microsoft Exchange Server 2013, 2016 and 2019.</li></ul><p>Exchange Online service is not affected.</p><h2 id=\"recommendations\">Recommendations</h2><p>Apply the patches as soon as possible [2]. It is recommended to prioritise the updates on Internet-facing Exchange Servers.</p><p>Even for patched, on-premises servers that are (or were) exposing to Internet any other services than SMTP (such as OWA or ActiveSync), we recommend performing the following checks:</p><ul><li>Perform the checks mentioned in the Microsoft paper on your Exchange server [4].</li><li>Scan Exchange server with Microsoft detection tool [5].</li><li>Check your logs for the IoCs mentioned in [6].</li></ul><h3 id=\"mitigation\">Mitigation</h3><p>This vulnerability is part of an attack chain. The initial attack requires the ability to make an untrusted connection to Exchange server port 443. This can be protected against by restricting untrusted connections, or by setting up a VPN to separate the Exchange server from external access. Using this mitigation will only protect against the initial portion of the attack. Other portions of the chain can still be triggered if an attacker already has access or can convince an administrator to open a malicious file.</p><p>To help quickly protect the Exchange environments, Microsoft produced an additional series of security updates (SUs) that can be applied to some older (and unsupported) Cumulative Updates (CUs). This is intended only as a temporary measure to help protect vulnerable machines right now. You still need to update to the latest supported CU and then apply the applicable SUs [3].</p><p>Microsoft has released recently a tool that checks if the server is vulnerable, mitigates CVE-2021-26855, downloads and runs the Microsoft Safety Scanner in order to remove any malicious files found [7].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/\">https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc.microsoft.com/update-guide/vulnerability\">https://msrc.microsoft.com/update-guide/vulnerability</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://techcommunity.microsoft.com/t5/exchange-team-blog/march-2021-exchange-server-security-updates-for-older-cumulative/ba-p/2192020\">https://techcommunity.microsoft.com/t5/exchange-team-blog/march-2021-exchange-server-security-updates-for-older-cumulative/ba-p/2192020</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/\">https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/microsofts-msert-tool-now-finds-web-shells-from-exchange-server-attacks/\">https://www.bleepingcomputer.com/news/security/microsofts-msert-tool-now-finds-web-shells-from-exchange-server-attacks/</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/\">https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/microsoft/microsoft-releases-one-click-exchange-on-premises-mitigation-tool/\">https://www.bleepingcomputer.com/news/microsoft/microsoft-releases-one-click-exchange-on-premises-mitigation-tool/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}