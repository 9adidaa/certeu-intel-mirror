{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-058.pdf"
  },
  "title": "Multiple Severe Vulnerabilities in Cisco Products",
  "serial_number": "2021-058",
  "publish_date": "29-10-2021 12:30:00",
  "description": "On October 27, Cisco released multiple security fixes about vulnerabilities affecting their products, including nine with a high CVSS score. These vulnerabilities affect the open source Snort3 project, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD) and Firepower Management Center software (FMC).",
  "url_title": "2021-058",
  "content_markdown": "---\ntitle: 'Multiple Severe Vulnerabilities in Cisco Products'\nversion: '1.0'\nnumber: '2021-058'\ndate: 'October 29, 2021'\n---\n\n_History:_\n\n* _29/10/2021 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn October 27, Cisco released multiple security fixes about vulnerabilities affecting their products, including nine with a high CVSS score. These vulnerabilities affect the open source Snort3 project, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD) and Firepower Management Center software (FMC) [1].\n\n# Technical Details\n\n## CVE-2021-40116 - Snort Rule Denial of Service Vulnerability\n\nThis vulnerability with a CVSS score of 8.6 out of 10 affects multiple Cisco products running Snort3 releases earlier than `Release 3.1.0.100`, configured with `Block with Reset` or `Interactive Block with reset` actions. It is due to improper handling of these actions, if one of the rules is not configured with proper constraints. A remote, unauthenticated attackers could exploit this vulnerability by sending a crafted IP packet to the products running Snort3 that will cause traffic to be dropped (DoS condition). [2]\n\nThis vulnerability does not affect Snort2 configurations and the following products:\n\n- Adaptive Security Appliance (ASA) Software\n- 1000 Series Integrated Services Routers (ISRs)\n- 4000 Series Integrated Services Routers (ISRs)\n- Catalyst 8000V Edge Software\n- Catalyst 8200 Series Edge Platforms\n- Catalyst 8300 Series Edge Platforms\n- Catalyst 8500 Series Edge Platforms\n- Catalyst 8500L Series Edge Platforms\n- Cloud Services Router 1000V Series\n- Firepower Management Center (FMC) Software\n- Integrated Services Virtual Router (ISRv)\n- Meraki Security Appliances\n\n### Workaround\n\nCisco proposes to change the Snort inspection engine from Snort3 to Snort2, or change all rule actions with `Block with Reset` or `Interactive block with Reset` to another action. Another Workaround proposed by Cisco consists in changing the firewall reset rule by narrowing the configuration rule, or by setting up the application or the protocol. \n\n## CVE-2021-34783 - ASA and FTD Software-Based SSL/TLS Denial of Service Vulnerability\n\nThis vulnerability with a CVSS score of 8.6 out of 10 affects ASA and FTD software, allowing an unauthenticated, remote attacker to cause a Denial of Service condition. This is due to insufficient validation of SSL/TLS messages when the device performs software-based SSL/TLS decryption. To exploit this vulnerability, an attacker could craft and send an SSL/TLS message to an affected device, causing the reload and the DoS condition. [3]\n\n## CVE-2021-34781 - FTD SSH Connections Denial of Service Vulnerability\n\nThis vulnerability with a CVSS score of 8.6 out of 10 affects FTD software, allowing a unauthenticated, remote attacker to cause a Denial of Service condition on the device. This is due to the lack of proper error handling when an SSH session fails to be established. To exploit the vulnerability, an attacker could send a high rate of crafted SSH connections to the device, causing a resource exhaustion, and at the same time, a Denial of Service condition on the device, which should be reloaded to recover [4]. \n\n## CVE-2021-34752/CVE-2021-34755/CVE-2021-34756 - FTD Command Injection Vulnerabilities\n\nThese vulnerabilities with a CVSS score of 7.8 out of 10 affect the Cisco FTD software, allowing an authenticated, local attacker to execute arbitrary commands with root privileges. This is due to multiple vulnerabilities in the CLI of Cisco FTD Software, more precisely to insufficient validation of user-supplied command arguments. To exploit this vulnerability, an attacker could submit a crafted input to execute command with root privileges on the underlying operating system. [8]\n\nDepending on the configuration of the device running the vulnerable release, it might be affected by distinct CVEs:\n\n|Cisco FTD Configuration\t| Associated CVE IDs |\n|--------------------------|------------------|\n|Multi-instance |\tCVE-2021-34755 and CVE-2021-34756 |\n|Default |CVE-2021-34752|\n\n## CVE-2021-34762 - FMC Authenticated Directory Traversal Vulnerability\n\nThis vulnerability with a CVSS score of 8.1 out of 10 affects FMC software, allowing an authenticated, remote attacker to perform directory traversal attack. It is due to insufficient input validation of the HTTPS URL by the web-based management interface. To exploit this vulnerability, an attacker could send crafted HTTPS request that contains directory traversal character sequence, allowing the attacker to read or write arbitrary files on the device. [5]\n\n## CVE-2021-40117 - ASA and FTD SSL/TLS Denial of Service Vulnerability\n\nThis vulnerability with a CVSS score of 8.6 out of 10 affects ASA and FTD software, and allows an unauthenticated, remote attacker to cause a Denial of Service condition. It exists because incoming SSL/TLS packets are not properly processed. To exploit this vulnerability, an attacker could craft and send an SSL/TLS message to an affected device, causing the reload and the DoS condition of it. [6]\n\n## CVE-2021-1573/CVE-2021-34704/CVE-2021-40118 - ASA and FTD Web Services Denial of Service Vulnerabilities\n\nThese vulnerabilities with a CVSS score of 8.6 out of 10 affects ASA and FTD software, and allow an unauthenticated, remote attacker to cause a Denial of Service condition. This is due to improper input validation when parsing HTTPS requests. To exploit this vulnerability, an attacker could send malicious HTTPS request to an affected device, leading to the reload of the device, causing a Denial of Service [7].\n\n## CVE-2021-34792 - ASA and FTD Resource Exhaustion Denial of Service Vulnerability\n\nThis vulnerability with a CVSS score of 8.6 affects ASA and FTD software, and allows an unauthenticated, remote attacker to cause a Denial of Service condition. This is due to improper resource management when connection rates are high. To exploit this vulnerability, an attacker could open a significant number of connections on an affected device, leading to the reload of the device, causing a Denial of Service condition [9].\n\n## CVE-2021-34793 - ASA and FTD Transparent Mode Denial of Service Vulnerability\n\nThis vulnerability with a CVSS score of 8.6 affects ASA and FTD software, allowing an unauthenticated, remote attacker to cause a Denial of Service condition. It is due to incorrect handling of certain TCP segments when the affected device is operating in transparent mode. To exploit this vulnerability, an attacker could send a crafted TCP segment through an affected device, allowing the attacked to poison the MAC address tables in adjacent devices, resulting in network disruption [10].\n\n# Affected Products and Fixed Releases\n\n- Cisco ASA Software\n\n| Cisco ASA Software Release | Fixed Release for All Vulnerabilities Described in the Advisory | \n|---------------|-----------------|\n|9.7 and earlier\t|Migrate to a fixed release.|\n|9.8\t|\t9.8.4.40|\n|9.9 |\tMigrate to a fixed release.|\n|9.10|\tMigrate to a fixed release.|\n|9.12|\t9.12.4.29|\n|9.13|\tMigrate to a fixed release.|\n|9.14|\t9.14.3.9|\n|9.15|\t9.15.1.17|\n|9.16|\t9.16.2.3|\n\n- Cisco FTD Software\n\n|Cisco FTD Software Release | Fixed Release for All Vulnerabilities Described in the Advisory |\n|----|---|\n|6.2.2 and earlier|\tMigrate to a fixed release.|\n|6.2.3\t|Migrate to a fixed release.|\n|6.3.01 |Migrate to a fixed release.|\n|6.4.0 |  6.4.0.13 (Nov 2021)|\n|6.5.0|\tMigrate to a fixed release.|\n|6.6.0|\t6.6.5.1 (Nov 2021)|\n|6.7.0|\t6.7.0.3 (Jan 2022)|\n|7.0.0|\t7.0.1|\n\n# Recommendations\n\nTo fix all these vulnerabilities, CERT-EU and Cisco highly recommend updating each release to the last version, when possible, or to upgrade the release. \n\n# References\n\n[1] <https://tools.Cisco.com/security/center/viewErp.x?alertId=ERP-74773>\n\n[2] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-snort-dos-RywH7ezM>\n\n[3] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-tls-decrypt-dos-BMxYjm8M>\n\n[4] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-dos-rUDseW3r>\n\n[5] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-fmc-dir-traversal-95UyW5tk>\n\n[6] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asaftd-dos-4ygzLKU9>\n\n[7] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asafdt-webvpn-dos-KSqJAKPA>\n\n[8] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-cmdinject-FmzsLN8>\n\n[9] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asa-ftd-dos-Unk689XY>\n\n[10] <https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asa-ftd-dos-JxYWMJyL>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>29/10/2021 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On October 27, Cisco released multiple security fixes about vulnerabilities affecting their products, including nine with a high CVSS score. These vulnerabilities affect the open source Snort3 project, Adaptive Security Appliance (ASA), Firepower Threat Defense (FTD) and Firepower Management Center software (FMC) [1].</p><h2 id=\"technical-details\">Technical Details</h2><h3 id=\"cve-2021-40116-snort-rule-denial-of-service-vulnerability\">CVE-2021-40116 - Snort Rule Denial of Service Vulnerability</h3><p>This vulnerability with a CVSS score of 8.6 out of 10 affects multiple Cisco products running Snort3 releases earlier than <code>Release 3.1.0.100</code>, configured with <code>Block with Reset</code> or <code>Interactive Block with reset</code> actions. It is due to improper handling of these actions, if one of the rules is not configured with proper constraints. A remote, unauthenticated attackers could exploit this vulnerability by sending a crafted IP packet to the products running Snort3 that will cause traffic to be dropped (DoS condition). [2]</p><p>This vulnerability does not affect Snort2 configurations and the following products:</p><ul><li>Adaptive Security Appliance (ASA) Software</li><li>1000 Series Integrated Services Routers (ISRs)</li><li>4000 Series Integrated Services Routers (ISRs)</li><li>Catalyst 8000V Edge Software</li><li>Catalyst 8200 Series Edge Platforms</li><li>Catalyst 8300 Series Edge Platforms</li><li>Catalyst 8500 Series Edge Platforms</li><li>Catalyst 8500L Series Edge Platforms</li><li>Cloud Services Router 1000V Series</li><li>Firepower Management Center (FMC) Software</li><li>Integrated Services Virtual Router (ISRv)</li><li>Meraki Security Appliances</li></ul><h4 id=\"workaround\">Workaround</h4><p>Cisco proposes to change the Snort inspection engine from Snort3 to Snort2, or change all rule actions with <code>Block with Reset</code> or <code>Interactive block with Reset</code> to another action. Another Workaround proposed by Cisco consists in changing the firewall reset rule by narrowing the configuration rule, or by setting up the application or the protocol. </p><h3 id=\"cve-2021-34783-asa-and-ftd-software-based-ssltls-denial-of-service-vulnerability\">CVE-2021-34783 - ASA and FTD Software-Based SSL/TLS Denial of Service Vulnerability</h3><p>This vulnerability with a CVSS score of 8.6 out of 10 affects ASA and FTD software, allowing an unauthenticated, remote attacker to cause a Denial of Service condition. This is due to insufficient validation of SSL/TLS messages when the device performs software-based SSL/TLS decryption. To exploit this vulnerability, an attacker could craft and send an SSL/TLS message to an affected device, causing the reload and the DoS condition. [3]</p><h3 id=\"cve-2021-34781-ftd-ssh-connections-denial-of-service-vulnerability\">CVE-2021-34781 - FTD SSH Connections Denial of Service Vulnerability</h3><p>This vulnerability with a CVSS score of 8.6 out of 10 affects FTD software, allowing a unauthenticated, remote attacker to cause a Denial of Service condition on the device. This is due to the lack of proper error handling when an SSH session fails to be established. To exploit the vulnerability, an attacker could send a high rate of crafted SSH connections to the device, causing a resource exhaustion, and at the same time, a Denial of Service condition on the device, which should be reloaded to recover [4]. </p><h3 id=\"cve-2021-34752cve-2021-34755cve-2021-34756-ftd-command-injection-vulnerabilities\">CVE-2021-34752/CVE-2021-34755/CVE-2021-34756 - FTD Command Injection Vulnerabilities</h3><p>These vulnerabilities with a CVSS score of 7.8 out of 10 affect the Cisco FTD software, allowing an authenticated, local attacker to execute arbitrary commands with root privileges. This is due to multiple vulnerabilities in the CLI of Cisco FTD Software, more precisely to insufficient validation of user-supplied command arguments. To exploit this vulnerability, an attacker could submit a crafted input to execute command with root privileges on the underlying operating system. [8]</p><p>Depending on the configuration of the device running the vulnerable release, it might be affected by distinct CVEs:</p><table><thead><tr><th>Cisco FTD Configuration</th><th>Associated CVE IDs</th></tr></thead><tbody><tr><td>Multi-instance</td><td>CVE-2021-34755 and CVE-2021-34756</td></tr><tr><td>Default</td><td>CVE-2021-34752</td></tr></tbody></table><h3 id=\"cve-2021-34762-fmc-authenticated-directory-traversal-vulnerability\">CVE-2021-34762 - FMC Authenticated Directory Traversal Vulnerability</h3><p>This vulnerability with a CVSS score of 8.1 out of 10 affects FMC software, allowing an authenticated, remote attacker to perform directory traversal attack. It is due to insufficient input validation of the HTTPS URL by the web-based management interface. To exploit this vulnerability, an attacker could send crafted HTTPS request that contains directory traversal character sequence, allowing the attacker to read or write arbitrary files on the device. [5]</p><h3 id=\"cve-2021-40117-asa-and-ftd-ssltls-denial-of-service-vulnerability\">CVE-2021-40117 - ASA and FTD SSL/TLS Denial of Service Vulnerability</h3><p>This vulnerability with a CVSS score of 8.6 out of 10 affects ASA and FTD software, and allows an unauthenticated, remote attacker to cause a Denial of Service condition. It exists because incoming SSL/TLS packets are not properly processed. To exploit this vulnerability, an attacker could craft and send an SSL/TLS message to an affected device, causing the reload and the DoS condition of it. [6]</p><h3 id=\"cve-2021-1573cve-2021-34704cve-2021-40118-asa-and-ftd-web-services-denial-of-service-vulnerabilities\">CVE-2021-1573/CVE-2021-34704/CVE-2021-40118 - ASA and FTD Web Services Denial of Service Vulnerabilities</h3><p>These vulnerabilities with a CVSS score of 8.6 out of 10 affects ASA and FTD software, and allow an unauthenticated, remote attacker to cause a Denial of Service condition. This is due to improper input validation when parsing HTTPS requests. To exploit this vulnerability, an attacker could send malicious HTTPS request to an affected device, leading to the reload of the device, causing a Denial of Service [7].</p><h3 id=\"cve-2021-34792-asa-and-ftd-resource-exhaustion-denial-of-service-vulnerability\">CVE-2021-34792 - ASA and FTD Resource Exhaustion Denial of Service Vulnerability</h3><p>This vulnerability with a CVSS score of 8.6 affects ASA and FTD software, and allows an unauthenticated, remote attacker to cause a Denial of Service condition. This is due to improper resource management when connection rates are high. To exploit this vulnerability, an attacker could open a significant number of connections on an affected device, leading to the reload of the device, causing a Denial of Service condition [9].</p><h3 id=\"cve-2021-34793-asa-and-ftd-transparent-mode-denial-of-service-vulnerability\">CVE-2021-34793 - ASA and FTD Transparent Mode Denial of Service Vulnerability</h3><p>This vulnerability with a CVSS score of 8.6 affects ASA and FTD software, allowing an unauthenticated, remote attacker to cause a Denial of Service condition. It is due to incorrect handling of certain TCP segments when the affected device is operating in transparent mode. To exploit this vulnerability, an attacker could send a crafted TCP segment through an affected device, allowing the attacked to poison the MAC address tables in adjacent devices, resulting in network disruption [10].</p><h2 id=\"affected-products-and-fixed-releases\">Affected Products and Fixed Releases</h2><ul><li>Cisco ASA Software</li></ul><table><thead><tr><th>Cisco ASA Software Release</th><th>Fixed Release for All Vulnerabilities Described in the Advisory</th></tr></thead><tbody><tr><td>9.7 and earlier</td><td>Migrate to a fixed release.</td></tr><tr><td>9.8</td><td>9.8.4.40</td></tr><tr><td>9.9</td><td>Migrate to a fixed release.</td></tr><tr><td>9.10</td><td>Migrate to a fixed release.</td></tr><tr><td>9.12</td><td>9.12.4.29</td></tr><tr><td>9.13</td><td>Migrate to a fixed release.</td></tr><tr><td>9.14</td><td>9.14.3.9</td></tr><tr><td>9.15</td><td>9.15.1.17</td></tr><tr><td>9.16</td><td>9.16.2.3</td></tr></tbody></table><ul><li>Cisco FTD Software</li></ul><table><thead><tr><th>Cisco FTD Software Release</th><th>Fixed Release for All Vulnerabilities Described in the Advisory</th></tr></thead><tbody><tr><td>6.2.2 and earlier</td><td>Migrate to a fixed release.</td></tr><tr><td>6.2.3</td><td>Migrate to a fixed release.</td></tr><tr><td>6.3.01</td><td>Migrate to a fixed release.</td></tr><tr><td>6.4.0</td><td>6.4.0.13 (Nov 2021)</td></tr><tr><td>6.5.0</td><td>Migrate to a fixed release.</td></tr><tr><td>6.6.0</td><td>6.6.5.1 (Nov 2021)</td></tr><tr><td>6.7.0</td><td>6.7.0.3 (Jan 2022)</td></tr><tr><td>7.0.0</td><td>7.0.1</td></tr></tbody></table><h2 id=\"recommendations\">Recommendations</h2><p>To fix all these vulnerabilities, CERT-EU and Cisco highly recommend updating each release to the last version, when possible, or to upgrade the release. </p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/viewErp.x?alertId=ERP-74773\">https://tools.Cisco.com/security/center/viewErp.x?alertId=ERP-74773</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-snort-dos-RywH7ezM\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-snort-dos-RywH7ezM</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-tls-decrypt-dos-BMxYjm8M\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-tls-decrypt-dos-BMxYjm8M</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-dos-rUDseW3r\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-dos-rUDseW3r</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-fmc-dir-traversal-95UyW5tk\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-fmc-dir-traversal-95UyW5tk</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asaftd-dos-4ygzLKU9\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asaftd-dos-4ygzLKU9</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asafdt-webvpn-dos-KSqJAKPA\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asafdt-webvpn-dos-KSqJAKPA</a></p><p>[8] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-cmdinject-FmzsLN8\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-ftd-cmdinject-FmzsLN8</a></p><p>[9] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asa-ftd-dos-Unk689XY\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asa-ftd-dos-Unk689XY</a></p><p>[10] <a rel=\"noopener\" target=\"_blank\" href=\"https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asa-ftd-dos-JxYWMJyL\">https://tools.Cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-sa-asa-ftd-dos-JxYWMJyL</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}