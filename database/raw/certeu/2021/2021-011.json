{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-011.pdf"
  },
  "title": "UPDATE: Critical Vulnerabilities in VMware",
  "serial_number": "2021-011",
  "publish_date": "24-02-2021 08:46:00",
  "description": "On 24th of February 2021, VMware has released a security advisory to address multiple vulnerabilities including a critical (CVSS Score 9.8) remote code execution (RCE) vulnerability in the vCenter Server management platform. The vulnerabilities may allow attackers to potentially take control of affected systems. Updates are available to remediate these vulnerabilities in affected VMware products.<br>On the same day, PT Swarm published an article covering more technical details and the proof-of-concept (PoC) for the RCE vulnerability. The availability of the PoC indicates that wide spread exploitation of this vulnerability may start very soon. Immediate patching is strongly advised!",
  "url_title": "2021-011",
  "content_markdown": "---\ntitle: 'Critical Vulnerabilities inÂ VMware'\nversion: '1.1'\nnumber: '2021-011'\ndate: 'February 25, 2021'\n---\nHistory:\n\n- 24/02/2021 --- v1.0 -- Initial publication\n- 25/02/2021 --- v1.1 -- Updated with information on PoC available\n\n# Summary\n\nOn 24th of February 2021, VMware has released a security advisory [1] to address multiple vulnerabilities including a **critical (CVSS Score 9.8) remote code execution (RCE) vulnerability** in the vCenter Server management platform. The vulnerabilities may allow attackers to potentially take control of affected systems. Updates are available to remediate these vulnerabilities in affected VMware products.\n\nOn the same day, PT Swarm published an article covering more technical details and the proof-of-concept (PoC) for the RCE vulnerability [4]. The availability of the PoC indicates that wide spread exploitation of this vulnerability may start very soon. **Immediate patching is strongly advised!**\n\n# Technical Details\n\n**CVE-2021-21972 (CVSS Score: Base 9.8)**\n\nThis vulnerability, described as a _Remote code execution vulnerability in the vSphere Client_, was reported by Mikhail Klyuchnikov of Positive Technologies, and it can be exploited remotely by unauthenticated attackers in low complexity attacks that do not require user interaction.\n\nThe vSphere Client (HTML5) contains a remote code execution vulnerability in a vCenter Server plugin that allows a malicious actor with network access to port 443 to execute commands with unrestricted privileges on the underlying operating system that hosts vCenter Server. The impacted vCenter Server plugin for **vRealize Operations* (vROps) is present in all default installations, with vROPs not being required for the affected endpoint to be available.\n\nAs presented in the PoC by PT Swarm, in addition to getting access to the command line, an attacker can perform other malicious actions due to the lack of authentication in the vROps plugin.\n\n**CVE-2021-21974 (CVSS Score: Base 8.8)**\n\nCritical vulnerability, described as an _ESXi OpenSLP heap-overflow vulnerability_.\n\nOpenSLP as used in ESXi has a heap-overflow vulnerability that may enable attackers residing within the same network segment as ESXi and with access to port 427 to execute arbitrary code remotely on impacted devices. Per the Security Configuration Guides for VMware vSphere, VMware now recommends disabling the OpenSLP service in ESXi if it is not used [2].\n\n# Affected Products\n\nThese vulnerabilities affect several products as follows:\n\n**CVE-2021-21972**\n\n- vCenter Server 3.x and 4.x\n\n**CVE-2021-21974**\n\n- Cloud Foundation (ESXi) 3.x and 4.x\n\n# Recommendations\n\nVMware has released software updates that address CVE-2021-21972 and CVE-2021-21974. To remediate -- apply the patches listed in [1]. Workarounds for those who cannot immediately update have been listed also in [1].\n\nFor the CVE-2021-21974, VMware released also a guideline [3] that documents steps to consume ESXi hot patch asynchronously on top of latest VMware Cloud Foundation (VCF) supported ESXi build.\n\nDue to this security vulnerability's critical nature, and since a PoC has been already released, it is strongly recommended to **update the vulnerable products as soon as possible**!\n\n# References\n\n[1] <https://www.vmware.com/security/advisories/VMSA-2021-0002.html>\n\n[2] <https://blogs.vmware.com/vsphere/2021/02/evolving-the-vmware-vsphere-security-configuration-guides.html>\n\n[3] <https://kb.vmware.com/s/article/82705>\n\n[4] <https://swarm.ptsecurity.com/unauth-rce-vmware/>\n",
  "content_html": "<p>History:</p><ul><li>24/02/2021 --- v1.0 -- Initial publication</li><li>25/02/2021 --- v1.1 -- Updated with information on PoC available</li></ul><h2 id=\"summary\">Summary</h2><p>On 24th of February 2021, VMware has released a security advisory [1] to address multiple vulnerabilities including a <strong>critical (CVSS Score 9.8) remote code execution (RCE) vulnerability</strong> in the vCenter Server management platform. The vulnerabilities may allow attackers to potentially take control of affected systems. Updates are available to remediate these vulnerabilities in affected VMware products.</p><p>On the same day, PT Swarm published an article covering more technical details and the proof-of-concept (PoC) for the RCE vulnerability [4]. The availability of the PoC indicates that wide spread exploitation of this vulnerability may start very soon. <strong>Immediate patching is strongly advised!</strong></p><h2 id=\"technical-details\">Technical Details</h2><p><strong>CVE-2021-21972 (CVSS Score: Base 9.8)</strong></p><p>This vulnerability, described as a <em>Remote code execution vulnerability in the vSphere Client</em>, was reported by Mikhail Klyuchnikov of Positive Technologies, and it can be exploited remotely by unauthenticated attackers in low complexity attacks that do not require user interaction.</p><p>The vSphere Client (HTML5) contains a remote code execution vulnerability in a vCenter Server plugin that allows a malicious actor with network access to port 443 to execute commands with unrestricted privileges on the underlying operating system that hosts vCenter Server. The impacted vCenter Server plugin for <em>*vRealize Operations</em> (vROps) is present in all default installations, with vROPs not being required for the affected endpoint to be available.</p><p>As presented in the PoC by PT Swarm, in addition to getting access to the command line, an attacker can perform other malicious actions due to the lack of authentication in the vROps plugin.</p><p><strong>CVE-2021-21974 (CVSS Score: Base 8.8)</strong></p><p>Critical vulnerability, described as an <em>ESXi OpenSLP heap-overflow vulnerability</em>.</p><p>OpenSLP as used in ESXi has a heap-overflow vulnerability that may enable attackers residing within the same network segment as ESXi and with access to port 427 to execute arbitrary code remotely on impacted devices. Per the Security Configuration Guides for VMware vSphere, VMware now recommends disabling the OpenSLP service in ESXi if it is not used [2].</p><h2 id=\"affected-products\">Affected Products</h2><p>These vulnerabilities affect several products as follows:</p><p><strong>CVE-2021-21972</strong></p><ul><li>vCenter Server 3.x and 4.x</li></ul><p><strong>CVE-2021-21974</strong></p><ul><li>Cloud Foundation (ESXi) 3.x and 4.x</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>VMware has released software updates that address CVE-2021-21972 and CVE-2021-21974. To remediate -- apply the patches listed in [1]. Workarounds for those who cannot immediately update have been listed also in [1].</p><p>For the CVE-2021-21974, VMware released also a guideline [3] that documents steps to consume ESXi hot patch asynchronously on top of latest VMware Cloud Foundation (VCF) supported ESXi build.</p><p>Due to this security vulnerability's critical nature, and since a PoC has been already released, it is strongly recommended to <strong>update the vulnerable products as soon as possible</strong>!</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.vmware.com/security/advisories/VMSA-2021-0002.html\">https://www.vmware.com/security/advisories/VMSA-2021-0002.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://blogs.vmware.com/vsphere/2021/02/evolving-the-vmware-vsphere-security-configuration-guides.html\">https://blogs.vmware.com/vsphere/2021/02/evolving-the-vmware-vsphere-security-configuration-guides.html</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.vmware.com/s/article/82705\">https://kb.vmware.com/s/article/82705</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://swarm.ptsecurity.com/unauth-rce-vmware/\">https://swarm.ptsecurity.com/unauth-rce-vmware/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}