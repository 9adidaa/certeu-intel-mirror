{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-078.pdf"
  },
  "title": "Apache HTTP Server Critical Vulnerability",
  "serial_number": "2021-078",
  "publish_date": "23-12-2021 13:15:00",
  "description": "On Monday 20 December 2021, The Apache Software Foundation has released Apache HTTP Server 2.4.52. This version fixes two vulnerabilities:<br>- CVE-2021-44790: critical severity, CVSS base score of 9.8.<br>- CVE-2021-44224: high severity, CVSS base score of 8.2.<br>While the vulnerabilities affect optional modules, the risk is substantial if these modules are used in specific configurations, as the attack does not require authentication and could potentially lead to remote code execution. At the time of this writing, no publicly available exploits are known to exist and the vulnerabilities are not under active attack yet.",
  "url_title": "2021-078",
  "content_markdown": "---\ntitle: 'Apache HTTP Server CriticalÂ Vulnerability'\nversion: '1.0'\nnumber: '2021-078'\ndate: 'December 23, 2021'\n---\n\n_History:_\n\n* _23/12/2021 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn Monday 20 December 2021, The Apache Software Foundation has released Apache HTTP Server 2.4.52 [1]. This version fixes two vulnerabilities:\n\n- CVE-2021-44790: critical severity, CVSS base score of 9.8 [2].\n- CVE-2021-44224: high severity, CVSS base score of 8.2 [3].\n\nWhile the vulnerabilities affect optional modules, the risk is substantial if these modules are used in specific configurations, as the attack does not require authentication and could potentially lead to remote code execution [4]. At the time of this writing, no publicly available exploits are known to exist and the vulnerabilities are not under active attack yet.\n\n# Technical Details\n\n## CVE-2021-44790 (Critical - CVSS base score = 9.8) [2]\n\nA carefully crafted request body can cause a buffer overflow in the `mod_lua` multipart parser (`r:parsebody()` called from Lua scripts). The Apache httpd team is not aware of an exploit for the vulnerability though it might be possible to craft one [2].\n\n## CVE-2021-44224 (High - CVSS base score = 8.2) [3]\n\nA crafted URI sent to the HTTP Server, when configured as a forward proxy (`ProxyRequests on`), can cause a crash (`NULL` pointer dereference) or, for configurations mixing forward and reverse proxy declarations, can allow for requests to be directed to a declared Unix Domain Socket endpoint (Server Side Request Forgery).\n\n# Affected Products\n\n- CVE-2021-44790 affects Apache HTTP Server 2.4.51 and earlier.\n- CVE-2021-44224 affects Apache HTTP Server 2.4.7 up to 2.4.51 (included).\n\n# Recommendations\n\nCERT-EU strongly recommends updating Apache HTTP Server installations to version 2.4.52 or later.\n\n\n# References\n\n[1] <https://httpd.apache.org/security/vulnerabilities_24.html>\n\n[2] <https://nvd.nist.gov/vuln/detail/CVE-2021-44790>\n\n[3] <https://nvd.nist.gov/vuln/detail/CVE-2021-44224>\n\n[4] <https://threatpost.com/apache-httpd-server-bugs-rce-dos/177234/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>23/12/2021 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On Monday 20 December 2021, The Apache Software Foundation has released Apache HTTP Server 2.4.52 [1]. This version fixes two vulnerabilities:</p><ul><li>CVE-2021-44790: critical severity, CVSS base score of 9.8 [2].</li><li>CVE-2021-44224: high severity, CVSS base score of 8.2 [3].</li></ul><p>While the vulnerabilities affect optional modules, the risk is substantial if these modules are used in specific configurations, as the attack does not require authentication and could potentially lead to remote code execution [4]. At the time of this writing, no publicly available exploits are known to exist and the vulnerabilities are not under active attack yet.</p><h2 id=\"technical-details\">Technical Details</h2><h3 id=\"cve-2021-44790-critical-cvss-base-score-98-2\">CVE-2021-44790 (Critical - CVSS base score = 9.8) [2]</h3><p>A carefully crafted request body can cause a buffer overflow in the <code>mod_lua</code> multipart parser (<code>r:parsebody()</code> called from Lua scripts). The Apache httpd team is not aware of an exploit for the vulnerability though it might be possible to craft one [2].</p><h3 id=\"cve-2021-44224-high-cvss-base-score-82-3\">CVE-2021-44224 (High - CVSS base score = 8.2) [3]</h3><p>A crafted URI sent to the HTTP Server, when configured as a forward proxy (<code>ProxyRequests on</code>), can cause a crash (<code>NULL</code> pointer dereference) or, for configurations mixing forward and reverse proxy declarations, can allow for requests to be directed to a declared Unix Domain Socket endpoint (Server Side Request Forgery).</p><h2 id=\"affected-products\">Affected Products</h2><ul><li>CVE-2021-44790 affects Apache HTTP Server 2.4.51 and earlier.</li><li>CVE-2021-44224 affects Apache HTTP Server 2.4.7 up to 2.4.51 (included).</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU strongly recommends updating Apache HTTP Server installations to version 2.4.52 or later.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://httpd.apache.org/security/vulnerabilities_24.html\">https://httpd.apache.org/security/vulnerabilities_24.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44790\">https://nvd.nist.gov/vuln/detail/CVE-2021-44790</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44224\">https://nvd.nist.gov/vuln/detail/CVE-2021-44224</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://threatpost.com/apache-httpd-server-bugs-rce-dos/177234/\">https://threatpost.com/apache-httpd-server-bugs-rce-dos/177234/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}