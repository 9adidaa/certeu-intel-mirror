{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-047.pdf"
  },
  "title": "UPDATE: RCE Vulnerability in Microsoft MSHTML",
  "serial_number": "2021-047",
  "publish_date": "08-09-2021 07:49:00",
  "description": "On 7th of September 2021, Microsoft released information about a vulnerability (CVE-2021-40444) in MSHTML that affects Microsoft Windows that could be exploited by sending specially-crafted Microsoft Office documents to potential victims. The severity of this vulnerability is high, with CVSSv3 Score 8.8.<br>However, the attack is prevented by Protected View mode or Application Guard for Office 365, if Microsoft Office runs with the default configuration. The attacker would then have to mislead the user to open the malicious document and enable the active content.<br>Microsoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents.<br>On the 14th of September, Microsoft has released security updates to address this vulnerability.",
  "url_title": "2021-047",
  "content_markdown": "---\ntitle: 'RCE Vulnerability in Microsoft MSHTML'\nversion: '1.1'\nnumber: '2021-047'\ndate: 'September 17, 2021'\n---\n\n_History:_\n\n* _08/09/2021 --- v1.0 -- Initial publication_\n* _17/09/2021 --- v1.1 -- Update with information about a new patch_\n\n# Summary\n\nOn 7th of September 2021, Microsoft released information about a vulnerability (CVE-2021-40444) in MSHTML that affects Microsoft Windows that could be exploited by sending specially-crafted Microsoft Office documents to potential victims [1]. The severity of this vulnerability is **high**, with CVSSv3 Score 8.8.\n\nHowever, the attack is prevented by Protected View mode or Application Guard for Office 365, if Microsoft Office runs with the default configuration. The attacker would then have to mislead the user to open the malicious document and enable the active content.\n\nMicrosoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents.\n\nOn the 14th of September, Microsoft has released security updates to address this vulnerability [1].\n\n# Technical Details\n\nAn attacker could craft a malicious ActiveX control to be used by a Microsoft Office document that hosts the browser rendering engine. Once opened, the document will load the Internet Explorer engine to render a remote web page from the threat actor. Malware is then downloaded by using a specific ActiveX control in the web page. Executing the threat is done using a trick called _Cpl File Execution_ referenced in Microsoft's advisory [2].\n\n# Products Affected\n\nWindows 7, 8.1 and 10 (including versions 2004), Windows Server 2008, 2016, 2019, 2022 and  Windows Server Core versions. For more specific type and version please check [1].\n\n# Recommendations\n\nCERT-EU recommends to apply the patches released on September 2021 Patch Tuesday as soon as possible.\n\nAdditionally, systems with active Microsoft’s Defender Antivirus and Defender for Endpoint (build 1.349.22.0 and above) benefit from protection against attempts to exploit CVE-2021-40444. Moreover, by default, Microsoft Office opens documents from the internet in Protected View or Application Guard for Office both of which prevent the current attack.\n\n## Workarounds and Mitigations\n\nDisabling the installation of all ActiveX controls in Internet Explorer mitigates this attack. This can be accomplished for all sites by updating the registry. Previously-installed ActiveX controls will continue to run, but do not expose this vulnerability.\n\nPlease follow the instructions from the advisory to disable ActiveX controls [1]. This sets the `URLACTION_DOWNLOAD_SIGNED_ACTIVEX (0x1001)` and `URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX (0x1004)` to `DISABLED (3)` for all internet zones for 64-bit and 32-bit processes. New ActiveX controls will not be installed. Previously-installed ActiveX controls will continue to run.\n\n# References\n\n[1] <https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444>\n\n[2] <https://www.bleepingcomputer.com/news/security/microsoft-shares-temp-fix-for-ongoing-office-365-zero-day-attacks/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>08/09/2021 --- v1.0 -- Initial publication</em></li><li><em>17/09/2021 --- v1.1 -- Update with information about a new patch</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 7th of September 2021, Microsoft released information about a vulnerability (CVE-2021-40444) in MSHTML that affects Microsoft Windows that could be exploited by sending specially-crafted Microsoft Office documents to potential victims [1]. The severity of this vulnerability is <strong>high</strong>, with CVSSv3 Score 8.8.</p><p>However, the attack is prevented by Protected View mode or Application Guard for Office 365, if Microsoft Office runs with the default configuration. The attacker would then have to mislead the user to open the malicious document and enable the active content.</p><p>Microsoft is aware of targeted attacks that attempt to exploit this vulnerability by using specially-crafted Microsoft Office documents.</p><p>On the 14th of September, Microsoft has released security updates to address this vulnerability [1].</p><h2 id=\"technical-details\">Technical Details</h2><p>An attacker could craft a malicious ActiveX control to be used by a Microsoft Office document that hosts the browser rendering engine. Once opened, the document will load the Internet Explorer engine to render a remote web page from the threat actor. Malware is then downloaded by using a specific ActiveX control in the web page. Executing the threat is done using a trick called <em>Cpl File Execution</em> referenced in Microsoft's advisory [2].</p><h2 id=\"products-affected\">Products Affected</h2><p>Windows 7, 8.1 and 10 (including versions 2004), Windows Server 2008, 2016, 2019, 2022 and Windows Server Core versions. For more specific type and version please check [1].</p><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends to apply the patches released on September 2021 Patch Tuesday as soon as possible.</p><p>Additionally, systems with active Microsoft’s Defender Antivirus and Defender for Endpoint (build 1.349.22.0 and above) benefit from protection against attempts to exploit CVE-2021-40444. Moreover, by default, Microsoft Office opens documents from the internet in Protected View or Application Guard for Office both of which prevent the current attack.</p><h3 id=\"workarounds-and-mitigations\">Workarounds and Mitigations</h3><p>Disabling the installation of all ActiveX controls in Internet Explorer mitigates this attack. This can be accomplished for all sites by updating the registry. Previously-installed ActiveX controls will continue to run, but do not expose this vulnerability.</p><p>Please follow the instructions from the advisory to disable ActiveX controls [1]. This sets the <code>URLACTION_DOWNLOAD_SIGNED_ACTIVEX (0x1001)</code> and <code>URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX (0x1004)</code> to <code>DISABLED (3)</code> for all internet zones for 64-bit and 32-bit processes. New ActiveX controls will not be installed. Previously-installed ActiveX controls will continue to run.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444\">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/microsoft-shares-temp-fix-for-ongoing-office-365-zero-day-attacks/\">https://www.bleepingcomputer.com/news/security/microsoft-shares-temp-fix-for-ongoing-office-365-zero-day-attacks/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  }
}