{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-067.pdf"
  },
  "title": "Critical WhatsApp Vulnerabilities",
  "serial_number": "2022-067",
  "publish_date": "30-09-2022 12:12:00",
  "description": "WhatsApp has patched two remote code execution vulnerabilities in its September update. These could have allowed an attacker to remotely access a device and execute commands. The vulnerabilities were discovered by WhatsApp internal security team and there are no indications that these have already been exploited.",
  "url_title": "2022-067",
  "content_markdown": "---\ntitle: 'Critical WhatsApp Vulnerabilities'\nversion: '1.0'\nnumber: '2022-067'\noriginal_date: 'September 28, 2022'\ndate: 'September 30, 2022'\n---\n\n_History:_\n\n* _30/09/2022 --- v1.0 -- Initial publication_\n  \n# Summary\n\nWhatsApp has patched two remote code execution vulnerabilities in its September update [1]. These could have allowed an attacker to remotely access a device and execute commands. The vulnerabilities were discovered by WhatsApp internal security team and there are no indications that these have already been exploited.\n\n# Technical Details\n\nWhatsApp did not share more specifics on the vulnerabilities, but cybersecurity firm **Malwarebytes** said that they reside in two components called _Video Call Handler_ and _Video File Handler_, which could permit an attacker to seize control of the app [3]:\n\n- `CVE-2022-36934` - (CVSS score: 9.8) - _An integer overflow in WhatsApp could result in remote code execution (RCE) in an established video call_\n\nAn integer overflow occurs when an integer value gets assigned a value that is too large to store in the reserved representation that can be represented with a given number of digits. By writing a larger value into the memory, an attacker could overwrite other parts of the system's memory and abuse that ability to remotely execute code.\n\nThis RCE bug affects a piece of code in the WhatsApp component Video Call Handler, which allows an attacker to manipulate the bug to trigger a heap-based buffer overflow and take complete control of WhatsApp Messenger. In software exploit code, two common areas that are targeted for overflows are the stack and the heap.\n\nThe heap is an area of memory made available use by the program. The program can request blocks of memory for its use within the heap. In order to allocate a block of some size, the program makes an explicit request by calling the heap allocation operation [2]. \n\n\n- `CVE-2022-27492` - (CVSS score: 7.8) - _An integer underflow in WhatsApp could have caused remote code execution when receiving a crafted video file_\n\nInteger underflow errors are usually errors that occur when a number that should always be positive gets assigned a negative value. A perfect example of an integer underflow error is when array index errors are used with a negative value. This type of weakness will lead to undefined behavior and often crashes. In the case of overflows involving loop index variables, the likelihood of infinite loops is also high.\n\nThis RCE bug affects an unspecified code block of the component Video File Handler. The manipulation with an unknown input leads to a memory corruption vulnerability. To exploit this vulnerability, attackers would have to drop a crafted video file on the user’s WhatsApp messenger and convince the user to play it [2].\n\n# Affected Products\n\nThese versions are affected by at least one of the reported vulnerabilities.\n\n* WhatsApp for Android prior to v2.22.16.12\n* WhatsApp Business for Android prior to v2.22.16.12\n* WhatsApp for iOS prior to v2.22.16.12\n* WhatsApp Business for iOS prior to v2.22.16.12\n* WhatsApp for Android prior to v2.22.16.2 and WhatsApp for iOS v2.22.15.9 are affected by both.\n\n# Recommendations\n\nWhatsApp has released security updates to address the reported vulnerabilities. CERT-EU recommends applying the patches as soon as possible.\n\n# References\n\n[1] <https://www.whatsapp.com/security/advisories/2022/?lang=en>\n\n[2] <https://www.malwarebytes.com/blog/news/2022/09/critical-whatsapp-vulnerabilities-patched-check-youve-updated>\n\n[3] <https://thehackernews.com/2022/09/critical-whatsapp-bugs-could-have-let.html>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>30/09/2022 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>WhatsApp has patched two remote code execution vulnerabilities in its September update [1]. These could have allowed an attacker to remotely access a device and execute commands. The vulnerabilities were discovered by WhatsApp internal security team and there are no indications that these have already been exploited.</p><h2 id=\"technical-details\">Technical Details</h2><p>WhatsApp did not share more specifics on the vulnerabilities, but cybersecurity firm <strong>Malwarebytes</strong> said that they reside in two components called <em>Video Call Handler</em> and <em>Video File Handler</em>, which could permit an attacker to seize control of the app [3]:</p><ul><li><code>CVE-2022-36934</code> - (CVSS score: 9.8) - <em>An integer overflow in WhatsApp could result in remote code execution (RCE) in an established video call</em></li></ul><p>An integer overflow occurs when an integer value gets assigned a value that is too large to store in the reserved representation that can be represented with a given number of digits. By writing a larger value into the memory, an attacker could overwrite other parts of the system's memory and abuse that ability to remotely execute code.</p><p>This RCE bug affects a piece of code in the WhatsApp component Video Call Handler, which allows an attacker to manipulate the bug to trigger a heap-based buffer overflow and take complete control of WhatsApp Messenger. In software exploit code, two common areas that are targeted for overflows are the stack and the heap.</p><p>The heap is an area of memory made available use by the program. The program can request blocks of memory for its use within the heap. In order to allocate a block of some size, the program makes an explicit request by calling the heap allocation operation [2]. </p><ul><li><code>CVE-2022-27492</code> - (CVSS score: 7.8) - <em>An integer underflow in WhatsApp could have caused remote code execution when receiving a crafted video file</em></li></ul><p>Integer underflow errors are usually errors that occur when a number that should always be positive gets assigned a negative value. A perfect example of an integer underflow error is when array index errors are used with a negative value. This type of weakness will lead to undefined behavior and often crashes. In the case of overflows involving loop index variables, the likelihood of infinite loops is also high.</p><p>This RCE bug affects an unspecified code block of the component Video File Handler. The manipulation with an unknown input leads to a memory corruption vulnerability. To exploit this vulnerability, attackers would have to drop a crafted video file on the user’s WhatsApp messenger and convince the user to play it [2].</p><h2 id=\"affected-products\">Affected Products</h2><p>These versions are affected by at least one of the reported vulnerabilities.</p><ul><li>WhatsApp for Android prior to v2.22.16.12</li><li>WhatsApp Business for Android prior to v2.22.16.12</li><li>WhatsApp for iOS prior to v2.22.16.12</li><li>WhatsApp Business for iOS prior to v2.22.16.12</li><li>WhatsApp for Android prior to v2.22.16.2 and WhatsApp for iOS v2.22.15.9 are affected by both.</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>WhatsApp has released security updates to address the reported vulnerabilities. CERT-EU recommends applying the patches as soon as possible.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.whatsapp.com/security/advisories/2022/?lang=en\">https://www.whatsapp.com/security/advisories/2022/?lang=en</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.malwarebytes.com/blog/news/2022/09/critical-whatsapp-vulnerabilities-patched-check-youve-updated\">https://www.malwarebytes.com/blog/news/2022/09/critical-whatsapp-vulnerabilities-patched-check-youve-updated</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://thehackernews.com/2022/09/critical-whatsapp-bugs-could-have-let.html\">https://thehackernews.com/2022/09/critical-whatsapp-bugs-could-have-let.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2022-27492",
    "CVE-2022-36934"
  ]
}