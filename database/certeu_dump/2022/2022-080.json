{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-080.pdf"
  },
  "title": "Remote Code Execution Vulnerabilities in F5 Products",
  "serial_number": "2022-080",
  "publish_date": "18-11-2022 10:30:00",
  "description": "On November 16, 2022, F5 released an advisory on F5 Big-IP and Big-IQ concerning two CVE with high severity. The first one, \"CVE-2022-41622\", is a cross-site request forgery (CSRF), for which the exploitation can allow an unauthenticated attacker to perform critical actions on the system, even if the management interface is not exposed on the Internet. The second vulnerability, \"CVE-2022-41800\", can allow an attacker with administrative privileges to execute arbitrary commands on the device.",
  "url_title": "2022-080",
  "content_markdown": "---\ntitle: 'Remote Code Execution Vulnerabilities in F5 Products'\nversion: '1.0'\nnumber: '2022-080'\noriginal_date: 'November 16, 2022'\ndate: 'November 18, 2022'\n---\n\n_History:_\n\n* _18/11/2022 --- v1.0 -- Initial publication_\n  \n# Summary\n\nOn November 16, 2022, F5 released an advisory on F5 Big-IP and Big-IQ concerning two CVE with high severity [1]. The first one, `CVE-2022-41622`, is a cross-site request forgery (CSRF), for which the exploitation can allow an unauthenticated attacker to perform critical actions on the system, even if the management interface is not exposed on the Internet. The second vulnerability, `CVE-2022-41800`, can allow an attacker with administrative privileges to execute arbitrary commands on the device.  \n\n\n# Technical Details\n\n`CVE-2022-41622` is a CSRF that requires a user with administrative rights to visit an attacker-controlled site exploiting the CSRF, while being authenticated on the F5 administrative interface. The vulnerability resides in the `/iControl/iControlPortal.cgi` SOAP endpoint which does not have proper CSRF and SOAP protections. This endpoint `iControlPortal.cgi` is a CGI script executed as root on the device and may thus lead to arbitrary execution on the system with high privileges despite the presence of SELinux [2].  \n\n`CVE-2022-41800` concerns an endpoint only accessible to administrative users, allowing to create RPM specification files then consumed by another administrator endpoint. These endpoints are vulnerable to injection, resulting in an attacker being able to add executable shell commands in the RPM spec file. These commands would then be executed when the resulting RPM file is created. A user with administrative rights might thus execute arbitrary commands on the device.   \n\n# Affected Products\n\nThe following products are affected [1]. \n\n- Big-IP (all modules): \n    - 17.0.0 \n    - 16.1.0 - 16.1.3\n    - 15.1.0 - 15.1.8\n    - 14.1.0 - 14.1.5 \n    - 13.1.0 - 13.1.5\n- Big-IP SPK : All \n- BIG-IQ Centralized Management: \n    - 8.0.0 - 8.2.0\n    - 7.1.0\n\n\n# Recommendations\n\nCERT-EU recommends following the F5 advice [3]:  \n\n>_F5 has fixed this issue in an engineering hotfix that is available for supported versions of the BIG-IP system. Customers affected by this issue can request a hotfix for the latest supported versions of BIG-IP from F5 Support. To resolve this vulnerability, after installing the hotfix to one of the BIG-IP releases listed in the previous table, you must also disable Basic Authentication for iControl SOAP._\n\n# References\n\n[1] <https://support.f5.com/csp/article/K97843387>\n\n[2] <https://attackerkb.com/topics/i21EbdNxks/cve-2022-41622/rapid7-analysis>\n\n[3] <https://support.f5.com/csp/article/K94221585>\n\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>18/11/2022 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On November 16, 2022, F5 released an advisory on F5 Big-IP and Big-IQ concerning two CVE with high severity [1]. The first one, <code>CVE-2022-41622</code>, is a cross-site request forgery (CSRF), for which the exploitation can allow an unauthenticated attacker to perform critical actions on the system, even if the management interface is not exposed on the Internet. The second vulnerability, <code>CVE-2022-41800</code>, can allow an attacker with administrative privileges to execute arbitrary commands on the device. </p><h2 id=\"technical-details\">Technical Details</h2><p><code>CVE-2022-41622</code> is a CSRF that requires a user with administrative rights to visit an attacker-controlled site exploiting the CSRF, while being authenticated on the F5 administrative interface. The vulnerability resides in the <code>/iControl/iControlPortal.cgi</code> SOAP endpoint which does not have proper CSRF and SOAP protections. This endpoint <code>iControlPortal.cgi</code> is a CGI script executed as root on the device and may thus lead to arbitrary execution on the system with high privileges despite the presence of SELinux [2]. </p><p><code>CVE-2022-41800</code> concerns an endpoint only accessible to administrative users, allowing to create RPM specification files then consumed by another administrator endpoint. These endpoints are vulnerable to injection, resulting in an attacker being able to add executable shell commands in the RPM spec file. These commands would then be executed when the resulting RPM file is created. A user with administrative rights might thus execute arbitrary commands on the device. </p><h2 id=\"affected-products\">Affected Products</h2><p>The following products are affected [1]. </p><ul><li>Big-IP (all modules): <ul><li>17.0.0 </li><li>16.1.0 - 16.1.3</li><li>15.1.0 - 15.1.8</li><li>14.1.0 - 14.1.5 </li><li>13.1.0 - 13.1.5</li></ul></li><li>Big-IP SPK : All </li><li>BIG-IQ Centralized Management: <ul><li>8.0.0 - 8.2.0</li><li>7.1.0</li></ul></li></ul><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends following the F5 advice [3]: </p><blockquote><p><em>F5 has fixed this issue in an engineering hotfix that is available for supported versions of the BIG-IP system. Customers affected by this issue can request a hotfix for the latest supported versions of BIG-IP from F5 Support. To resolve this vulnerability, after installing the hotfix to one of the BIG-IP releases listed in the previous table, you must also disable Basic Authentication for iControl SOAP.</em></p></blockquote><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.f5.com/csp/article/K97843387\">https://support.f5.com/csp/article/K97843387</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://attackerkb.com/topics/i21EbdNxks/cve-2022-41622/rapid7-analysis\">https://attackerkb.com/topics/i21EbdNxks/cve-2022-41622/rapid7-analysis</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.f5.com/csp/article/K94221585\">https://support.f5.com/csp/article/K94221585</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2022-41622",
    "CVE-2022-41800"
  ]
}