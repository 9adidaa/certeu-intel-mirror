{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2022-073.pdf"
  },
  "title": "UPDATE: OpenSSL Critical Vulnerability",
  "serial_number": "2022-073",
  "publish_date": "01-11-2022 20:55:00",
  "description": "On November 1, 2022, the OpenSSL project team has released a new version of the openssl library version 3. The version 3.0.7 fixes two HIGH vulnerabilities, CVE-2022-3602 and CVE-2022-3786, that could lead to Denial of Service conditions, or Remote Code Execution in some cases. It is recommended upgrading openssl to the last versions. Proof of concepts are now available.",
  "url_title": "2022-073",
  "content_markdown": "---\ntitle: 'OpenSSL High Vulnerabilities'\nversion: '1.1'\nnumber: '2022-073'\noriginal_date: 'October 25, 2022'\ndate: 'November 1, 2022'\n---\n\n_History:_\n\n* _27/10/2022 --- v1.0 -- Initial publication_\n* _01/11/2022 --- v1.1 -- Add technical information_\n  \n# Summary\n\nOn November 1, 2022, the OpenSSL project team has released a new version of the `openssl` library version 3. The version 3.0.7 fixes two HIGH vulnerabilities, `CVE-2022-3602` and `CVE-2022-3786`, that could lead to Denial of Service conditions, or Remote Code Execution in some cases [1]. It is recommended upgrading `openssl` to the last versions. \n\n**Proof of concepts are now available.** [4]\n\n# Technical Details\n\nOriginally, the OpenSSL team announced one CRITICAL vulnerability, **CVE-2022-3602**. However, during the week of prenotification, testing and feedback from various organisations showed that the ability to cause remote code execution is really low. Thus, the team decided to downgrade the severity of this CVE to HIGH instead [2].\n\nThe second vulnerability, **CVE-2022-3786** was not rated as CRITICAL from the outset, because only the length and not the content of the overwrite is attacker controlled. Exposure to remote code execution is not expected on any platforms [2].\n\nA buffer overrun can be triggered in X.509 certificate verification, specifically in name constraint checking. This occurs after certificate chain signature verification and requires either a CA to have signed the malicious certificate or for the application to continue certificate verification despite failure to construct a path to a trusted issuer.\n\nIn a TLS client, this can be triggered by connecting to a malicious server.  In a TLS server, this can be triggered if the server requests client authentication and a malicious client connects.\n\nThe vulnerability **CVE-2022-3786** could be exploited by crafting a malicious email address to overflow an arbitrary number of bytes containing the `.` character (decimal 46) on the stack.  This buffer overflow could result in a crash (causing a denial of service).\n\nThe vulnerability **CVE-2022-3602** could by exploited by crafting a malicious email address to overflow four attacker-controlled bytes on the stack. This buffer overflow could result in a crash (causing a denial of service) or potentially remote code execution depending on stack layout for any given platform/compiler.\n\n# Affected Products\n\n* OpenSSL version 3 before 3.0.7.\n\n**The vulnerability does not affect OpenSSL versions before 3.0.** [2]\n\n# Recommendations\n\nCERT-EU recommends upgrading the `openssl` (version 3.x) library to the last version (3.0.7). \n\nAs the OpenSSL library is widely used by many third-party applications, many vendors will release updates for their products to fix these vulnerabilities. CERT-EU recommends applying the forthcoming fixes. NCSC-NL, and other partners, are maintaining a non-exhaustive list of products that might be affected, or not, by these vulnerabilities [3]. \n\n# References\n\n[1] <https://www.openssl.org/news/cl30.txt>\n\n[2] <https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/>\n\n[3] <https://github.com/NCSC-NL/OpenSSL-2022/tree/main/software>\n\n[4] <https://github.com/DataDog/security-labs-pocs/tree/main/proof-of-concept-exploits/openssl-punycode-vulnerability>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>27/10/2022 --- v1.0 -- Initial publication</em></li><li><em>01/11/2022 --- v1.1 -- Add technical information</em></li></ul><h2 id=\"summary\">Summary</h2><p>On November 1, 2022, the OpenSSL project team has released a new version of the <code>openssl</code> library version 3. The version 3.0.7 fixes two HIGH vulnerabilities, <code>CVE-2022-3602</code> and <code>CVE-2022-3786</code>, that could lead to Denial of Service conditions, or Remote Code Execution in some cases [1]. It is recommended upgrading <code>openssl</code> to the last versions. </p><p><strong>Proof of concepts are now available.</strong> [4]</p><h2 id=\"technical-details\">Technical Details</h2><p>Originally, the OpenSSL team announced one CRITICAL vulnerability, <strong>CVE-2022-3602</strong>. However, during the week of prenotification, testing and feedback from various organisations showed that the ability to cause remote code execution is really low. Thus, the team decided to downgrade the severity of this CVE to HIGH instead [2].</p><p>The second vulnerability, <strong>CVE-2022-3786</strong> was not rated as CRITICAL from the outset, because only the length and not the content of the overwrite is attacker controlled. Exposure to remote code execution is not expected on any platforms [2].</p><p>A buffer overrun can be triggered in X.509 certificate verification, specifically in name constraint checking. This occurs after certificate chain signature verification and requires either a CA to have signed the malicious certificate or for the application to continue certificate verification despite failure to construct a path to a trusted issuer.</p><p>In a TLS client, this can be triggered by connecting to a malicious server. In a TLS server, this can be triggered if the server requests client authentication and a malicious client connects.</p><p>The vulnerability <strong>CVE-2022-3786</strong> could be exploited by crafting a malicious email address to overflow an arbitrary number of bytes containing the <code>.</code> character (decimal 46) on the stack. This buffer overflow could result in a crash (causing a denial of service).</p><p>The vulnerability <strong>CVE-2022-3602</strong> could by exploited by crafting a malicious email address to overflow four attacker-controlled bytes on the stack. This buffer overflow could result in a crash (causing a denial of service) or potentially remote code execution depending on stack layout for any given platform/compiler.</p><h2 id=\"affected-products\">Affected Products</h2><ul><li>OpenSSL version 3 before 3.0.7.</li></ul><p><strong>The vulnerability does not affect OpenSSL versions before 3.0.</strong> [2]</p><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends upgrading the <code>openssl</code> (version 3.x) library to the last version (3.0.7). </p><p>As the OpenSSL library is widely used by many third-party applications, many vendors will release updates for their products to fix these vulnerabilities. CERT-EU recommends applying the forthcoming fixes. NCSC-NL, and other partners, are maintaining a non-exhaustive list of products that might be affected, or not, by these vulnerabilities [3]. </p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.openssl.org/news/cl30.txt\">https://www.openssl.org/news/cl30.txt</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/\">https://www.openssl.org/blog/blog/2022/11/01/email-address-overflows/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/NCSC-NL/OpenSSL-2022/tree/main/software\">https://github.com/NCSC-NL/OpenSSL-2022/tree/main/software</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/DataDog/security-labs-pocs/tree/main/proof-of-concept-exploits/openssl-punycode-vulnerability\">https://github.com/DataDog/security-labs-pocs/tree/main/proof-of-concept-exploits/openssl-punycode-vulnerability</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2022-3602",
    "CVE-2022-3786"
  ]
}