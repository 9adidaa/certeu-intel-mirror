{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-008.pdf"
  },
  "title": "Critical Vulnerabilities in SolarWinds Orion Platform",
  "serial_number": "2021-008",
  "publish_date": "04-02-2021 08:26:00",
  "description": "Three critical vulnerabilities have been found in SolarWinds Orion platform. Two of them could be exploitable by a local attacker and a third one, the most severe of all, allows a remote, unprivileged actor to take control of the platform. These vulnerabilities are separate and not directly related to the earlier reported Sunburst attack.",
  "url_title": "2021-008",
  "content_markdown": "---\ntitle: 'Critical Vulnerabilities in SolarWinds Orion Platform'\nversion: '1.0'\nnumber: '2021-008'\ndate: 'February 4, 2021'\n---\n\n# Summary\n\nThree critical vulnerabilities have been found in **SolarWinds Orion** platform. Two of them could be exploitable by a local attacker and a third one, the most severe of all, allows a remote, unprivileged actor to take control of the platform [1, 2]. These vulnerabilities are separate and not directly related to the earlier reported Sunburst attack.\n\n# Technical Details\n\nThe vulnerabilities were assigned **CVE-2021-25274** [3], **CVE-2021-25275** [4], and **CVE-2021-25276** [5].\n\n## **CVE-2021-25274**\n\nAnalysing a demo copy of the **SolarWinds Orion** software, the researcher from Trustwave [2] noticed that it uses the Microsoft Message Queue (MSMQ). He noticed that the **SolarWinds Orion Collector** service relies heavily on MSMQ, with a large list of private queues available, all of them unauthenticated. This means that unauthenticated users can send messages to the queues over TCP port 1801. Due to an insecure deserialisation, an unprivileged user can execute arbitrary code remotely.\n\n**SolarWinds** addressed this issue by adding a digital signature validation step when new messages arrive. Without a valid signature, messages are no longer processed. MSMQ, though, remains unauthenticated and can receive messages from anyone.\n\n## **CVE-2021-25275**\n\nThe second vulnerability discovered was that the credentials for the **Orion** backend database were insufficiently protected and local users had unrestricted access to them. The researcher found the sensitive data in the `SOLARWINDS_ORION` configuration file that could be read by locally authenticated users. With only one line of code, the researcher decrypted the credentials.\n\nAfter authenticating to the Microsoft SQL Server with the recovered credentials, a threat actor would have complete control over the **SolarWinds Orion** database and could steal information or add admin-level users.\n\n## **CVE-2021-25276**\n\nThe third vulnerability is in the **SolarWinds Serv-U FTP Server**. The researcher discovered that the accounts are stored in separate files on the disk and that an authenticated user has access to them. The FTP server runs with LocalSystem permissions, so by creating an admin account, an attacker could set the home directory to the root of the system drive and thus open the door to read or replace any file there.\n\n# Affected Products\n\n* SolarWinds Orion Platform\n\n# Recommendations\n\n**SolarWinds** released patches that address the vulnerabilities described in this advisory.\n\nCERT-EU recommends installing **Orion Platform 2020.2.4** [6] and applying **Hotfix 1 for ServU-FTP 15.2.2** [7].\n\n# References\n\n[1] <https://www.bleepingcomputer.com/news/security/solarwinds-patches-critical-vulnerabilities-in-the-orion-platform/>\n\n[2] <https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/full-system-control-with-new-solarwinds-orion-based-and-serv-u-ftp-vulnerabilities/>\n\n[3] <https://nvd.nist.gov/vuln/detail/CVE-2021-25274>\n\n[4] <https://nvd.nist.gov/vuln/detail/CVE-2021-25275>\n\n[5] <https://nvd.nist.gov/vuln/detail/CVE-2021-25276>\n\n[6] <https://documentation.solarwinds.com/en/Success_Center/orionplatform/content/release_notes/orion_platform_2020-2-4_release_notes.htm>\n\n[7] <https://downloads.solarwinds.com/solarwinds/Release/HotFix/Serv-U-15.2.2-Hotfix-1.zip>\n",
  "content_html": "<h2 id=\"summary\">Summary</h2><p>Three critical vulnerabilities have been found in <strong>SolarWinds Orion</strong> platform. Two of them could be exploitable by a local attacker and a third one, the most severe of all, allows a remote, unprivileged actor to take control of the platform [1, 2]. These vulnerabilities are separate and not directly related to the earlier reported Sunburst attack.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerabilities were assigned <strong>CVE-2021-25274</strong> [3], <strong>CVE-2021-25275</strong> [4], and <strong>CVE-2021-25276</strong> [5].</p><h3 id=\"cve-2021-25274\"><strong>CVE-2021-25274</strong></h3><p>Analysing a demo copy of the <strong>SolarWinds Orion</strong> software, the researcher from Trustwave [2] noticed that it uses the Microsoft Message Queue (MSMQ). He noticed that the <strong>SolarWinds Orion Collector</strong> service relies heavily on MSMQ, with a large list of private queues available, all of them unauthenticated. This means that unauthenticated users can send messages to the queues over TCP port 1801. Due to an insecure deserialisation, an unprivileged user can execute arbitrary code remotely.</p><p><strong>SolarWinds</strong> addressed this issue by adding a digital signature validation step when new messages arrive. Without a valid signature, messages are no longer processed. MSMQ, though, remains unauthenticated and can receive messages from anyone.</p><h3 id=\"cve-2021-25275\"><strong>CVE-2021-25275</strong></h3><p>The second vulnerability discovered was that the credentials for the <strong>Orion</strong> backend database were insufficiently protected and local users had unrestricted access to them. The researcher found the sensitive data in the <code>SOLARWINDS_ORION</code> configuration file that could be read by locally authenticated users. With only one line of code, the researcher decrypted the credentials.</p><p>After authenticating to the Microsoft SQL Server with the recovered credentials, a threat actor would have complete control over the <strong>SolarWinds Orion</strong> database and could steal information or add admin-level users.</p><h3 id=\"cve-2021-25276\"><strong>CVE-2021-25276</strong></h3><p>The third vulnerability is in the <strong>SolarWinds Serv-U FTP Server</strong>. The researcher discovered that the accounts are stored in separate files on the disk and that an authenticated user has access to them. The FTP server runs with LocalSystem permissions, so by creating an admin account, an attacker could set the home directory to the root of the system drive and thus open the door to read or replace any file there.</p><h2 id=\"affected-products\">Affected Products</h2><ul><li>SolarWinds Orion Platform</li></ul><h2 id=\"recommendations\">Recommendations</h2><p><strong>SolarWinds</strong> released patches that address the vulnerabilities described in this advisory.</p><p>CERT-EU recommends installing <strong>Orion Platform 2020.2.4</strong> [6] and applying <strong>Hotfix 1 for ServU-FTP 15.2.2</strong> [7].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/solarwinds-patches-critical-vulnerabilities-in-the-orion-platform/\">https://www.bleepingcomputer.com/news/security/solarwinds-patches-critical-vulnerabilities-in-the-orion-platform/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/full-system-control-with-new-solarwinds-orion-based-and-serv-u-ftp-vulnerabilities/\">https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/full-system-control-with-new-solarwinds-orion-based-and-serv-u-ftp-vulnerabilities/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-25274\">https://nvd.nist.gov/vuln/detail/CVE-2021-25274</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-25275\">https://nvd.nist.gov/vuln/detail/CVE-2021-25275</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-25276\">https://nvd.nist.gov/vuln/detail/CVE-2021-25276</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://documentation.solarwinds.com/en/Success_Center/orionplatform/content/release_notes/orion_platform_2020-2-4_release_notes.htm\">https://documentation.solarwinds.com/en/Success_Center/orionplatform/content/release_notes/orion_platform_2020-2-4_release_notes.htm</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://downloads.solarwinds.com/solarwinds/Release/HotFix/Serv-U-15.2.2-Hotfix-1.zip\">https://downloads.solarwinds.com/solarwinds/Release/HotFix/Serv-U-15.2.2-Hotfix-1.zip</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2021-25274",
    "CVE-2021-25275",
    "CVE-2021-25276"
  ]
}