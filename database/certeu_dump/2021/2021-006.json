{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-006.pdf"
  },
  "title": "UPDATE: SonicWall 0-day Vulnerabilities",
  "serial_number": "2021-006",
  "publish_date": "02-02-2021 09:28:00",
  "description": "On January 22nd, SonicWall has disclosed that it has been hacked in an attack that exploited zero-day vulnerabilities in several of its own VPN software products, SMA 100 series. On February 3rd, SonicWall has released a new firmware update that fixes the vulnerability.",
  "url_title": "2021-006",
  "content_markdown": "---\ntitle: 'SonicWall 0-day Vulnerabilities'\nversion: '1.1'\nnumber: '2021-006'\ndate: 'February 4, 2021'\n---\n\n_History:_\n\n* _02/02/2021 --- v1.0 -- Initial publication_\n* _04/02/2021 --- v1.1 -- Update with info about a patch and possible IoCs_\n\n# Summary\n\nOn January 22nd, SonicWall has disclosed that it has been hacked in an attack that exploited zero-day vulnerabilities in several of its own VPN software products, SMA 100 series [1, 2]. On February 3rd, SonicWall has released a new firmware update that fixes the vulnerability [4].\n\n# Technical Details\n\nOn January 22nd, the manufacturer informed that faced a _coordinated attack_ with unknown actors leveraged zero-day vulnerabilities in SonicWall products to target its internal systems [1, 3]. They said that the attack was carried out by _highly sophisticated threat actors_ but has not released any information on the identity of the assailants.\n\nThe vulnerability results in improper SQL command neutralisation in the SonicWall SSLVPN SMA100 product and allows remote exploitation for credential access by an unauthenticated attacker [5].\n\n# Affected Products\n\nThis vulnerability affects SMA100 build version 10.x [5]:\n\n- Physical Appliances: SMA 200, SMA 210, SMA 400, SMA 410\n- Virtual Appliances: SMA 500v (Azure, AWS, ESXi, HyperV)\n\n# Recommendations\n\nCERT-EU strongly recommends to upgrade your affected appliance(s) to the last version of the firmware (SMA 10.2.0.5-29sv) [6, 7].\n\nMoreover, CERT-EU recommends to take the following actions:\n\n- Reset the passwords for any users who may have logged in to the device via the web interface.\n- Enable multi-factor authentication (MFA).\n\nAdmins who cannot immediately apply this patch should enable the Web Application Firewall (WAF) until they are ready to deploy the patch on affected devices.\n\n## Hunting for Compromise\n\nNCC Group shared some guidance on how to look for potential indicators of compromise [4]. Administrators could look for requests to `/cgi-bin/management` that do not have a previous successful request to `/__api__/v1/logon` or `/__api__/v1/logon//authenticate`. If these requests do exist, then it would indicate an authorisation bypass to the management interface.\n\nTo check for user-level bypass via the VPN client or the web, administrators should look for access log entries to:\n\n```\n/cgi-bin/sslvpnclient\n/cgi-bin/portal\n```\n\nIf a user accessed these paths without also previously accessing the following paths, it indicates a _user-level_ authorisation bypass.\n\n\nVia VPN client:\n\n\t/cgi-bin/userLogin (for VPN client)\n\nVia web:\n\n\t/__api__/v1/logon (200)\n\t/__api__/v1/logon//authenticate\n\n# References\n\n[1] <https://www.sonicwall.com/support/product-notification/urgent-security-notice-probable-sma-100-series-vulnerability-updated-jan-27-2021/210122173415410/>\n\n[2] <https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001>\n\n[3] <https://portswigger.net/daily-swig/sonicwall-updates-users-after-highly-sophisticated-cyber-attack-leverages-zero-day-vulnerabilities>\n\n[4] <https://www.bleepingcomputer.com/news/security/sonicwall-fixes-actively-exploited-sma-100-zero-day-vulnerability/>\n\n[5] <https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001>\n\n[6] <https://www.sonicwall.com/support/knowledge-base/how-to-upgrade-firmware-on-sma-100-series-appliances/170502339501169/#:~:text=Now%20from%20the%20Web%20UI,new%20version%20in%20New%20Firmware.>\n\n[7] <https://www.sonicwall.com/support/knowledge-base/smb-ssl-vpn-upgrading-firmware-on-sma-500v-virtual-appliance/170502851052498/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>02/02/2021 --- v1.0 -- Initial publication</em></li><li><em>04/02/2021 --- v1.1 -- Update with info about a patch and possible IoCs</em></li></ul><h2 id=\"summary\">Summary</h2><p>On January 22nd, SonicWall has disclosed that it has been hacked in an attack that exploited zero-day vulnerabilities in several of its own VPN software products, SMA 100 series [1, 2]. On February 3rd, SonicWall has released a new firmware update that fixes the vulnerability [4].</p><h2 id=\"technical-details\">Technical Details</h2><p>On January 22nd, the manufacturer informed that faced a <em>coordinated attack</em> with unknown actors leveraged zero-day vulnerabilities in SonicWall products to target its internal systems [1, 3]. They said that the attack was carried out by <em>highly sophisticated threat actors</em> but has not released any information on the identity of the assailants.</p><p>The vulnerability results in improper SQL command neutralisation in the SonicWall SSLVPN SMA100 product and allows remote exploitation for credential access by an unauthenticated attacker [5].</p><h2 id=\"affected-products\">Affected Products</h2><p>This vulnerability affects SMA100 build version 10.x [5]:</p><ul><li>Physical Appliances: SMA 200, SMA 210, SMA 400, SMA 410</li><li>Virtual Appliances: SMA 500v (Azure, AWS, ESXi, HyperV)</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU strongly recommends to upgrade your affected appliance(s) to the last version of the firmware (SMA 10.2.0.5-29sv) [6, 7].</p><p>Moreover, CERT-EU recommends to take the following actions:</p><ul><li>Reset the passwords for any users who may have logged in to the device via the web interface.</li><li>Enable multi-factor authentication (MFA).</li></ul><p>Admins who cannot immediately apply this patch should enable the Web Application Firewall (WAF) until they are ready to deploy the patch on affected devices.</p><h3 id=\"hunting-for-compromise\">Hunting for Compromise</h3><p>NCC Group shared some guidance on how to look for potential indicators of compromise [4]. Administrators could look for requests to <code>/cgi-bin/management</code> that do not have a previous successful request to <code>/__api__/v1/logon</code> or <code>/__api__/v1/logon//authenticate</code>. If these requests do exist, then it would indicate an authorisation bypass to the management interface.</p><p>To check for user-level bypass via the VPN client or the web, administrators should look for access log entries to:</p><pre><code>/cgi-bin/sslvpnclient\n/cgi-bin/portal\n</code></pre><p>If a user accessed these paths without also previously accessing the following paths, it indicates a <em>user-level</em> authorisation bypass.</p><p>Via VPN client:</p><pre><code>/cgi-bin/userLogin (for VPN client)\n</code></pre><p>Via web:</p><pre><code>/__api__/v1/logon (200)\n/__api__/v1/logon//authenticate\n</code></pre><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.sonicwall.com/support/product-notification/urgent-security-notice-probable-sma-100-series-vulnerability-updated-jan-27-2021/210122173415410/\">https://www.sonicwall.com/support/product-notification/urgent-security-notice-probable-sma-100-series-vulnerability-updated-jan-27-2021/210122173415410/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001\">https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://portswigger.net/daily-swig/sonicwall-updates-users-after-highly-sophisticated-cyber-attack-leverages-zero-day-vulnerabilities\">https://portswigger.net/daily-swig/sonicwall-updates-users-after-highly-sophisticated-cyber-attack-leverages-zero-day-vulnerabilities</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/sonicwall-fixes-actively-exploited-sma-100-zero-day-vulnerability/\">https://www.bleepingcomputer.com/news/security/sonicwall-fixes-actively-exploited-sma-100-zero-day-vulnerability/</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001\">https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0001</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.sonicwall.com/support/knowledge-base/how-to-upgrade-firmware-on-sma-100-series-appliances/170502339501169/#:~:text=Now%20from%20the%20Web%20UI,new%20version%20in%20New%20Firmware.\">https://www.sonicwall.com/support/knowledge-base/how-to-upgrade-firmware-on-sma-100-series-appliances/170502339501169/#:~:text=Now%20from%20the%20Web%20UI,new%20version%20in%20New%20Firmware.</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.sonicwall.com/support/knowledge-base/smb-ssl-vpn-upgrading-firmware-on-sma-500v-virtual-appliance/170502851052498/\">https://www.sonicwall.com/support/knowledge-base/smb-ssl-vpn-upgrading-firmware-on-sma-500v-virtual-appliance/170502851052498/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}