{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-045.pdf"
  },
  "title": "Microsoft - Cosmos DB Vulnerability",
  "serial_number": "2021-045",
  "publish_date": "31-08-2021 11:57:00",
  "description": "On the 26th of August 2021, a cloud security company Wiz announced a vulnerability in Microsoft Azure managed database service - Cosmos DB. When exploited, it gives read/write access to Cosmos DB credentials, including primary key, which provide complete and unrestricted remote access to Microsoft Azure databases and accounts.",
  "url_title": "2021-045",
  "content_markdown": "---\ntitle: 'Microsoft - Cosmos DB Vulnerability'\nversion: '1.0'\nnumber: '2021-045'\ndate: 'August 31, 2021'\n---\n\n_History:_\n\n* _31/08/2021 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn the 26th of August 2021, a cloud security company Wiz announced a vulnerability in Microsoft Azure managed database service - Cosmos DB [1]. When exploited, it gives read/write access to Cosmos DB credentials, including primary key, which provide complete and unrestricted remote access to Microsoft Azure databases and accounts.\n\n# Technical Details\n\nThe vulnerability dubbed ChaosDB is caused by a chain of bugs in the Jupyter Notebook feature, enabled by default and designed to help customers visualise data. Details are provided on researchers' dedicated page [1].\n\n# Products Affected\n\nCosmos DB account that uses the Jupyter Notebook feature feature.\n\n# Recommendations\n\nMicrosoft has already warned cloud customers that hackers may have potentially accessed their data via an exploitable vulnerability in its Azure cloud service.\n\nTo mitigate the risk and block potential attacks, Microsoft advises Azure customers to regenerate the Cosmos DB Primary Keys that could have been stolen before the vulnerable feature was disabled [2].\n\nThe company also advised customers to take the following recommended actions to further secure their Azure Cosmos DB databases [3]:\n\n- Schedule a regular rotation and regeneration of your primary and secondary keys.\n- Consider using the Azure Cosmos DB firewall and virtual network integration to control the access to your accounts at the network level.\n- If you are using the Azure Cosmos DB Core (SQL) API, consider using the Azure Cosmos DB role-based access control (RBAC) to authenticate your database operations with Azure Active Directory instead of primary/secondary keys. With RBAC, you have the option to completely disable your account's primary/secondary keys.\n\nReviewing all past activity on the Cosmos DB accounts is also recommended to detect previous attempts to exploit this vulnerability.\n\nConsidering the seriousness of the flaw, and the fact that **exploits are already available**, CERT-EU strongly advises to **apply recommendations as soon as possible**.\n\n# References\n\n[1] <https://www.wiz.io/blog/chaosdb-how-we-hacked-thousands-of-azure-customers-databases>\n\n[2] <https://docs.microsoft.com/en-us/azure/cosmos-db/secure-access-to-data?tabs=using-primary-key#primary-keys>\n\n[3] <https://www.bleepingcomputer.com/news/microsoft/microsoft-warns-azure-customers-of-critical-cosmos-db-vulnerability/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>31/08/2021 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On the 26th of August 2021, a cloud security company Wiz announced a vulnerability in Microsoft Azure managed database service - Cosmos DB [1]. When exploited, it gives read/write access to Cosmos DB credentials, including primary key, which provide complete and unrestricted remote access to Microsoft Azure databases and accounts.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability dubbed ChaosDB is caused by a chain of bugs in the Jupyter Notebook feature, enabled by default and designed to help customers visualise data. Details are provided on researchers' dedicated page [1].</p><h2 id=\"products-affected\">Products Affected</h2><p>Cosmos DB account that uses the Jupyter Notebook feature feature.</p><h2 id=\"recommendations\">Recommendations</h2><p>Microsoft has already warned cloud customers that hackers may have potentially accessed their data via an exploitable vulnerability in its Azure cloud service.</p><p>To mitigate the risk and block potential attacks, Microsoft advises Azure customers to regenerate the Cosmos DB Primary Keys that could have been stolen before the vulnerable feature was disabled [2].</p><p>The company also advised customers to take the following recommended actions to further secure their Azure Cosmos DB databases [3]:</p><ul><li>Schedule a regular rotation and regeneration of your primary and secondary keys.</li><li>Consider using the Azure Cosmos DB firewall and virtual network integration to control the access to your accounts at the network level.</li><li>If you are using the Azure Cosmos DB Core (SQL) API, consider using the Azure Cosmos DB role-based access control (RBAC) to authenticate your database operations with Azure Active Directory instead of primary/secondary keys. With RBAC, you have the option to completely disable your account's primary/secondary keys.</li></ul><p>Reviewing all past activity on the Cosmos DB accounts is also recommended to detect previous attempts to exploit this vulnerability.</p><p>Considering the seriousness of the flaw, and the fact that <strong>exploits are already available</strong>, CERT-EU strongly advises to <strong>apply recommendations as soon as possible</strong>.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.wiz.io/blog/chaosdb-how-we-hacked-thousands-of-azure-customers-databases\">https://www.wiz.io/blog/chaosdb-how-we-hacked-thousands-of-azure-customers-databases</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/secure-access-to-data?tabs=using-primary-key#primary-keys\">https://docs.microsoft.com/en-us/azure/cosmos-db/secure-access-to-data?tabs=using-primary-key#primary-keys</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/microsoft/microsoft-warns-azure-customers-of-critical-cosmos-db-vulnerability/\">https://www.bleepingcomputer.com/news/microsoft/microsoft-warns-azure-customers-of-critical-cosmos-db-vulnerability/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}