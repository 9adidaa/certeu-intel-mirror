{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2021-073.pdf"
  },
  "title": "Adobe ColdFusion Critical Vulnerability",
  "serial_number": "2021-073",
  "publish_date": "17-12-2021 15:07:00",
  "description": "On December 16th, Adobe updated its security advisory related to CVE-2021-44228 affecting ColdFusion products. While this CVE affects the Java logging library log4j, all products using this library are vulnerable to Unauthenticated Remote Code Execution.",
  "url_title": "2021-073",
  "content_markdown": "---\ntitle: 'Adobe ColdFusion CriticalÂ Vulnerability'\nversion: '1.0'\nnumber: '2021-073'\ndate: 'December 17, 2021'\n---\n\n_History:_\n\n* _17/12/2021 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn December 16th, Adobe updated its security advisory related to CVE-2021-44228 affecting ColdFusion products [1]. While this CVE affects the Java logging library log4j, all products using this library are vulnerable to Unauthenticated Remote Code Execution [2].\n\n# Technical Details\n\nThe vulnerability exists in the Java logging library log4j. An unauthenticated remote attacker might exploit this vulnerability by sending specially crafted content to the application to execute malicious code on the server [2].\n\n# Affected products\n\n- ColdFusion 2021 release - contains the vulnerable Log4j versions 2.13.3\n- ColdFusion 2018 release - contains the vulnerable Log4j versions 2.13.3 and/or 2.9.0\n- Performance Monitoring Toolset 2021 - contains the vulnerable Log4j versions 2.11.1 and 2.3\n- Performance Monitoring Toolset 2018 - contains the vulnerable Log4j versions 2.9.1 and 2.3\n- API Manager 2021, 2018, and 2016 - contains the vulnerable Log4j versions 2.3\n\n# Workaround and mitigation\n\nAdobe plans to release a patch for the log4j vulnerability to ColdFusion's customers the 17/12/2021. In the meantime, they recommend to apply these mitigation steps until the patch is released.\n\nThe mitigation steps, according to the product and the version are presented below:\n\n## ColdFusion 2021\n\n- Stop the server.\n- Navigate to the directory `<cf_root>\\<Instance_name>\\bin`.\n- Open `jvm.config` file and add `-Dlog4j2.formatMsgNoLookups=true` argument in `java.args` section. Save the file.\n- If using any third-party libraries that use Log4j2, and hence vulnerable, search for log4j-core in `<cf_root>` directory. If the Log4j2 version (<= 2.10 and >=2.0-beta9)  is found, remove the `JndiLookup` class from the classpath like below, otherwise skip this step.\n    - If the Operating System is Windows , then unzip the `log4j-core-2.x.jar` file and remove the class from path: `org/apache/logging/log4j/core/lookup/JndiLookup.class` and zip the `log4j-core-2.x.jar`. `X` is the version number you found in the folder.\n    - If the Operating System is non-windows, then remove the `JndiLookup` class from the classpath : `zip -q -d log4j-core-2.x.jar  org/apache/logging/log4j/core/lookup/JndiLookup.class`. `X` is the version number you found in the folder.\n- Restart the instance.\n- Repeat the procedure for all other instances.\n\n## ColdFusion 2018\n\n- Stop the server.\n- Navigate to the directory `<cf_root>\\<Instance_name>\\bin`.\n- Open `jvm.config` file and add `-Dlog4j2.formatMsgNoLookups=true` argument in `java.args` section. Save the file.\n- If you find the file `log4j-core-2.9.0.jar`, move the file to a temporary location.\n- Copy the patched `log4j-core-2.9.0.jar` file with `JNDILookUp` class that you have removed. The new file can be downloaded on Adobe website [3].\n- If you are using any third-party libraries that use log4j2, and hence vulnerable, search for log4j-core in `<cf_root>` directory. If log4j2 version (<= 2.10 and >=2.0-beta9) is found, remove the `JndiLookup` class from the classpath as mentioned below, otherwise skip this step:\n    - If the Operating System is Windows, then unzip the `log4j-core-2.x.jar` file and remove the class from path : `org/apache/logging/log4j/core/lookup/JndiLookup.class` and zip the log4j-core-2.x.jar. `X` is the version number that you found in the folder.\n    - If the Operating Systems is non-Windows, then remove the `JndiLookup` class from the classpath : `zip -q -d log4j-core-2.x.jar  org/apache/logging/log4j/core/lookup/JndiLookup.class`. `X` is the version number that you found in the folder.\n- Restart the instance and delete `log4j-core-2.9.0.jar` from the temporary location.\n- Repeat the procedure for all other instances.\n\n## Performance Monitoring Toolset 2021\n\n- Stop the Performance Monitoring Toolset and datastore services.\n- Navigate to the directory `<PMT_Home>\\datastore\\config`.\n- Open the file `jvm.options`, add `-Dlog4j2.formatMsgNoLookups=true` argument in `#log4j2` section. Save the file.\n- Navigate to the directory `<PMT_Home>\\lib`.\n- Move the file `log4j-core-2.3.jar` to a temporary location.\n- Copy the patched `log4j-core-2.3.jar` file with `JNDILookUp` class removed. The file can be downloaded from Adobe website [4].\n- Restart the Performance Monitoring Toolset and datastore services.\n- Delete `log4j-core-2.3.jar` from the temporary location.\n\n## Performance Monitoring Toolset 2018\n\n- Stop the Performance Monitoring Toolset and datastore services.\n- Navigate to the directory `<PMT_Home>\\datastore\\lib`.\n- Move the file `log4j-core-2.9.1.jar` to a temporary location.\n- Copy the patched `log4j-core-2.9.1.jar` file with `JNDILookUp` class removed. The file can be downloaded from Adobe website [5].\n- Navigate to the directory `<PMT_Home>\\lib`.\n- Copy the file `log4j-core-2.3.jar` to a temporary location.\n- Copy the patched `log4j-core-2.3.jar` file with `JNDILookUp` class removed. The file can be downloaded from Adobe website [4].\n- Restart the Performance Monitoring Toolset and datastore services.\n- Delete `log4j-core-2.3.jar` and `log4j-core-2.9.1.jar` from the temporary location.\n\n## API Manager 2021, 2018, and 2016\n\n- Stop the API Manager server (`<APIM_Home>\\bin`) and Analytics (`<APIM_Home>database\\analytics\\bin`) service.\n- Navigate to the directory `<APIM_Home>\\lib`.\n- Move the file `log4j-core-2.3.jar` to a temporary location.\n- Copy the patched `log4j-core-2.3.jar` file with `JNDILookUp` class removed. The file can be downloaded from Adobe website [4].\n- Restart the Analytics service and the API Manager server.\n- You can now delete `log4j-core-2.3.jar` from the temporary location.\n\n# References\n\n[1] <https://helpx.adobe.com/ch_fr/coldfusion/kb/log4j-vulnerability-coldfusion.html>\n\n[2] <https://media.cert.europa.eu/static/SecurityAdvisories/2021/CERT-EU-SA2021-067.pdf>\n\n[3] <https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.9.0/log4j-core-2.9.0-logshell.jar>\n\n[4] <https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.3/log4j-core-2.3-logshell.jar>\n\n[5] <https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.9.1/log4j-core-2.9.1-logshell.jar>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>17/12/2021 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On December 16th, Adobe updated its security advisory related to CVE-2021-44228 affecting ColdFusion products [1]. While this CVE affects the Java logging library log4j, all products using this library are vulnerable to Unauthenticated Remote Code Execution [2].</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability exists in the Java logging library log4j. An unauthenticated remote attacker might exploit this vulnerability by sending specially crafted content to the application to execute malicious code on the server [2].</p><h2 id=\"affected-products\">Affected products</h2><ul><li>ColdFusion 2021 release - contains the vulnerable Log4j versions 2.13.3</li><li>ColdFusion 2018 release - contains the vulnerable Log4j versions 2.13.3 and/or 2.9.0</li><li>Performance Monitoring Toolset 2021 - contains the vulnerable Log4j versions 2.11.1 and 2.3</li><li>Performance Monitoring Toolset 2018 - contains the vulnerable Log4j versions 2.9.1 and 2.3</li><li>API Manager 2021, 2018, and 2016 - contains the vulnerable Log4j versions 2.3</li></ul><h2 id=\"workaround-and-mitigation\">Workaround and mitigation</h2><p>Adobe plans to release a patch for the log4j vulnerability to ColdFusion's customers the 17/12/2021. In the meantime, they recommend to apply these mitigation steps until the patch is released.</p><p>The mitigation steps, according to the product and the version are presented below:</p><h3 id=\"coldfusion-2021\">ColdFusion 2021</h3><ul><li>Stop the server.</li><li>Navigate to the directory <code>&lt;cf_root&gt;\\&lt;Instance_name&gt;\\bin</code>.</li><li>Open <code>jvm.config</code> file and add <code>-Dlog4j2.formatMsgNoLookups=true</code> argument in <code>java.args</code> section. Save the file.</li><li>If using any third-party libraries that use Log4j2, and hence vulnerable, search for log4j-core in <code>&lt;cf_root&gt;</code> directory. If the Log4j2 version (&lt;= 2.10 and &gt;=2.0-beta9) is found, remove the <code>JndiLookup</code> class from the classpath like below, otherwise skip this step. <ul><li>If the Operating System is Windows , then unzip the <code>log4j-core-2.x.jar</code> file and remove the class from path: <code>org/apache/logging/log4j/core/lookup/JndiLookup.class</code> and zip the <code>log4j-core-2.x.jar</code>. <code>X</code> is the version number you found in the folder.</li><li>If the Operating System is non-windows, then remove the <code>JndiLookup</code> class from the classpath : <code>zip -q -d log4j-core-2.x.jar org/apache/logging/log4j/core/lookup/JndiLookup.class</code>. <code>X</code> is the version number you found in the folder.</li></ul></li><li>Restart the instance.</li><li>Repeat the procedure for all other instances.</li></ul><h3 id=\"coldfusion-2018\">ColdFusion 2018</h3><ul><li>Stop the server.</li><li>Navigate to the directory <code>&lt;cf_root&gt;\\&lt;Instance_name&gt;\\bin</code>.</li><li>Open <code>jvm.config</code> file and add <code>-Dlog4j2.formatMsgNoLookups=true</code> argument in <code>java.args</code> section. Save the file.</li><li>If you find the file <code>log4j-core-2.9.0.jar</code>, move the file to a temporary location.</li><li>Copy the patched <code>log4j-core-2.9.0.jar</code> file with <code>JNDILookUp</code> class that you have removed. The new file can be downloaded on Adobe website [3].</li><li>If you are using any third-party libraries that use log4j2, and hence vulnerable, search for log4j-core in <code>&lt;cf_root&gt;</code> directory. If log4j2 version (&lt;= 2.10 and &gt;=2.0-beta9) is found, remove the <code>JndiLookup</code> class from the classpath as mentioned below, otherwise skip this step: <ul><li>If the Operating System is Windows, then unzip the <code>log4j-core-2.x.jar</code> file and remove the class from path : <code>org/apache/logging/log4j/core/lookup/JndiLookup.class</code> and zip the log4j-core-2.x.jar. <code>X</code> is the version number that you found in the folder.</li><li>If the Operating Systems is non-Windows, then remove the <code>JndiLookup</code> class from the classpath : <code>zip -q -d log4j-core-2.x.jar org/apache/logging/log4j/core/lookup/JndiLookup.class</code>. <code>X</code> is the version number that you found in the folder.</li></ul></li><li>Restart the instance and delete <code>log4j-core-2.9.0.jar</code> from the temporary location.</li><li>Repeat the procedure for all other instances.</li></ul><h3 id=\"performance-monitoring-toolset-2021\">Performance Monitoring Toolset 2021</h3><ul><li>Stop the Performance Monitoring Toolset and datastore services.</li><li>Navigate to the directory <code>&lt;PMT_Home&gt;\\datastore\\config</code>.</li><li>Open the file <code>jvm.options</code>, add <code>-Dlog4j2.formatMsgNoLookups=true</code> argument in <code>#log4j2</code> section. Save the file.</li><li>Navigate to the directory <code>&lt;PMT_Home&gt;\\lib</code>.</li><li>Move the file <code>log4j-core-2.3.jar</code> to a temporary location.</li><li>Copy the patched <code>log4j-core-2.3.jar</code> file with <code>JNDILookUp</code> class removed. The file can be downloaded from Adobe website [4].</li><li>Restart the Performance Monitoring Toolset and datastore services.</li><li>Delete <code>log4j-core-2.3.jar</code> from the temporary location.</li></ul><h3 id=\"performance-monitoring-toolset-2018\">Performance Monitoring Toolset 2018</h3><ul><li>Stop the Performance Monitoring Toolset and datastore services.</li><li>Navigate to the directory <code>&lt;PMT_Home&gt;\\datastore\\lib</code>.</li><li>Move the file <code>log4j-core-2.9.1.jar</code> to a temporary location.</li><li>Copy the patched <code>log4j-core-2.9.1.jar</code> file with <code>JNDILookUp</code> class removed. The file can be downloaded from Adobe website [5].</li><li>Navigate to the directory <code>&lt;PMT_Home&gt;\\lib</code>.</li><li>Copy the file <code>log4j-core-2.3.jar</code> to a temporary location.</li><li>Copy the patched <code>log4j-core-2.3.jar</code> file with <code>JNDILookUp</code> class removed. The file can be downloaded from Adobe website [4].</li><li>Restart the Performance Monitoring Toolset and datastore services.</li><li>Delete <code>log4j-core-2.3.jar</code> and <code>log4j-core-2.9.1.jar</code> from the temporary location.</li></ul><h3 id=\"api-manager-2021-2018-and-2016\">API Manager 2021, 2018, and 2016</h3><ul><li>Stop the API Manager server (<code>&lt;APIM_Home&gt;\\bin</code>) and Analytics (<code>&lt;APIM_Home&gt;database\\analytics\\bin</code>) service.</li><li>Navigate to the directory <code>&lt;APIM_Home&gt;\\lib</code>.</li><li>Move the file <code>log4j-core-2.3.jar</code> to a temporary location.</li><li>Copy the patched <code>log4j-core-2.3.jar</code> file with <code>JNDILookUp</code> class removed. The file can be downloaded from Adobe website [4].</li><li>Restart the Analytics service and the API Manager server.</li><li>You can now delete <code>log4j-core-2.3.jar</code> from the temporary location.</li></ul><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://helpx.adobe.com/ch_fr/coldfusion/kb/log4j-vulnerability-coldfusion.html\">https://helpx.adobe.com/ch_fr/coldfusion/kb/log4j-vulnerability-coldfusion.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://media.cert.europa.eu/static/SecurityAdvisories/2021/CERT-EU-SA2021-067.pdf\">https://media.cert.europa.eu/static/SecurityAdvisories/2021/CERT-EU-SA2021-067.pdf</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.9.0/log4j-core-2.9.0-logshell.jar\">https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.9.0/log4j-core-2.9.0-logshell.jar</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.3/log4j-core-2.3-logshell.jar\">https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.3/log4j-core-2.3-logshell.jar</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.9.1/log4j-core-2.9.1-logshell.jar\">https://cfdownload.adobe.com/pub/adobe/coldfusion/logshell/2.9.1/log4j-core-2.9.1-logshell.jar</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2021-44228"
  ]
}