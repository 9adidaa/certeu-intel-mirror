{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2017-008.pdf"
  },
  "title": "Broadcom Critical Wi-Fi SoC Vulnerability in iOS and Android",
  "serial_number": "2017-008",
  "publish_date": "07-04-2017 07:02:00",
  "description": "The vulnerability resides in a widely used Wi-Fi chipset manufactured by Broadcom and used in both iOS and Android devices. An attacker within range may be able to execute arbitrary code on the Wi-Fi chip. Google Project Zero researcher Gal Beniamini, who discovered the flaw said it allowed the execution of malicious code by Wi-Fi proximity alone, requiring no user interaction [1].",
  "url_title": "2017-008",
  "content_markdown": "---\ntitle: 'Broadcom Critical Wi-Fi SoC Vulnerability in iOS and Android'\nversion: '1.0'\nnumber: '2017-008'\ndate: 'April 7, 2017'\n---\n\n_History:_\n\n* _07/04/2017 --- v1.0: Initial publication_\n\n# Summary\n\nThe vulnerability resides in a widely used Wi-Fi chipset manufactured by Broadcom and used in both iOS and Android devices. An attacker within range may be able to execute arbitrary code on the Wi-Fi chip. Google Project Zero researcher Gal Beniamini, who discovered the flaw said it allowed the execution of malicious code by Wi-Fi proximity alone, requiring no user interaction [1].\n\n# Technical Details\n\nThe proof-of-concept exploit [1] developed by Gal Beniamini uses Wi-Fi frames that contain irregular values. The values cause the firmware running on Broadcom's wireless system-on-chip (SoC) to overflow its stack. By using the frames to target timers responsible for carrying out regularly occurring events such as performing scans for adjacent networks, specific regions of device memory are overwritten with arbitrary _shellcode_. Proof-of-concept code does nothing more than write a benign value to a specific memory address. Attackers could exploit the same series of flaws to execute malicious code on vulnerable devices within range of a rogue access point [2].\n\n# Products Affected\n\nMobile devices equipped with Broadcom WiFi SoC including (but not limited to) [5]:\n\n* iPhone 5 through to iPhone 7,\n* Android Google Nexus,\n* Samsung Galaxy latest flagships.\n\nBesides smartphones and tablets, many other devices with Broadcom Wi-Fi chips could also be affected, including Wi-Fi routers, according to Beniamini [5,1]. However, no such devices have been identified at this time.\n\n# Recommendations\n\nApple patched the vulnerability with release of iOS 10.3.1. Google is in the process of releasing an update in its April security bulletin for its Nexus devices. The fix is available only to a select number of device models, and even then it can take two weeks or more to be available as an over-the-air update to those who are eligible [2].\n\nAt the moment, it is not clear if there are effective workarounds available for vulnerable devices. Turning off Wi-Fi is one possibility, but as revealed in recent research into an unrelated Wi-Fi-related weakness involving Android phones, devices often relay on Wi-Fi frames even when Wi-Fi is turned off, for example when hen Wi-Fi-based location settings are enabled [3,4].\n\n# References\n\n[1] <https://googleprojectzero.blogspot.be/2017/04/over-air-exploiting-broadcoms-wi-fi_4.html>\n\n[2] <https://arstechnica.com/security/2017/04/wide-range-of-android-phones-vulnerable-to-device-hijacks-over-wi-fi/?comments=1>\n\n[3] <https://arxiv.org/pdf/1703.02874v1.pdf>\n\n[4] <https://arstechnica.com/security/2017/03/shielding-mac-addresses-from-stalkers-is-hard-android-is-failing-miserably/>\n\n[5] <http://www.zdnet.com/article/iphone-android-hit-by-broadcom-wi-fi-chip-bugs-now-apple-google-plug-flaws/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>07/04/2017 --- v1.0: Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>The vulnerability resides in a widely used Wi-Fi chipset manufactured by Broadcom and used in both iOS and Android devices. An attacker within range may be able to execute arbitrary code on the Wi-Fi chip. Google Project Zero researcher Gal Beniamini, who discovered the flaw said it allowed the execution of malicious code by Wi-Fi proximity alone, requiring no user interaction [1].</p><h2 id=\"technical-details\">Technical Details</h2><p>The proof-of-concept exploit [1] developed by Gal Beniamini uses Wi-Fi frames that contain irregular values. The values cause the firmware running on Broadcom's wireless system-on-chip (SoC) to overflow its stack. By using the frames to target timers responsible for carrying out regularly occurring events such as performing scans for adjacent networks, specific regions of device memory are overwritten with arbitrary <em>shellcode</em>. Proof-of-concept code does nothing more than write a benign value to a specific memory address. Attackers could exploit the same series of flaws to execute malicious code on vulnerable devices within range of a rogue access point [2].</p><h2 id=\"products-affected\">Products Affected</h2><p>Mobile devices equipped with Broadcom WiFi SoC including (but not limited to) [5]:</p><ul><li>iPhone 5 through to iPhone 7,</li><li>Android Google Nexus,</li><li>Samsung Galaxy latest flagships.</li></ul><p>Besides smartphones and tablets, many other devices with Broadcom Wi-Fi chips could also be affected, including Wi-Fi routers, according to Beniamini [5,1]. However, no such devices have been identified at this time.</p><h2 id=\"recommendations\">Recommendations</h2><p>Apple patched the vulnerability with release of iOS 10.3.1. Google is in the process of releasing an update in its April security bulletin for its Nexus devices. The fix is available only to a select number of device models, and even then it can take two weeks or more to be available as an over-the-air update to those who are eligible [2].</p><p>At the moment, it is not clear if there are effective workarounds available for vulnerable devices. Turning off Wi-Fi is one possibility, but as revealed in recent research into an unrelated Wi-Fi-related weakness involving Android phones, devices often relay on Wi-Fi frames even when Wi-Fi is turned off, for example when hen Wi-Fi-based location settings are enabled [3,4].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://googleprojectzero.blogspot.be/2017/04/over-air-exploiting-broadcoms-wi-fi_4.html\">https://googleprojectzero.blogspot.be/2017/04/over-air-exploiting-broadcoms-wi-fi_4.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://arstechnica.com/security/2017/04/wide-range-of-android-phones-vulnerable-to-device-hijacks-over-wi-fi/?comments=1\">https://arstechnica.com/security/2017/04/wide-range-of-android-phones-vulnerable-to-device-hijacks-over-wi-fi/?comments=1</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://arxiv.org/pdf/1703.02874v1.pdf\">https://arxiv.org/pdf/1703.02874v1.pdf</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://arstechnica.com/security/2017/03/shielding-mac-addresses-from-stalkers-is-hard-android-is-failing-miserably/\">https://arstechnica.com/security/2017/03/shielding-mac-addresses-from-stalkers-is-hard-android-is-failing-miserably/</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"http://www.zdnet.com/article/iphone-android-hit-by-broadcom-wi-fi-chip-bugs-now-apple-google-plug-flaws/\">http://www.zdnet.com/article/iphone-android-hit-by-broadcom-wi-fi-chip-bugs-now-apple-google-plug-flaws/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}