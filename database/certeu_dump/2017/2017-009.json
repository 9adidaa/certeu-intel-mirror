{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "Updated-CERT-EU-SA2017-009.pdf"
  },
  "title": "UPDATE Critical zero-day vulnerability in Microsoft Office actively exploited",
  "serial_number": "2017-009",
  "publish_date": "12-04-2017 08:37:00",
  "description": "A vulnerability in Microsoft Office is actively exploited to distribute Dridex banking Trojan.",
  "url_title": "2017-009",
  "content_markdown": "---\ntitle: 'Actively Exploited Critical Zero-Day Vulnerability in Microsoft Office'\nversion: '1.1'\nnumber: '2017-009'\ndate: 'April 12, 2017'\n---\n\n_History:_\n\n* _11/04/2017 --- v1.0: Initial publication_\n* _12/04/2017 --- v1.1: Adding update information from Microsoft_\n\n# Summary\n\nOn 8th of April 2017, FireEye researchers detected malicious Microsoft Office Rich Text Format (RTF) document exploiting a zero-day vulnerability to execute a Visual Basic script when an user opens the document [1, 2]. The malicious script gets executed without the need to enable macros, or any other user interaction.\n\nOn 10th of April 2017, Proofpoint researchers observed the vulnerability being exploited to distribute the Dridex banking Trojan in a large e-mail campaign [3].\n\nOn 11th of April 2017, Microsoft issued a security update to patch the vulnerability (CVE-2017-0199) [5].\n\n# Technical Details\n\nThe malicious documents embed an OLE2 link object. When the user opens the malicious document, a `.hta` file is downloaded from the Internet. The Microsoft HTA application loads and executes the malicious script. The `.hta` content is disguised as a normal RTF file to evade security products.\n\nThe vulnerability is due to the way Microsoft Office products handle HTA files.\n\n# Products Affected\n\n**All Microsoft Office versions and WordPad on Windows systems are affected by the vulnerability.**\n\n# Recommendations\n\nApply security update issued by Microsoft [5].\n\nIn the meanwhile, it is recommended to activate Office Protected View to stop the code execution. However, if the user wants to print or edit the malicious document (by clicking on the **Enable Editing** button), the code will be executed.\n\nAnother workaround is to set the following registry keys to block RTF files [4]:\n\n* `Software\\Microsoft\\Office\\15.0\\Word\\Security\\FileBlock\\RtfFiles` to 2\n* `Software\\Microsoft\\Office\\15.0\\Word\\Security\\FileBlock\\OpenInProtectedView` to 0\n\n# References\n\n[1] FireEye Blog <https://www.fireeye.com/blog/threat-research/2017/04/acknowledgement_ofa.html>\n\n[2] McAfee Blog <https://securingtomorrow.mcafee.com/mcafee-labs/critical-office-zero-day-attacks-detected-wild/>\n\n[3] ProofPoint Blog <https://www.proofpoint.com/us/threat-insight/post/dridex-campaigns-millions-recipients-unpatched-microsoft-zero-day>\n\n[4] Twitter post by Ryan Hanson <https://twitter.com/ryHanson/status/851159178416496640>\n\n[5] Microsoft security advisory <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>11/04/2017 --- v1.0: Initial publication</em></li><li><em>12/04/2017 --- v1.1: Adding update information from Microsoft</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 8th of April 2017, FireEye researchers detected malicious Microsoft Office Rich Text Format (RTF) document exploiting a zero-day vulnerability to execute a Visual Basic script when an user opens the document [1, 2]. The malicious script gets executed without the need to enable macros, or any other user interaction.</p><p>On 10th of April 2017, Proofpoint researchers observed the vulnerability being exploited to distribute the Dridex banking Trojan in a large e-mail campaign [3].</p><p>On 11th of April 2017, Microsoft issued a security update to patch the vulnerability (CVE-2017-0199) [5].</p><h2 id=\"technical-details\">Technical Details</h2><p>The malicious documents embed an OLE2 link object. When the user opens the malicious document, a <code>.hta</code> file is downloaded from the Internet. The Microsoft HTA application loads and executes the malicious script. The <code>.hta</code> content is disguised as a normal RTF file to evade security products.</p><p>The vulnerability is due to the way Microsoft Office products handle HTA files.</p><h2 id=\"products-affected\">Products Affected</h2><p><strong>All Microsoft Office versions and WordPad on Windows systems are affected by the vulnerability.</strong></p><h2 id=\"recommendations\">Recommendations</h2><p>Apply security update issued by Microsoft [5].</p><p>In the meanwhile, it is recommended to activate Office Protected View to stop the code execution. However, if the user wants to print or edit the malicious document (by clicking on the <strong>Enable Editing</strong> button), the code will be executed.</p><p>Another workaround is to set the following registry keys to block RTF files [4]:</p><ul><li><code>Software\\Microsoft\\Office\\15.0\\Word\\Security\\FileBlock\\RtfFiles</code> to 2</li><li><code>Software\\Microsoft\\Office\\15.0\\Word\\Security\\FileBlock\\OpenInProtectedView</code> to 0</li></ul><h2 id=\"references\">References</h2><p>[1] FireEye Blog <a rel=\"noopener\" target=\"_blank\" href=\"https://www.fireeye.com/blog/threat-research/2017/04/acknowledgement_ofa.html\">https://www.fireeye.com/blog/threat-research/2017/04/acknowledgement_ofa.html</a></p><p>[2] McAfee Blog <a rel=\"noopener\" target=\"_blank\" href=\"https://securingtomorrow.mcafee.com/mcafee-labs/critical-office-zero-day-attacks-detected-wild/\">https://securingtomorrow.mcafee.com/mcafee-labs/critical-office-zero-day-attacks-detected-wild/</a></p><p>[3] ProofPoint Blog <a rel=\"noopener\" target=\"_blank\" href=\"https://www.proofpoint.com/us/threat-insight/post/dridex-campaigns-millions-recipients-unpatched-microsoft-zero-day\">https://www.proofpoint.com/us/threat-insight/post/dridex-campaigns-millions-recipients-unpatched-microsoft-zero-day</a></p><p>[4] Twitter post by Ryan Hanson <a rel=\"noopener\" target=\"_blank\" href=\"https://twitter.com/ryHanson/status/851159178416496640\">https://twitter.com/ryHanson/status/851159178416496640</a></p><p>[5] Microsoft security advisory <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2017-0199"
  ]
}