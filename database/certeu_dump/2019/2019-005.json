{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2019-005.pdf"
  },
  "title": "UPDATE: Critical Flaw in Drupal Allows Remote Code Execution",
  "serial_number": "2019-005",
  "publish_date": "22-02-2019 15:38:00",
  "description": "An important security update was released by Drupal, which patches a remote code execution vulnerability (number CVE-2019-6340). The vulnerability was caused by the data passed into the RESTful Web service without strict verification. Successful exploitation of the vulnerability can result in remote code execution on the target host. RESTful services are not turned on by default, greatly reducing the risk of exploitation. For security reasons, users of Drupal are advised to upgrade in a timely manner.",
  "url_title": "2019-005",
  "content_markdown": "---\ntitle: 'Critical Flaw in Drupal Allows Remote Code Execution'\nversion: '1.1'\nnumber: '2019-005'\ndate: 'February 26, 2019'\n---\n\n_History:_\n\n* _22/02/2019 --- v1.0 -- Initial publication_\n* _26/02/2019 --- v1.1 -- Additional exploit path_\n\n# Summary\n\nAn important security update was released by Drupal, which patches a remote code execution vulnerability (number CVE-2019-6340). The vulnerability was caused by the data passed into the RESTful Web service without strict verification. Successful exploitation of the vulnerability can result in remote code execution on the target host. RESTful services are not turned on by default, greatly reducing the risk of exploitation. For security reasons, users of Drupal are advised to upgrade in a timely manner [1, 2].\n\n# Technical Details\n\nThe vulnerability was caused by Drupal’s lack of rigorous validation of RESTful Web data. If the site has a RESTful web service enabled and accepts PATCH, POST, or GET requests, or other web service modules enabled in the site, there will be a deserialization issue that will result in code execution [2, 3].\n\nA site is affected by this if one of the following conditions is met:\n\n* The site has the Drupal 8 core RESTful Web Services (rest) module enabled and allows PATCH or POST requests [1]. According to [3] there is now also a new way to exploit this using GET requests as well.\n* the site has another web services module enabled, like JSON:API in Drupal 8, or Services or RESTful Web Services in Drupal 7.\n\n# Products Affected\n\n*  Drupal 8.6.9 and below\n*  Drupal 8.5.10 and below\n\n# Recommendations\n\n* If you are using Drupal 8.6.x, upgrade to Drupal 8.6.10.\n* If you are using Drupal 8.5.x, upgrade to Drupal 8.5.11.\n* Be sure to install any available security updates for contributed projects after updating Drupal core.\n* No core update is required for Drupal 7, but several Drupal 7 contributed modules do require updates.\n\nVersions of Drupal 8 prior to 8.5.x are end-of-life and do not receive security coverage.\n\nTo immediately mitigate the vulnerability, you can disable all web services modules, or configure your web server(s) to not allow PUT/PATCH/POST requests to web services resources. Note that web services resources may be available on multiple paths depending on the configuration of your server(s). For Drupal 7, resources are for example typically available via paths (clean URLs) and via arguments to the `q` query argument. For Drupal 8, paths may still function when prefixed with `index.php/` [1].\n\n# References\n\n[1]\t<https://www.drupal.org/sa-core-2019-003>\n\n[2] <https://meterpreter.org/cve-2019-6340-drupal-remote-code-execution/?cn-reloaded=1>\n\n[3] <https://www.drupal.org/psa-2019-02-22>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>22/02/2019 --- v1.0 -- Initial publication</em></li><li><em>26/02/2019 --- v1.1 -- Additional exploit path</em></li></ul><h2 id=\"summary\">Summary</h2><p>An important security update was released by Drupal, which patches a remote code execution vulnerability (number CVE-2019-6340). The vulnerability was caused by the data passed into the RESTful Web service without strict verification. Successful exploitation of the vulnerability can result in remote code execution on the target host. RESTful services are not turned on by default, greatly reducing the risk of exploitation. For security reasons, users of Drupal are advised to upgrade in a timely manner [1, 2].</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability was caused by Drupal’s lack of rigorous validation of RESTful Web data. If the site has a RESTful web service enabled and accepts PATCH, POST, or GET requests, or other web service modules enabled in the site, there will be a deserialization issue that will result in code execution [2, 3].</p><p>A site is affected by this if one of the following conditions is met:</p><ul><li>The site has the Drupal 8 core RESTful Web Services (rest) module enabled and allows PATCH or POST requests [1]. According to [3] there is now also a new way to exploit this using GET requests as well.</li><li>the site has another web services module enabled, like JSON:API in Drupal 8, or Services or RESTful Web Services in Drupal 7.</li></ul><h2 id=\"products-affected\">Products Affected</h2><ul><li>Drupal 8.6.9 and below</li><li>Drupal 8.5.10 and below</li></ul><h2 id=\"recommendations\">Recommendations</h2><ul><li>If you are using Drupal 8.6.x, upgrade to Drupal 8.6.10.</li><li>If you are using Drupal 8.5.x, upgrade to Drupal 8.5.11.</li><li>Be sure to install any available security updates for contributed projects after updating Drupal core.</li><li>No core update is required for Drupal 7, but several Drupal 7 contributed modules do require updates.</li></ul><p>Versions of Drupal 8 prior to 8.5.x are end-of-life and do not receive security coverage.</p><p>To immediately mitigate the vulnerability, you can disable all web services modules, or configure your web server(s) to not allow PUT/PATCH/POST requests to web services resources. Note that web services resources may be available on multiple paths depending on the configuration of your server(s). For Drupal 7, resources are for example typically available via paths (clean URLs) and via arguments to the <code>q</code> query argument. For Drupal 8, paths may still function when prefixed with <code>index.php/</code> [1].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.drupal.org/sa-core-2019-003\">https://www.drupal.org/sa-core-2019-003</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://meterpreter.org/cve-2019-6340-drupal-remote-code-execution/?cn-reloaded=1\">https://meterpreter.org/cve-2019-6340-drupal-remote-code-execution/?cn-reloaded=1</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.drupal.org/psa-2019-02-22\">https://www.drupal.org/psa-2019-02-22</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2019-6340"
  ]
}