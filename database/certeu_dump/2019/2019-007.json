{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2019-007.pdf"
  },
  "title": "UPDATE: Operation ShadowHammer – Compromised ASUS Computers",
  "serial_number": "2019-007",
  "publish_date": "26-03-2019 11:17:00",
  "description": "In January 2019, Kaspersky has discovered a supply chain attack that affects ASUS computers. Dubbed Operation ShadowHammer, the operation took place from June to November 2018. It is similar to other supply chain attacks on Netsarang and CCleaner. Around 500 thousands of computers could have been potentially impacted, although the malware seems to have been only targeting a few hundred (around 660 identified so far) specific MAC addresses. ASUS has now released a fix and a diagnostic tool.",
  "url_title": "2019-007",
  "content_markdown": "---\ntitle: 'Operation ShadowHammer -- Compromised ASUS Computers'\nversion: '1.1'\nnumber: '2019-007'\ndate: 'March 27, 2019'\n---\n\n_History:_\n\n* _26/03/2019 --- v1.0 -- Initial publication_\n* _27/03/2019 --- v1.1 -- Version updated with information about ASUS fix_\n\n# Summary\n\nIn January 2019, Kaspersky [1, 2] has discovered a supply chain attack that affects ASUS computers. Dubbed *Operation ShadowHammer*, the operation took place from June to November 2018. It is similar to other supply chain attacks on Netsarang and CCleaner [3]. Around 500 thousands of computers could have been potentially impacted, although the malware seems to have been only targeting a few hundred (around 660 identified so far) specific MAC addresses [2]. ASUS has now released a fix and a diagnostic tool [6, 7].\n\n# Technical Details\n\nASUS Live Update is a utility that is pre-installed on most ASUS computers and is used to automatically update certain components such as BIOS, UEFI, drivers and applications. According to Gartner, ASUS is the world’s 5th-largest PC vendor by 2017 unit sales. This makes it an extremely attractive target for APT groups that might want to take advantage of their user-base.\n\nThe researchers estimate that roughly 500,000 Windows computers received the malicious backdoor through the ASUS update server, although the attackers appear to have been targeting only about 600 of those systems. Indeed, the goal of the attack was to surgically target an unknown pool of users, which were identified by their network adapters’ MAC addresses. To achieve this, the attackers had hardcoded a list of MAC addresses in the trojanized samples and this list was used to identify the actual intended targets of this massive operation. The attack sequence can hence be summarized as follows:\n\n1) The trojanized ASUS software is delivered from legitimate update servers and signed with legitimate certificates,\n2) Once installed, the malicious code checks for the infected computer’s MAC address,\n3) If the MAC address matches a predetermined list, the malicious code delivers a second-stage payload.\n\nThis indicates that the incident was highly tailored to a very small set of preselected targets and that the actor possessed foreknowledge of their desired targets, or rapidly developed their target list as their operation progressed. Researchers were able to extract more than 600 unique MAC addresses from over 200 samples used in this attack. Of course, there might be other samples out there with different MAC addresses in their list.\n\nResearchers assess that this supply chain attack matches or even surpasses the Shadowpad and the CCleaner incidents in complexity and techniques. It stayed undetected for so long partly due to the fact that the trojanized updaters were signed with legitimate certificates (e.g.: `ASUSTeK Computer Inc.`). In this case the attack relied on the trust that users or companies place into software that is automatically updated and the companies/infrastructures behind them.\n\nA limited list of IoCs has been released and a more comprehensive list will be available next April during the SAS 2019 security conference [5].\n\n# Products Affected\n\nASUS products that utilise Live Update.\n\n# Recommendations\n\nASUS has implemented a fix in the latest version (ver. 3.6.8) of the Live Update software, introduced multiple security verification mechanisms to prevent any malicious manipulation in the form of software updates or other means, and implemented an enhanced end-to-end encryption mechanism [6]. All users are encouraged to update as soon as possible.\n\nKaspersky provided a tool to check if a MAC address is among those that had been targeted [4]. Additionally, ASUS has created an online security diagnostic tool to check for affected systems, and users who are concerned are encouraged to run it as a precaution [7].\n\n# References\n\n[1] <https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers>\n\n[2] <https://securelist.com/operation-shadowhammer/89992/>\n\n[3] <https://www.cnet.com/news/hackers-took-over-asus-updates-to-send-malware-researchers-found/>\n\n[4] <https://shadowhammer.kaspersky.com/>\n\n[5] <https://sas.kaspersky.com/>\n\n[6] <https://www.asus.com/News/hqfgVUyZ6uyAyJe1>\n\n[7] <https://dlcdnets.asus.com/pub/ASUS/nb/Apps_for_Win10/ASUSDiagnosticTool/ASDT_v1.0.1.0.zip>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>26/03/2019 --- v1.0 -- Initial publication</em></li><li><em>27/03/2019 --- v1.1 -- Version updated with information about ASUS fix</em></li></ul><h2 id=\"summary\">Summary</h2><p>In January 2019, Kaspersky [1, 2] has discovered a supply chain attack that affects ASUS computers. Dubbed <em>Operation ShadowHammer</em>, the operation took place from June to November 2018. It is similar to other supply chain attacks on Netsarang and CCleaner [3]. Around 500 thousands of computers could have been potentially impacted, although the malware seems to have been only targeting a few hundred (around 660 identified so far) specific MAC addresses [2]. ASUS has now released a fix and a diagnostic tool [6, 7].</p><h2 id=\"technical-details\">Technical Details</h2><p>ASUS Live Update is a utility that is pre-installed on most ASUS computers and is used to automatically update certain components such as BIOS, UEFI, drivers and applications. According to Gartner, ASUS is the world’s 5th-largest PC vendor by 2017 unit sales. This makes it an extremely attractive target for APT groups that might want to take advantage of their user-base.</p><p>The researchers estimate that roughly 500,000 Windows computers received the malicious backdoor through the ASUS update server, although the attackers appear to have been targeting only about 600 of those systems. Indeed, the goal of the attack was to surgically target an unknown pool of users, which were identified by their network adapters’ MAC addresses. To achieve this, the attackers had hardcoded a list of MAC addresses in the trojanized samples and this list was used to identify the actual intended targets of this massive operation. The attack sequence can hence be summarized as follows:</p><p>1) The trojanized ASUS software is delivered from legitimate update servers and signed with legitimate certificates, 2) Once installed, the malicious code checks for the infected computer’s MAC address, 3) If the MAC address matches a predetermined list, the malicious code delivers a second-stage payload.</p><p>This indicates that the incident was highly tailored to a very small set of preselected targets and that the actor possessed foreknowledge of their desired targets, or rapidly developed their target list as their operation progressed. Researchers were able to extract more than 600 unique MAC addresses from over 200 samples used in this attack. Of course, there might be other samples out there with different MAC addresses in their list.</p><p>Researchers assess that this supply chain attack matches or even surpasses the Shadowpad and the CCleaner incidents in complexity and techniques. It stayed undetected for so long partly due to the fact that the trojanized updaters were signed with legitimate certificates (e.g.: <code>ASUSTeK Computer Inc.</code>). In this case the attack relied on the trust that users or companies place into software that is automatically updated and the companies/infrastructures behind them.</p><p>A limited list of IoCs has been released and a more comprehensive list will be available next April during the SAS 2019 security conference [5].</p><h2 id=\"products-affected\">Products Affected</h2><p>ASUS products that utilise Live Update.</p><h2 id=\"recommendations\">Recommendations</h2><p>ASUS has implemented a fix in the latest version (ver. 3.6.8) of the Live Update software, introduced multiple security verification mechanisms to prevent any malicious manipulation in the form of software updates or other means, and implemented an enhanced end-to-end encryption mechanism [6]. All users are encouraged to update as soon as possible.</p><p>Kaspersky provided a tool to check if a MAC address is among those that had been targeted [4]. Additionally, ASUS has created an online security diagnostic tool to check for affected systems, and users who are concerned are encouraged to run it as a precaution [7].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers\">https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://securelist.com/operation-shadowhammer/89992/\">https://securelist.com/operation-shadowhammer/89992/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.cnet.com/news/hackers-took-over-asus-updates-to-send-malware-researchers-found/\">https://www.cnet.com/news/hackers-took-over-asus-updates-to-send-malware-researchers-found/</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://shadowhammer.kaspersky.com/\">https://shadowhammer.kaspersky.com/</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://sas.kaspersky.com/\">https://sas.kaspersky.com/</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.asus.com/News/hqfgVUyZ6uyAyJe1\">https://www.asus.com/News/hqfgVUyZ6uyAyJe1</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://dlcdnets.asus.com/pub/ASUS/nb/Apps_for_Win10/ASUSDiagnosticTool/ASDT_v1.0.1.0.zip\">https://dlcdnets.asus.com/pub/ASUS/nb/Apps_for_Win10/ASUSDiagnosticTool/ASDT_v1.0.1.0.zip</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}