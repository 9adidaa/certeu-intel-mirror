{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2019-017.pdf"
  },
  "title": "Vulnerabilities in Popular VPNs",
  "serial_number": "2019-017",
  "publish_date": "26-08-2019 11:48:00",
  "description": "Several vulnerabilities impacting popular VPNs (by Palo Alto, Pulse Security, and Fortinet) have been recently seen being exploited in the wild. In most severe case, the vulnerabilities allow for remote code execution. Although the vulnerabilities have been reported to the vendors much earlier, and they have since been fixed, many services remain unpatched. Recently, significant amount of scanning and exploitation could be seen in the wild. Hence, it is imperative to patch as soon as possible.",
  "url_title": "2019-017",
  "content_markdown": "---\ntitle: 'Vulnerabilities in Popular VPNs'\nversion: '1.0'\nnumber: '2019-017'\ndate: 'August 26, 2019'\n---\n\n_History:_\n\n* _26/08/2019 --- v1.0: Initial publication_\n\n# Summary\n\nSeveral vulnerabilities impacting popular VPNs (by Palo Alto, Pulse Security, and Fortinet) have been recently seen being exploited in the wild. In most severe case, the vulnerabilities allow for remote code execution. Although the vulnerabilities have been reported to the vendors much earlier, and they have since been fixed, many services remain unpatched. Recently, significant amount of scanning and exploitation could be seen in the wild. Hence, it is imperative to patch as soon as possible.\n\n# Technical Details\n\n## Fortinet VPN\n\nThe following vulnerabilities were discovered:\n\n- Pre-auth arbitrary file reading (CVE-2018-13379) [1],\n- Pre-auth XSS (CVE-2018-13380) [2],\n- Pre-auth heap overflow (CVE-2018-13381) [3].\n\nBy combining them, as explained in [4], it is possible to gain reverse shell.\n\n## Pulse VPN\n\nThe vulnerabilities were discovered and have been resolved in Pulse Connect Secure (PCS) and Pulse Policy Secure (PPS). This includes an authentication by-pass vulnerability that can allow an unauthenticated user to perform a remote arbitrary file access on the Pulse Connect Secure gateway, a remote code execution vulnerability that can allow an authenticated administrator to perform remote code execution on Pulse Connect Secure and Pulse Policy Secure gateways. Many of these vulnerabilities have a critical CVSS score and pose significant risk [5]. These vulnerabilities are now seen being exploited in the wild [6].\n\n## Palo Alto VPN\n\nA remote code execution (RCE) vulnerability has been found in Palo Alto GlobalProtect portal and GlobalProtect Gateway interface products (CVE-2019-1579) [7].\nSuccessful exploitation of this issue allows an unauthenticated attacker to execute arbitrary code.\n\n# Products Affected\n\n## Fortinet\n\n- FortiOS 6.0.0 to 6.0.4\n- FortiOS 5.6.0 to 5.6.7\n- FortiOS 5.4 and below\n\n## Pulse Secure\n\nMost versions are affected by at least some of these vulnerabilites. For details -- please consult [5].\n\n## Palo Alto\n\nPAN-OS 7.1.18 and earlier, PAN-OS 8.0.11-h1 and earlier, and PAN-OS 8.1.2 and earlier releases. PAN-OS 9.0 is not affected.\n\n# Recommendations\n\n## Fortinet\n\n* Upgrade to FortiOS 5.6.8, 6.0.5, 6.2.0 or above\n* If not possible to upgrade, a possible workaround is to disable the SSL-VPN web portal service [1, 2, 3]\n\n## Pulse Secure\n\n* Upgrade to the following versions depending on the release used:\n\t- Pulse Connect Secure 9.0R3.4 and 9.0R4\n\t- Pulse Connect Secure 8.3R7.1\n\t- Pulse Connect Secure 8.2R12.1\n\t- Pulse Connect Secure 8.1R15.1\n\t- Pulse Policy Secure 9.0R3.2 and 9.0R4\n\t- Pulse Policy Secure 5.4R7.1\t \n\t- Pulse Policy Secure 5.3R12.1\n\t- Pulse Policy Secure 5.2R12.1\n\t- Pulse Policy Secure 5.1R15.1\n\n## Palo Alto\n\nUpgrade to PAN-OS 7.1.19 and later, PAN-OS 8.0.12 and later, and PAN-OS 8.1.3 and later releases.\n\n# References\n\n[1] <https://fortiguard.com/psirt/FG-IR-18-384>\n\n[2] <https://fortiguard.com/psirt/FG-IR-18-383>\n\n[3] <https://fortiguard.com/psirt/FG-IR-18-387>\n\n[4] <https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/>\n\n[5] <https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101>\n\n[6] <https://opensecurity.global/forums/topic/184-pulse-secure-ssl-vpn-vulnerability-being-exploited-in-wild/>\n\n[7] <https://securityadvisories.paloaltonetworks.com/Home/Detail/158>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>26/08/2019 --- v1.0: Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>Several vulnerabilities impacting popular VPNs (by Palo Alto, Pulse Security, and Fortinet) have been recently seen being exploited in the wild. In most severe case, the vulnerabilities allow for remote code execution. Although the vulnerabilities have been reported to the vendors much earlier, and they have since been fixed, many services remain unpatched. Recently, significant amount of scanning and exploitation could be seen in the wild. Hence, it is imperative to patch as soon as possible.</p><h2 id=\"technical-details\">Technical Details</h2><h3 id=\"fortinet-vpn\">Fortinet VPN</h3><p>The following vulnerabilities were discovered:</p><ul><li>Pre-auth arbitrary file reading (CVE-2018-13379) [1],</li><li>Pre-auth XSS (CVE-2018-13380) [2],</li><li>Pre-auth heap overflow (CVE-2018-13381) [3].</li></ul><p>By combining them, as explained in [4], it is possible to gain reverse shell.</p><h3 id=\"pulse-vpn\">Pulse VPN</h3><p>The vulnerabilities were discovered and have been resolved in Pulse Connect Secure (PCS) and Pulse Policy Secure (PPS). This includes an authentication by-pass vulnerability that can allow an unauthenticated user to perform a remote arbitrary file access on the Pulse Connect Secure gateway, a remote code execution vulnerability that can allow an authenticated administrator to perform remote code execution on Pulse Connect Secure and Pulse Policy Secure gateways. Many of these vulnerabilities have a critical CVSS score and pose significant risk [5]. These vulnerabilities are now seen being exploited in the wild [6].</p><h3 id=\"palo-alto-vpn\">Palo Alto VPN</h3><p>A remote code execution (RCE) vulnerability has been found in Palo Alto GlobalProtect portal and GlobalProtect Gateway interface products (CVE-2019-1579) [7]. Successful exploitation of this issue allows an unauthenticated attacker to execute arbitrary code.</p><h2 id=\"products-affected\">Products Affected</h2><h3 id=\"fortinet\">Fortinet</h3><ul><li>FortiOS 6.0.0 to 6.0.4</li><li>FortiOS 5.6.0 to 5.6.7</li><li>FortiOS 5.4 and below</li></ul><h3 id=\"pulse-secure\">Pulse Secure</h3><p>Most versions are affected by at least some of these vulnerabilites. For details -- please consult [5].</p><h3 id=\"palo-alto\">Palo Alto</h3><p>PAN-OS 7.1.18 and earlier, PAN-OS 8.0.11-h1 and earlier, and PAN-OS 8.1.2 and earlier releases. PAN-OS 9.0 is not affected.</p><h2 id=\"recommendations\">Recommendations</h2><h3 id=\"fortinet-2\">Fortinet</h3><ul><li>Upgrade to FortiOS 5.6.8, 6.0.5, 6.2.0 or above</li><li>If not possible to upgrade, a possible workaround is to disable the SSL-VPN web portal service [1, 2, 3]</li></ul><h3 id=\"pulse-secure-2\">Pulse Secure</h3><ul><li>Upgrade to the following versions depending on the release used: <ul><li>Pulse Connect Secure 9.0R3.4 and 9.0R4</li><li>Pulse Connect Secure 8.3R7.1</li><li>Pulse Connect Secure 8.2R12.1</li><li>Pulse Connect Secure 8.1R15.1</li><li>Pulse Policy Secure 9.0R3.2 and 9.0R4</li><li>Pulse Policy Secure 5.4R7.1 </li><li>Pulse Policy Secure 5.3R12.1</li><li>Pulse Policy Secure 5.2R12.1</li><li>Pulse Policy Secure 5.1R15.1</li></ul></li></ul><h3 id=\"palo-alto-2\">Palo Alto</h3><p>Upgrade to PAN-OS 7.1.19 and later, PAN-OS 8.0.12 and later, and PAN-OS 8.1.3 and later releases.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://fortiguard.com/psirt/FG-IR-18-384\">https://fortiguard.com/psirt/FG-IR-18-384</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://fortiguard.com/psirt/FG-IR-18-383\">https://fortiguard.com/psirt/FG-IR-18-383</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://fortiguard.com/psirt/FG-IR-18-387\">https://fortiguard.com/psirt/FG-IR-18-387</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/\">https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101\">https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44101</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://opensecurity.global/forums/topic/184-pulse-secure-ssl-vpn-vulnerability-being-exploited-in-wild/\">https://opensecurity.global/forums/topic/184-pulse-secure-ssl-vpn-vulnerability-being-exploited-in-wild/</a></p><p>[7] <a rel=\"noopener\" target=\"_blank\" href=\"https://securityadvisories.paloaltonetworks.com/Home/Detail/158\">https://securityadvisories.paloaltonetworks.com/Home/Detail/158</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2018-13379",
    "CVE-2018-13380",
    "CVE-2018-13381",
    "CVE-2019-1579"
  ]
}