{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-025.pdf"
  },
  "title": "Microsoft Sharepoint - RCE in TypeConverters",
  "serial_number": "2020-025",
  "publish_date": "06-05-2020 20:19:00",
  "description": "On the 14th of April 2020, Microsoft released several security advisories for vulnerabilities affecting Microsoft Sharepoint. On the 29th of April 2020, Zero Day Initiative released a blog post providing details on one of these vulnerabilities (CVE-2020-0932).<br>This vulnerability allows authenticated users to execute arbitrary code on a SharePoint server in the context of the service account. To successfully exploit the vulnerability, attacker needs some specific permission (Add or Customize Pages). However, in the default configuration of SharePoint this permission is given to any user as any user can create its own SharePoint site.",
  "url_title": "2020-025",
  "content_markdown": "---\ntitle: 'Microsoft Sharepoint -- RCE in TypeConverters'\nversion: '1.0'\nnumber: '2020-025'\ndate: 'May 6, 2020'\n---\n\n_History:_\n\n* _06/05/2020 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn the 14th of April 2020, Microsoft released several security advisories for vulnerabilities affecting Microsoft Sharepoint [1]. On the 29th of April 2020, Zero Day Initiative released a blog post [2] providing details on one of these vulnerabilities (CVE-2020-0932 [3]).\n\nThis vulnerability allows authenticated users to execute arbitrary code on a SharePoint server in the context of the service account. To successfully exploit the vulnerability, attacker needs some specific permission (_Add or Customize Pages_). However, in the default configuration of SharePoint this permission is given to any user as any user can create its own SharePoint site.\n\n# Technical Details\n\nThe vulnerability is due to improper restriction on available types for properties when the XML configuration of WebParts is parsed. An attacker can use this lack of restriction to convert payload into executable object on the server with the right of the service account.\n\nA full description of the vulnerability is available on Zero Day Initiative blogpost [2].\n\n# Products Affected\n\n* Microsoft SharePoint Enterprise Server 2016\n* Microsoft SharePoint Foundation 2013 Service Pack 1\n* Microsoft SharePoint Server 2019\n\n# Recommendations\n\nMicrosoft has released patches for this vulnerability [3]. It is strongly advised to apply the security update from Microsoft to fix this vulnerability as soon as possible.\n\nIt is also recommended to monitor suspicious access to `/_vti_bin/WebPartPages.asmx` web page, as is it used as entry point for the attack.\n\n## Workarounds\n\nIn order to prevent exploitation of the vulnerability, it is recommended to ensure that users do not have the possibility to create a site, add or customise page if not explicitly needed. It is important to note that users with `Read` permission level **can create site** on the SharePoint server.\n\n# References\n\n[1] <https://support.microsoft.com/en-us/help/4484299/security-update-for-sharepoint-server-2016-april-14-2020>\n\n[2] <https://www.thezdi.com/blog/2020/4/28/cve-2020-0932-remote-code-execution-on-microsoft-sharepoint-using-typeconverters>\n\n[3] <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0932>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>06/05/2020 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On the 14th of April 2020, Microsoft released several security advisories for vulnerabilities affecting Microsoft Sharepoint [1]. On the 29th of April 2020, Zero Day Initiative released a blog post [2] providing details on one of these vulnerabilities (CVE-2020-0932 [3]).</p><p>This vulnerability allows authenticated users to execute arbitrary code on a SharePoint server in the context of the service account. To successfully exploit the vulnerability, attacker needs some specific permission (<em>Add or Customize Pages</em>). However, in the default configuration of SharePoint this permission is given to any user as any user can create its own SharePoint site.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability is due to improper restriction on available types for properties when the XML configuration of WebParts is parsed. An attacker can use this lack of restriction to convert payload into executable object on the server with the right of the service account.</p><p>A full description of the vulnerability is available on Zero Day Initiative blogpost [2].</p><h2 id=\"products-affected\">Products Affected</h2><ul><li>Microsoft SharePoint Enterprise Server 2016</li><li>Microsoft SharePoint Foundation 2013 Service Pack 1</li><li>Microsoft SharePoint Server 2019</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>Microsoft has released patches for this vulnerability [3]. It is strongly advised to apply the security update from Microsoft to fix this vulnerability as soon as possible.</p><p>It is also recommended to monitor suspicious access to <code>/_vti_bin/WebPartPages.asmx</code> web page, as is it used as entry point for the attack.</p><h3 id=\"workarounds\">Workarounds</h3><p>In order to prevent exploitation of the vulnerability, it is recommended to ensure that users do not have the possibility to create a site, add or customise page if not explicitly needed. It is important to note that users with <code>Read</code> permission level <strong>can create site</strong> on the SharePoint server.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.microsoft.com/en-us/help/4484299/security-update-for-sharepoint-server-2016-april-14-2020\">https://support.microsoft.com/en-us/help/4484299/security-update-for-sharepoint-server-2016-april-14-2020</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.thezdi.com/blog/2020/4/28/cve-2020-0932-remote-code-execution-on-microsoft-sharepoint-using-typeconverters\">https://www.thezdi.com/blog/2020/4/28/cve-2020-0932-remote-code-execution-on-microsoft-sharepoint-using-typeconverters</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0932\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0932</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2020-0932"
  ]
}