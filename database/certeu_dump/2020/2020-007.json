{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-007.pdf"
  },
  "title": "Vulnerabilities in WordPress GDPR Cookie Consent Plugin",
  "serial_number": "2020-007",
  "publish_date": "14-02-2020 13:04:00",
  "description": "Critical vulnerabilities affecting the WordPress GDPR Cookie Consent plugin have been identified. This plugin is used to make websites GDPR compliant. The vulnerability was reported by the security researcher Jerome Bruandet from NinTechNet. The exploitation of the vulnerabilities lead to privilege escalation and authenticated stored XSS. This plugin has 700k active installs.",
  "url_title": "2020-007",
  "content_markdown": "---\ntitle: 'Vulnerabilities in WordPress GDPR Cookie Consent Plugin'\nversion: '1.0'\nnumber: '2020-007'\ndate: 'February 14, 2020'\n---\n\n_History:_\n\n* _14/02/2020 --- v1.0 -- Initial publication_\n\n# Summary\n\nCritical vulnerabilities affecting the WordPress GDPR Cookie Consent plugin have been identified. This plugin is used to make websites GDPR compliant. The vulnerability was reported by the security researcher Jerome Bruandet from NinTechNet [1, 2]. The exploitation of the vulnerabilities lead to **privilege escalation** and **authenticated stored XSS**. This plugin has 700k active installs.\n\n# Technical Details\n\nAn AJAX endpoint used in the administration pages of the plugin is the cause of the problem. It fails to implement checks, and as result three actions were exposed: `get_policy_pageid`, `autosave_contant_data,` and `save_contentdata`.\n\n**Authenticated Stored XSS**\n\nThe `autosave_contant_data` is intended to define the default content that appears in the cookie policy preview page. It saves the data into the `cli_pg_content_data` database field without validating it. An authenticated user can use it to inject JavaScript code, which will be loaded and executed each time someone -- authenticated or not -- visits the `http[:]//example[.]com/cli-policy-preview/` page.\n\n**Privilege Escalation**\n\nThe `save_contentdata` method allows the administrator to save the GDPR cookie notice to the database as a page post type. An authenticated user, such as a subscriber, can use it to put any existing page or post (or event the entire website) offline by changing their status from _published_ to _draft_. Additionally, it is possible to delete or change their content. Injected content can include formatted text, local or remote images, as well as hyperlinks and shortcodes. The technique is explained in depth in [2 and 3].\n\n# Affected Products\n\nList of all affected products:\n\n* WordPress GDPR Cookie Consent plugin version 1.8.2 or below\n\n# Recommendations\n\nIt is recommended to update the plugin to the latest version as soon as possible. This vulnerability has been fixed in version 1.8.3.\n\n# References\n\n[1] <https://wordpress.org/plugins/cookie-law-info/>\n\n[2] <https://blog.nintechnet.com/wordpress-gdpr-cookie-consent-plugin-fixed-vulnerability/>\n\n[3] <https://www.wordfence.com/blog/2020/02/improper-access-controls-in-gdpr-cookie-consent-plugin/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>14/02/2020 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>Critical vulnerabilities affecting the WordPress GDPR Cookie Consent plugin have been identified. This plugin is used to make websites GDPR compliant. The vulnerability was reported by the security researcher Jerome Bruandet from NinTechNet [1, 2]. The exploitation of the vulnerabilities lead to <strong>privilege escalation</strong> and <strong>authenticated stored XSS</strong>. This plugin has 700k active installs.</p><h2 id=\"technical-details\">Technical Details</h2><p>An AJAX endpoint used in the administration pages of the plugin is the cause of the problem. It fails to implement checks, and as result three actions were exposed: <code>get_policy_pageid</code>, <code>autosave_contant_data,</code> and <code>save_contentdata</code>.</p><p><strong>Authenticated Stored XSS</strong></p><p>The <code>autosave_contant_data</code> is intended to define the default content that appears in the cookie policy preview page. It saves the data into the <code>cli_pg_content_data</code> database field without validating it. An authenticated user can use it to inject JavaScript code, which will be loaded and executed each time someone -- authenticated or not -- visits the <code>http[:]//example[.]com/cli-policy-preview/</code> page.</p><p><strong>Privilege Escalation</strong></p><p>The <code>save_contentdata</code> method allows the administrator to save the GDPR cookie notice to the database as a page post type. An authenticated user, such as a subscriber, can use it to put any existing page or post (or event the entire website) offline by changing their status from <em>published</em> to <em>draft</em>. Additionally, it is possible to delete or change their content. Injected content can include formatted text, local or remote images, as well as hyperlinks and shortcodes. The technique is explained in depth in [2 and 3].</p><h2 id=\"affected-products\">Affected Products</h2><p>List of all affected products:</p><ul><li>WordPress GDPR Cookie Consent plugin version 1.8.2 or below</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>It is recommended to update the plugin to the latest version as soon as possible. This vulnerability has been fixed in version 1.8.3.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://wordpress.org/plugins/cookie-law-info/\">https://wordpress.org/plugins/cookie-law-info/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.nintechnet.com/wordpress-gdpr-cookie-consent-plugin-fixed-vulnerability/\">https://blog.nintechnet.com/wordpress-gdpr-cookie-consent-plugin-fixed-vulnerability/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.wordfence.com/blog/2020/02/improper-access-controls-in-gdpr-cookie-consent-plugin/\">https://www.wordfence.com/blog/2020/02/improper-access-controls-in-gdpr-cookie-consent-plugin/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}