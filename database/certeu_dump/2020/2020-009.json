{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-009.pdf"
  },
  "title": "Critical Vulnerability in ThemeGrill Demo Importer Wordpress Plugin",
  "serial_number": "2020-009",
  "publish_date": "19-02-2020 17:27:00",
  "description": "A critical vulnerability affecting the ThemeGrill Demo Importer plugin has been identified. Theme Grill Demo Importer is a plugin that can be used to import ThemeGrill official themes demo content, widgets and theme settings. The plugin is affected by a vulnerability that allows any unauthenticated user to wipe the entire database to its default state after which they are automatically logged in as an administrator. There are more than 100K active installations of the plugin.",
  "url_title": "2020-009",
  "content_markdown": "---\ntitle: 'Critical Vulnerability in ThemeGrill Demo Importer Wordpress Plugin'\nversion: '1.0'\nnumber: '2020-009'\ndate: 'February 19, 2020'\n---\n\n_History:_\n\n* _19/02/2020 --- v1.0 -- Initial publication_\n\n# Summary\n\nA critical vulnerability affecting the ThemeGrill Demo Importer plugin has been identified [1, 2]. Theme Grill Demo Importer is a plugin that can be used to import ThemeGrill official themes demo content, widgets and theme settings [2]. The plugin is affected by a vulnerability that allows any unauthenticated user to _wipe the entire database_ to its default state after which they are automatically logged in as an _administrator_. According to [2], there are more than 100K active installations of the plugin.  \n\n# Technical Details\n\n**Prerequisites:**\n\nIn order for the vulnerability to be exploitable, there must be a theme installed and activated by ThemeGrill. In order to be automatically logged in as an _administrator_, there must be a user called `admin` in the database. If the `admin` user does not exist in the database, then the users table will remain empty and there will be no automatic login.\n\n**Details:**\n\nOnce the plugin detects that a ThemeGrill theme is installed and activated, it loads the file `/includes/class-demo-importer.php` which hooks `reset_wizard_actions` into `admin_init`. The `admin_init` hook runs not only in the admin environment, but also on calls to `/wp-admin/admin-ajax.php` which does not require a user to be authenticated [1].\n\nThe bug is present in the `reset_wizard_actions` function where there is no authentication check [1]. If the user is not logged in, the `admin` user object will be retrieved from WordPress and then all WordPress tables that start with the defined WordPress database prefix will be dropped.\n\nOnce all tables have been dropped, it will populate the database with the default settings and data after which it will set the password of the `admin` user to its previously known password.\n\n# Products Affected\n\nList of affected products:\n\nWordPress ThemeGrill Importer plugin versions between (and including) 1.3.4 and 1.6.1\n\n# Recommendations\n\nIt is highly recommended to update the plugin to the latest version as soon as possible. This vulnerability has been fixed in versions 1.6.2 and above.\n\n# References\n\n[1] <https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/>\n\n[2] <https://wordpress.org/plugins/themegrill-demo-importer/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>19/02/2020 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>A critical vulnerability affecting the ThemeGrill Demo Importer plugin has been identified [1, 2]. Theme Grill Demo Importer is a plugin that can be used to import ThemeGrill official themes demo content, widgets and theme settings [2]. The plugin is affected by a vulnerability that allows any unauthenticated user to <em>wipe the entire database</em> to its default state after which they are automatically logged in as an <em>administrator</em>. According to [2], there are more than 100K active installations of the plugin. </p><h2 id=\"technical-details\">Technical Details</h2><p><strong>Prerequisites:</strong></p><p>In order for the vulnerability to be exploitable, there must be a theme installed and activated by ThemeGrill. In order to be automatically logged in as an <em>administrator</em>, there must be a user called <code>admin</code> in the database. If the <code>admin</code> user does not exist in the database, then the users table will remain empty and there will be no automatic login.</p><p><strong>Details:</strong></p><p>Once the plugin detects that a ThemeGrill theme is installed and activated, it loads the file <code>/includes/class-demo-importer.php</code> which hooks <code>reset_wizard_actions</code> into <code>admin_init</code>. The <code>admin_init</code> hook runs not only in the admin environment, but also on calls to <code>/wp-admin/admin-ajax.php</code> which does not require a user to be authenticated [1].</p><p>The bug is present in the <code>reset_wizard_actions</code> function where there is no authentication check [1]. If the user is not logged in, the <code>admin</code> user object will be retrieved from WordPress and then all WordPress tables that start with the defined WordPress database prefix will be dropped.</p><p>Once all tables have been dropped, it will populate the database with the default settings and data after which it will set the password of the <code>admin</code> user to its previously known password.</p><h2 id=\"products-affected\">Products Affected</h2><p>List of affected products:</p><p>WordPress ThemeGrill Importer plugin versions between (and including) 1.3.4 and 1.6.1</p><h2 id=\"recommendations\">Recommendations</h2><p>It is highly recommended to update the plugin to the latest version as soon as possible. This vulnerability has been fixed in versions 1.6.2 and above.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/\">https://www.webarxsecurity.com/critical-issue-in-themegrill-demo-importer/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://wordpress.org/plugins/themegrill-demo-importer/\">https://wordpress.org/plugins/themegrill-demo-importer/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}