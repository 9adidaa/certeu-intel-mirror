{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-055.pdf"
  },
  "title": "Critical Vulnerability in the Solaris PAM Library",
  "serial_number": "2020-055",
  "publish_date": "05-11-2020 13:32:00",
  "description": "Within its monthly Critical Patch Update Advisory, Oracle released patch for a critical vulnerability affecting Solaris Pluggable Authentication Module (PAM).<br>FireEye discovered during an investigation traces of exploitation of this vulnerability since 2018. Moreover, FireEye associated the vulnerability with Oracle Solaris SSHD Remote Root Exploit identified on black-market for sale. This vulnerability allows unauthenticated attacker with network access via multiple protocols to compromise Oracle Solaris.",
  "url_title": "2020-055",
  "content_markdown": "---\ntitle: 'Critical Vulnerability in the Solaris PAM Library'\nversion: '1.0'\nnumber: '2020-055'\ndate: 'November 5, 2020'\n---\n\n_History:_\n\n* _5/11/2020 --- v1.0 -- Initial publication_\n\n# Summary\n\nWithin its monthly Critical Patch Update Advisory, Oracle released patch for a critical vulnerability affecting Solaris Pluggable Authentication Module (PAM) [1].\n\nFireEye discovered during an investigation traces of exploitation of this vulnerability since 2018 [2]. Moreover, FireEye associated the vulnerability with _Oracle Solaris SSHD Remote Root Exploit_ identified on black-market for sale. This vulnerability allows unauthenticated attacker with network access via multiple protocols to compromise Oracle Solaris.\n\n# Technical Details\n\nThe vulnerability received CVE-2020-14871 [3] and has CVSS score 8.8. It occurs in the PAM library. PAM enables a Solaris application to authenticate users while allowing the system administrator to configure authentication parameters (e.g., password complexity and expiration) in one location that is consistently enforced by all applications. The actual vulnerability is a stack-based buffer overflow located in the PAM `parse_user_name` function. It is triggered when a username longer than `PAM_MAX_RESP_SIZE` (512 bytes) is passed to `parse_user_name`. The vulnerability has likely existed for decades.\n\nSSH Keyboard-Interactive authentication is a _passthrough_ authentication mechanism where the SSH protocol relays prompts and responses between the server’s PAM libraries and the client. It was designed to support custom forms of authentication such as two-factor without modifying the SSH protocol. By manipulating SSH client settings to force Keyboard-Interactive authentication to prompt for the username rather than sending it through normal means, an attacker can also pass unlimited input to the PAM `parse_user_name` function.\n\nA proof-of-concept exploit that can be used to see if a server is vulnerable is available in [4]. FireEye has also observed that if a `/core` file exists on a Solaris machine, and the `file` command reports that it is from `sshd`, these indicators are consistent with this vulnerability having been exploited [4].\n\n# Affected Products\n\nThe vulnerability exists in [4]:\n\n- Solaris 9 (some releases)\n- Solaris 10 (all releases)\n- Solaris 11.0^[While the `parse_user_name` function remains vulnerable in unpatched Solaris 11.1 and later, unrelated changes to the PAM library truncate the username before the vulnerable function receives it, rendering the issue non-exploitable via SSH. If the `parse_user_name` function were reachable in another context, then the vulnerability could become exploitable.]\n- Illumos (OpenIndiana 2020.04)\n\n# Recommendations\n\nA patch from Oracle for Solaris 10 and 11 is described in the October 2020 Critical Patch Update [1].\n\n## Workarounds\n\nAs Solaris 9 is no longer supported, Oracle has not released a patch. For Solaris 9, as well as for Solaris 10 or 11 systems where patching is inconvenient, FireEye recommends editing the `/etc/ssh/sshd_config` file to add the lines:\n\n\tChallengeResponseAuthentication no\n\tKbdInteractiveAuthentication no\n\nand restart the SSH server. While this removes the opportunity to exploit the vulnerability using SSH Keyboard-Interactive authentication, there may be other ways to attack the `parse_user_name` function and it is recommended using this workaround only as a stopgap until Solaris 9 systems can be upgraded, or the October patch can be accessed and installed for supported Solaris versions [4].\n\n# References\n\n[1] <https://www.oracle.com/security-alerts/cpuoct2020.html>\n\n[2] <https://www.fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.html>\n\n[3] <https://nvd.nist.gov/vuln/detail/CVE-2020-14871>\n\n[4] <https://www.fireeye.com/blog/threat-research/2020/11/critical-buffer-overflow-vulnerability-in-solaris-can-allow-remote-takeover.html>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>5/11/2020 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>Within its monthly Critical Patch Update Advisory, Oracle released patch for a critical vulnerability affecting Solaris Pluggable Authentication Module (PAM) [1].</p><p>FireEye discovered during an investigation traces of exploitation of this vulnerability since 2018 [2]. Moreover, FireEye associated the vulnerability with <em>Oracle Solaris SSHD Remote Root Exploit</em> identified on black-market for sale. This vulnerability allows unauthenticated attacker with network access via multiple protocols to compromise Oracle Solaris.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability received CVE-2020-14871 [3] and has CVSS score 8.8. It occurs in the PAM library. PAM enables a Solaris application to authenticate users while allowing the system administrator to configure authentication parameters (e.g., password complexity and expiration) in one location that is consistently enforced by all applications. The actual vulnerability is a stack-based buffer overflow located in the PAM <code>parse_user_name</code> function. It is triggered when a username longer than <code>PAM_MAX_RESP_SIZE</code> (512 bytes) is passed to <code>parse_user_name</code>. The vulnerability has likely existed for decades.</p><p>SSH Keyboard-Interactive authentication is a <em>passthrough</em> authentication mechanism where the SSH protocol relays prompts and responses between the server’s PAM libraries and the client. It was designed to support custom forms of authentication such as two-factor without modifying the SSH protocol. By manipulating SSH client settings to force Keyboard-Interactive authentication to prompt for the username rather than sending it through normal means, an attacker can also pass unlimited input to the PAM <code>parse_user_name</code> function.</p><p>A proof-of-concept exploit that can be used to see if a server is vulnerable is available in [4]. FireEye has also observed that if a <code>/core</code> file exists on a Solaris machine, and the <code>file</code> command reports that it is from <code>sshd</code>, these indicators are consistent with this vulnerability having been exploited [4].</p><h2 id=\"affected-products\">Affected Products</h2><p>The vulnerability exists in [4]:</p><ul><li>Solaris 9 (some releases)</li><li>Solaris 10 (all releases)</li><li>Solaris 11.0^[While the <code>parse_user_name</code> function remains vulnerable in unpatched Solaris 11.1 and later, unrelated changes to the PAM library truncate the username before the vulnerable function receives it, rendering the issue non-exploitable via SSH. If the <code>parse_user_name</code> function were reachable in another context, then the vulnerability could become exploitable.]</li><li>Illumos (OpenIndiana 2020.04)</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>A patch from Oracle for Solaris 10 and 11 is described in the October 2020 Critical Patch Update [1].</p><h3 id=\"workarounds\">Workarounds</h3><p>As Solaris 9 is no longer supported, Oracle has not released a patch. For Solaris 9, as well as for Solaris 10 or 11 systems where patching is inconvenient, FireEye recommends editing the <code>/etc/ssh/sshd_config</code> file to add the lines:</p><pre><code>ChallengeResponseAuthentication no\nKbdInteractiveAuthentication no\n</code></pre><p>and restart the SSH server. While this removes the opportunity to exploit the vulnerability using SSH Keyboard-Interactive authentication, there may be other ways to attack the <code>parse_user_name</code> function and it is recommended using this workaround only as a stopgap until Solaris 9 systems can be upgraded, or the October patch can be accessed and installed for supported Solaris versions [4].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.oracle.com/security-alerts/cpuoct2020.html\">https://www.oracle.com/security-alerts/cpuoct2020.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.html\">https://www.fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.html</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-14871\">https://nvd.nist.gov/vuln/detail/CVE-2020-14871</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.fireeye.com/blog/threat-research/2020/11/critical-buffer-overflow-vulnerability-in-solaris-can-allow-remote-takeover.html\">https://www.fireeye.com/blog/threat-research/2020/11/critical-buffer-overflow-vulnerability-in-solaris-can-allow-remote-takeover.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2020-14871"
  ]
}