{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-050.pdf"
  },
  "title": "Microsoft Sharepoint - Remote Code Execution Vulnerability",
  "serial_number": "2020-050",
  "publish_date": "19-10-2020 16:01:00",
  "description": "On the 13th of October 2020, Microsoft released a security advisory for a vulnerability affecting Microsoft Sharepoint identified as CVE-2020-16952. Since then, security specialist Steven Seeley released a proof of concept on how to exploit the vulnerability. Also, a Metasploit module exploiting CVE-2020-16952 has been published and contains remote check logic as well as supplementary exploitation details.<br>Successful exploitation of this vulnerability would allow an attacker to run arbitrary code and carry out security actions in the context of the SharePoint application pool and the SharePoint server farm account. The issue results from the lack of proper validation of user-supplied data which can result in a server-side code include. Authentication is however required to exploit this vulnerability.",
  "url_title": "2020-050",
  "content_markdown": "---\ntitle: 'Microsoft Sharepoint -- Remote Code Execution Vulnerability'\nversion: '1.0'\nnumber: '2020-050'\ndate: 'October 19, 2020'\n---\n\n# Summary\n\nOn the 13th of October 2020, Microsoft released a security advisory for a vulnerability affecting Microsoft Sharepoint identified as CVE-2020-16952 [1]. Since then, security specialist Steven Seeley released a proof of concept on how to exploit the vulnerability [2]. Also, a Metasploit module exploiting CVE-2020-16952 has been published and contains remote check logic as well as supplementary exploitation details.\n\nSuccessful exploitation of this vulnerability would allow an attacker to run arbitrary code and carry out security actions in the context of the SharePoint application pool and the SharePoint server farm account. The issue results from the lack of proper validation of user-supplied data which can result in a server-side code include. Authentication is however required to exploit this vulnerability.\n\n# Technical Details\n\nThe vulnerability is due to validation issue in user-supplied data. This vulnerability can be exploited when a user uploads a specially crafted SharePoint application package to an affected version of SharePoint. The bug is exploitable by an authenticated user with page creation privileges, which is a standard permission in SharePoint, and allows the leaking of an arbitrary file, notably the application’s `web.config` file, which can be used to trigger remote code execution (RCE) via .NET deserialisation. The released security update addresses the vulnerability by correcting how SharePoint checks the source markup of application packages.\n\nA full description of the vulnerability is available on Rapid7 analysis [3].\n\n# Products Affected\n\n* Microsoft SharePoint Foundation 2013 Service Pack 1\n* Microsoft SharePoint Enterprise Server 2016\n* Microsoft SharePoint Server 2019\n* SharePoint Online as part of Office 365 is not affected.\n\n# Recommendations\n\nMicrosoft has released patches for this vulnerability [1]. It is strongly advised to apply the security update from Microsoft to fix this vulnerability as soon as possible.\n\nIt is also recommended to monitor for the exploit variant by identifying HTTP headers containing the string `runat=\"server\"`, as well as auditing SharePoint page creations.\n\n## Workarounds\n\nMicrosoft has not identified any mitigation factors and workarounds for this vulnerability.\n\n# References\n\n[1] <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16952>\n\n[2] <https://srcincite.io/pocs/cve-2020-16952.py.txt>\n\n[3] <https://attackerkb.com/topics/4yGC4tLK2x/cve-2020-16952-microsoft-sharepoint-remote-code-execution-vulnerabilities#rapid7-analysis>\n",
  "content_html": "<h2 id=\"summary\">Summary</h2><p>On the 13th of October 2020, Microsoft released a security advisory for a vulnerability affecting Microsoft Sharepoint identified as CVE-2020-16952 [1]. Since then, security specialist Steven Seeley released a proof of concept on how to exploit the vulnerability [2]. Also, a Metasploit module exploiting CVE-2020-16952 has been published and contains remote check logic as well as supplementary exploitation details.</p><p>Successful exploitation of this vulnerability would allow an attacker to run arbitrary code and carry out security actions in the context of the SharePoint application pool and the SharePoint server farm account. The issue results from the lack of proper validation of user-supplied data which can result in a server-side code include. Authentication is however required to exploit this vulnerability.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability is due to validation issue in user-supplied data. This vulnerability can be exploited when a user uploads a specially crafted SharePoint application package to an affected version of SharePoint. The bug is exploitable by an authenticated user with page creation privileges, which is a standard permission in SharePoint, and allows the leaking of an arbitrary file, notably the application’s <code>web.config</code> file, which can be used to trigger remote code execution (RCE) via .NET deserialisation. The released security update addresses the vulnerability by correcting how SharePoint checks the source markup of application packages.</p><p>A full description of the vulnerability is available on Rapid7 analysis [3].</p><h2 id=\"products-affected\">Products Affected</h2><ul><li>Microsoft SharePoint Foundation 2013 Service Pack 1</li><li>Microsoft SharePoint Enterprise Server 2016</li><li>Microsoft SharePoint Server 2019</li><li>SharePoint Online as part of Office 365 is not affected.</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>Microsoft has released patches for this vulnerability [1]. It is strongly advised to apply the security update from Microsoft to fix this vulnerability as soon as possible.</p><p>It is also recommended to monitor for the exploit variant by identifying HTTP headers containing the string <code>runat=\"server\"</code>, as well as auditing SharePoint page creations.</p><h3 id=\"workarounds\">Workarounds</h3><p>Microsoft has not identified any mitigation factors and workarounds for this vulnerability.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16952\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16952</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://srcincite.io/pocs/cve-2020-16952.py.txt\">https://srcincite.io/pocs/cve-2020-16952.py.txt</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://attackerkb.com/topics/4yGC4tLK2x/cve-2020-16952-microsoft-sharepoint-remote-code-execution-vulnerabilities#rapid7-analysis\">https://attackerkb.com/topics/4yGC4tLK2x/cve-2020-16952-microsoft-sharepoint-remote-code-execution-vulnerabilities#rapid7-analysis</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2020-16952"
  ]
}