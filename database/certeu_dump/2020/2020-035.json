{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2020-035.pdf"
  },
  "title": "UPDATE: Windows DNS Server Remote Code Execution Vulnerability",
  "serial_number": "2020-035",
  "publish_date": "14-07-2020 18:14:00",
  "description": "A remote code execution vulnerability exists in Windows Domain Name System (DNS) servers when they fail to properly handle requests. An attacker who successfully exploited the vulnerability could run arbitrary code in the context of the Local System Account. Windows servers that are configured as DNS servers are at risk from this vulnerability. The vulnerability was originally found by Check Point, and dubbed SIGRed. It has been present for at least last 17 years.",
  "url_title": "2020-035",
  "content_markdown": "---\ntitle: 'Windows DNS Server Remote Code Execution Vulnerability'\nversion: '1.1'\nnumber: '2020-035'\ndate: 'July 15, 2020'\n---\n\n_History:_\n\n* _14/07/2020 --- v1.0 -- Initial publication_\n* _15/07/2020 --- v1.1 -- Additional technical details and references added_\n\n# Summary\n\nA remote code execution vulnerability exists in Windows Domain Name System (DNS) servers when they fail to properly handle requests. An attacker who successfully exploited the vulnerability could **run arbitrary code in the context of the Local System Account**. Windows servers that are configured as DNS servers are at risk from this vulnerability [1, 3]. The vulnerability was originally found by Check Point, and dubbed **SIGRed** [4, 5]. It has been present for at least last 17 years.\n\n# Technical Details\n\nThe vulnerability identified has CVSS score 10 [1]. To exploit the vulnerability, an unauthenticated attacker could send malicious requests to a Windows DNS server. Microsoft considers this to be a **wormable** vulnerability, meaning that it has the potential to spread via malware between vulnerable computers without user interaction [1, 3]. The vulnerability stems from a flaw in Microsoft DNS server implementation and is not the result of a protocol level flaw, so it does not affect any other non-Microsoft DNS server implementations.\n\nThe vulnerability involves configuring a domain's  NS resource records to point to a malicious name server, and querying the target DNS server for the domain in order to have the latter parse responses from the name server for all subsequent queries related to the domain or its subdomains [4]. Then, an attacker can trigger an integer overflow flaw in the function that parses incoming responses for forwarded queries to send a DNS response that contains a SIG resource record larger than 64KB and induce a _controlled heap-based buffer overflow of roughly 64KB over a small allocated buffer_ [4, 5].\n\n# Products Affected\n\nThe following products are affected [1]:\n\n* Windows Server 2008 for 32-bit Systems Service Pack 2\n* Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)\n* Windows Server 2008 for x64-based Systems Service Pack 2\n* Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)\n* Windows Server 2008 R2 for x64-based Systems Service Pack 1\n* Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)\n* Windows Server 2012\n* Windows Server 2012 (Server Core installation)\n* Windows Server 2012 R2\n* Windows Server 2012 R2 (Server Core installation)\n* Windows Server 2016\n* Windows Server 2016 (Server Core installation)\n* Windows Server 2019\n* Windows Server 2019 (Server Core installation)\n* Windows Server, version 1903 (Server Core installation)\n* Windows Server, version 1909 (Server Core installation)\n* Windows Server, version 2004 (Server Core installation)\n\n# Recommendations\n\nThe update release by Microsoft addresses the vulnerability by modifying how Windows DNS servers handle requests [1].\n\n**CERT-EU strongly recommends applying the patches from Microsoft as soon as possible.**\n\n## Workarounds\n\nMicrosoft recommends everyone who runs DNS servers to install the security update as soon as possible. However, if it is not possible to apply the patch right away, Microsoft recommends that the following workaround should be used as soon as possible to protect the affected environment in the time before the update [2].\n\nThe following registry modification has been identified as a workaround for this vulnerability:\n\n```\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters\nTcpReceivePacketSize\nValue = 0xFF00\n```\n\n**Note**: The DNS Service needs to be restarted for the registry change to take effect [2].\n\n# References\n\n[1] <https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>\n\n[2] <https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability>\n\n[3] <https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/>\n\n[4] <https://thehackernews.com/2020/07/windows-dns-server-hacking.html>\n\n[5] <https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>14/07/2020 --- v1.0 -- Initial publication</em></li><li><em>15/07/2020 --- v1.1 -- Additional technical details and references added</em></li></ul><h2 id=\"summary\">Summary</h2><p>A remote code execution vulnerability exists in Windows Domain Name System (DNS) servers when they fail to properly handle requests. An attacker who successfully exploited the vulnerability could <strong>run arbitrary code in the context of the Local System Account</strong>. Windows servers that are configured as DNS servers are at risk from this vulnerability [1, 3]. The vulnerability was originally found by Check Point, and dubbed <strong>SIGRed</strong> [4, 5]. It has been present for at least last 17 years.</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability identified has CVSS score 10 [1]. To exploit the vulnerability, an unauthenticated attacker could send malicious requests to a Windows DNS server. Microsoft considers this to be a <strong>wormable</strong> vulnerability, meaning that it has the potential to spread via malware between vulnerable computers without user interaction [1, 3]. The vulnerability stems from a flaw in Microsoft DNS server implementation and is not the result of a protocol level flaw, so it does not affect any other non-Microsoft DNS server implementations.</p><p>The vulnerability involves configuring a domain's NS resource records to point to a malicious name server, and querying the target DNS server for the domain in order to have the latter parse responses from the name server for all subsequent queries related to the domain or its subdomains [4]. Then, an attacker can trigger an integer overflow flaw in the function that parses incoming responses for forwarded queries to send a DNS response that contains a SIG resource record larger than 64KB and induce a <em>controlled heap-based buffer overflow of roughly 64KB over a small allocated buffer</em> [4, 5].</p><h2 id=\"products-affected\">Products Affected</h2><p>The following products are affected [1]:</p><ul><li>Windows Server 2008 for 32-bit Systems Service Pack 2</li><li>Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation)</li><li>Windows Server 2008 for x64-based Systems Service Pack 2</li><li>Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core installation)</li><li>Windows Server 2008 R2 for x64-based Systems Service Pack 1</li><li>Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation)</li><li>Windows Server 2012</li><li>Windows Server 2012 (Server Core installation)</li><li>Windows Server 2012 R2</li><li>Windows Server 2012 R2 (Server Core installation)</li><li>Windows Server 2016</li><li>Windows Server 2016 (Server Core installation)</li><li>Windows Server 2019</li><li>Windows Server 2019 (Server Core installation)</li><li>Windows Server, version 1903 (Server Core installation)</li><li>Windows Server, version 1909 (Server Core installation)</li><li>Windows Server, version 2004 (Server Core installation)</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>The update release by Microsoft addresses the vulnerability by modifying how Windows DNS servers handle requests [1].</p><p><strong>CERT-EU strongly recommends applying the patches from Microsoft as soon as possible.</strong></p><h3 id=\"workarounds\">Workarounds</h3><p>Microsoft recommends everyone who runs DNS servers to install the security update as soon as possible. However, if it is not possible to apply the patch right away, Microsoft recommends that the following workaround should be used as soon as possible to protect the affected environment in the time before the update [2].</p><p>The following registry modification has been identified as a workaround for this vulnerability:</p><pre><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters\nTcpReceivePacketSize\nValue = 0xFF00\n</code></pre><p><strong>Note</strong>: The DNS Service needs to be restarted for the registry change to take effect [2].</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350\">https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability\">https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/\">https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://thehackernews.com/2020/07/windows-dns-server-hacking.html\">https://thehackernews.com/2020/07/windows-dns-server-hacking.html</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/\">https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2020-1350"
  ]
}