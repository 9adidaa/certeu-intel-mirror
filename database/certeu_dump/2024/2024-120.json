{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2024-120.pdf"
  },
  "title": "Critical Vulnerabilities in Sophos Firewall",
  "serial_number": "2024-120",
  "publish_date": "20-12-2024 14:46:23",
  "description": "On December 19, 2024, Sophos has released critical security updates addressing multiple vulnerabilities in its firewall products. These flaws could allow attackers to escalate privileges or execute arbitrary code.<br>\n",
  "url_title": "2024-120",
  "content_markdown": "---    \ntitle: 'Critical Vulnerabilities in Sophos Firewall'\nnumber: '2024-120'\nversion: '1.0'\noriginal_date: '2024-12-19'\ndate: '2024-12-20'\n---\n\n_History:_\n\n* _20/12/2024 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn December 19, 2024, Sophos has released critical security updates addressing multiple vulnerabilities in its firewall products. These flaws could allow attackers to escalate privileges or execute arbitrary code [1,2].\n\n# Technical Details\n\nThe vulnerability **CVE-2024-12727**, with a CVSS score of 9.8, is a pre-auth SQL injection vulnerability in the email protection feature allowing access to the reporting database of Sophos Firewall. If exploited, this vulnerability could lead to remote code execution on the affected device. This vulnerability affects devices with a specific configuration where Secure PDF eXchange (SPX) is enabled in combination with the firewall running in High Availability (HA) mode.\n\nThe vulnerability **CVE-2024-12728**, with a CVSS score of 9.8, is due to the suggested and non-random SSH login passphrase for High Availability (HA) cluster initialisation remaining active after the HA establishment process is completed. If exploited, this vulnerability could expose a privileged system account on the Sophos Firewall if SSH is enabled.\n\nThe vulnerability **CVE-2024-12729**, with a CVSS score of 8.8, is a post-auth code injection vulnerability in the User Portal allowing authenticated users to gain remote code execution.\n\n# Affected Products\n\nThese vulnerabilities affects Sophos Firewall v21.0 GA (21.0.0) and older versions.\n\n# Recommendations\n\nIt is recommended applying the hotfixes or the workarounds (described below) provided by the vendor.\n\n## Workarounds\n\n### CVE-2024-12728\n\nTo mitigate the issue of the SSH passphrase (used during deployment of HA ports) remaining active, customers can ensure that:\n\n* SSH access is restricted to only the dedicated HA link that is physically separate, and/or\n* HA is reconfigured using a sufficiently long and random custom passphrase\n\nIt is also recommended disabling WAN access via SSH by following device access best practices[3] and instead use VPN and/or Sophos Central for remote access and management.\n\n### CVE-2024-12729\n\nIt is recommended ensuring that the User Portal and Webadmin console are not exposed to the Internet.\n\n# References\n\n[1] <https://www.sophos.com/en-us/security-advisories/sophos-sa-20241219-sfos-rce>\n\n[2] <https://cybersecuritynews.com/sophos-firewall-vulnerabilities/>\n\n[3] <https://docs.sophos.com/nsg/sophos-firewall/latest/Help/en-us/webhelp/onlinehelp/AdministratorHelp/Administration/DeviceAccess/index.html>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>20/12/2024 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On December 19, 2024, Sophos has released critical security updates addressing multiple vulnerabilities in its firewall products. These flaws could allow attackers to escalate privileges or execute arbitrary code [1,2].</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability <strong>CVE-2024-12727</strong>, with a CVSS score of 9.8, is a pre-auth SQL injection vulnerability in the email protection feature allowing access to the reporting database of Sophos Firewall. If exploited, this vulnerability could lead to remote code execution on the affected device. This vulnerability affects devices with a specific configuration where Secure PDF eXchange (SPX) is enabled in combination with the firewall running in High Availability (HA) mode.</p><p>The vulnerability <strong>CVE-2024-12728</strong>, with a CVSS score of 9.8, is due to the suggested and non-random SSH login passphrase for High Availability (HA) cluster initialisation remaining active after the HA establishment process is completed. If exploited, this vulnerability could expose a privileged system account on the Sophos Firewall if SSH is enabled.</p><p>The vulnerability <strong>CVE-2024-12729</strong>, with a CVSS score of 8.8, is a post-auth code injection vulnerability in the User Portal allowing authenticated users to gain remote code execution.</p><h2 id=\"affected-products\">Affected Products</h2><p>These vulnerabilities affects Sophos Firewall v21.0 GA (21.0.0) and older versions.</p><h2 id=\"recommendations\">Recommendations</h2><p>It is recommended applying the hotfixes or the workarounds (described below) provided by the vendor.</p><h3 id=\"workarounds\">Workarounds</h3><h4 id=\"cve-2024-12728\">CVE-2024-12728</h4><p>To mitigate the issue of the SSH passphrase (used during deployment of HA ports) remaining active, customers can ensure that:</p><ul><li>SSH access is restricted to only the dedicated HA link that is physically separate, and/or</li><li>HA is reconfigured using a sufficiently long and random custom passphrase</li></ul><p>It is also recommended disabling WAN access via SSH by following device access best practices[3] and instead use VPN and/or Sophos Central for remote access and management.</p><h4 id=\"cve-2024-12729\">CVE-2024-12729</h4><p>It is recommended ensuring that the User Portal and Webadmin console are not exposed to the Internet.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.sophos.com/en-us/security-advisories/sophos-sa-20241219-sfos-rce\">https://www.sophos.com/en-us/security-advisories/sophos-sa-20241219-sfos-rce</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://cybersecuritynews.com/sophos-firewall-vulnerabilities/\">https://cybersecuritynews.com/sophos-firewall-vulnerabilities/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.sophos.com/nsg/sophos-firewall/latest/Help/en-us/webhelp/onlinehelp/AdministratorHelp/Administration/DeviceAccess/index.html\">https://docs.sophos.com/nsg/sophos-firewall/latest/Help/en-us/webhelp/onlinehelp/AdministratorHelp/Administration/DeviceAccess/index.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2024-12727",
    "CVE-2024-12728",
    "CVE-2024-12729"
  ]
}