{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2024-099.pdf"
  },
  "title": "Critical Vulnerabilities in Openshift",
  "serial_number": "2024-099",
  "publish_date": "18-09-2024 12:13:00",
  "description": "On 16th of September 2024, two vulnerabilities (CVE-2024-45496 and CVE-2024-7387) have been discovered in Red Hat systems that allow attackers to escalate privileges or execute arbitrary code, impacting system integrity.<br>\n",
  "url_title": "2024-099",
  "content_markdown": "---\ntitle: 'Critical Vulnerabilities in Openshift'\nnumber: '2024-099'\nversion: '1.0'\noriginal_date: 'September 16, 2024'\ndate: 'September 17, 2024'\n---\n\n_History:_\n\n* _17/09/2024 --- v1.0 -- Initial publication_\n\n\n# Summary\n\nOn 16th of September 2024, two vulnerabilities (CVE-2024-45496 and CVE-2024-7387) have been discovered in Red Hat systems that allow attackers to escalate privileges or execute arbitrary code, impacting system integrity [1,2].\n\n# Technical Details\n\nThe vulnerability **CVE-2024-45496** with a CVSS score of 9.9, arises from the misuse of elevated privileges during the build process [1]. The `git-clone` container runs with privileged access, allowing attackers with developer-level permission to exploit a crafted `.gitconfig` file. This enables arbitrary command execution on the worker node. An attacker in a privileged container could escalate permission on the node, gaining unauthorised control.\n\n\nThe vulnerability **CVE-2024-7387** with a CVSS score of 9.1, allows command injection via path traversal. By exploiting the `spec.source.secrets.secret.destinationDir` attribute in the `BuildConfig` definition [2]. A malicious user can override executable files inside the privileged build container when using the \"Docker\" strategy. This leads to arbitrary command execution on the OpenShift node hosting the builder container. An attacker could use this to escalate their permission on the node, gaining unauthorised access and control.\n\n# Affected Products\n\n- `CVE-2024-45496` : Red Hat OpenShift Container Platform 4 -  `ose-openshift-controller-manager-container`\n- `CVE-2024-7387` : Red Hat OpenShift Container Platform 4 - `openshift4/ose-docker-builder`\n\n# Recommendations\n\nNo specific patch is currently available. Admins should follow the instructions in [3] to block use of the \"Docker\" build strategy on a cluster, or restrict the use to a set of highly trusted users, until the cluster can be upgraded.\n\n# References\n\n[1] <https://access.redhat.com/security/cve/CVE-2024-45496>\n\n[2] <https://access.redhat.com/security/cve/CVE-2024-7387>\n\n[3] <https://docs.openshift.com/container-platform/4.16/cicd/builds/securing-builds-by-strategy.html>",
  "content_html": "<p><em>History:</em></p><ul><li><em>17/09/2024 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On 16th of September 2024, two vulnerabilities (CVE-2024-45496 and CVE-2024-7387) have been discovered in Red Hat systems that allow attackers to escalate privileges or execute arbitrary code, impacting system integrity [1,2].</p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability <strong>CVE-2024-45496</strong> with a CVSS score of 9.9, arises from the misuse of elevated privileges during the build process [1]. The <code>git-clone</code> container runs with privileged access, allowing attackers with developer-level permission to exploit a crafted <code>.gitconfig</code> file. This enables arbitrary command execution on the worker node. An attacker in a privileged container could escalate permission on the node, gaining unauthorised control.</p><p>The vulnerability <strong>CVE-2024-7387</strong> with a CVSS score of 9.1, allows command injection via path traversal. By exploiting the <code>spec.source.secrets.secret.destinationDir</code> attribute in the <code>BuildConfig</code> definition [2]. A malicious user can override executable files inside the privileged build container when using the \"Docker\" strategy. This leads to arbitrary command execution on the OpenShift node hosting the builder container. An attacker could use this to escalate their permission on the node, gaining unauthorised access and control.</p><h2 id=\"affected-products\">Affected Products</h2><ul><li><code>CVE-2024-45496</code> : Red Hat OpenShift Container Platform 4 - <code>ose-openshift-controller-manager-container</code></li><li><code>CVE-2024-7387</code> : Red Hat OpenShift Container Platform 4 - <code>openshift4/ose-docker-builder</code></li></ul><h2 id=\"recommendations\">Recommendations</h2><p>No specific patch is currently available. Admins should follow the instructions in [3] to block use of the \"Docker\" build strategy on a cluster, or restrict the use to a set of highly trusted users, until the cluster can be upgraded.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://access.redhat.com/security/cve/CVE-2024-45496\">https://access.redhat.com/security/cve/CVE-2024-45496</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://access.redhat.com/security/cve/CVE-2024-7387\">https://access.redhat.com/security/cve/CVE-2024-7387</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.openshift.com/container-platform/4.16/cicd/builds/securing-builds-by-strategy.html\">https://docs.openshift.com/container-platform/4.16/cicd/builds/securing-builds-by-strategy.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2024-45496",
    "CVE-2024-7387"
  ]
}