{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2023-062.pdf"
  },
  "title": "Cisco Remote Access VPN Vulnerability",
  "serial_number": "2023-062",
  "publish_date": "11-09-2023 15:04:13",
  "description": "On July 12, 2023, Cisco released an advisory to address a vulnerability in the remote access VPN feature of Cisco Adaptive Security Appliance (ASA) and Cisco Firepower Threat Defence (FTD) software. It could allow an unauthenticated, remote attacker to conduct a brute force attack in an attempt to identify valid username and password combinations or an authenticated, remote attacker to establish a client-less SSL VPN session with an unauthorised user.<br>\nIn addition, Cisco warns that the vulnerability could be actively exploited by ransomware groups to gain initial access to corporate networks.<br>\n",
  "url_title": "2023-062",
  "content_markdown": "--- \ntitle: 'Cisco Remote Access VPN Vulnerability' \nversion: '1.0'\nnumber: '2023-062'\noriginal_date: 'September 6, 2023'\ndate: 'September 11, 2023'\n---\n\n_History:_\n\n* _11/09/2023 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn July 12, 2023, Cisco released an advisory to address a vulnerability in the remote access VPN feature of Cisco Adaptive Security Appliance (ASA) and Cisco Firepower Threat Defence (FTD) software. It could allow an unauthenticated, remote attacker to conduct a brute force attack in an attempt to identify valid username and password combinations or an authenticated, remote attacker to establish a client-less SSL VPN session with an unauthorised user [1].\n\nIn addition, Cisco warns that the vulnerability could be actively exploited by ransomware groups to gain initial access to corporate networks [2].\n\n# Technical Details\n\nThis vulnerability is due to improper separation of authentication, authorisation, and accounting (AAA) between the remote access VPN feature and the HTTPS management and site-to-site VPN features. An attacker could exploit this vulnerability by specifying a default connection profile/tunnel group while conducting a brute force attack or while establishing a client-less SSL VPN session using valid credentials. A successful exploit could allow the attacker to achieve one or both of the following [1]:\n\n- Identify valid credentials that could then be used to establish an unauthorised remote access VPN session.\n- Establish a client-less SSL VPN session (only when running Cisco ASA Software Release 9.16 or earlier).\n\nIt is worth to note that:\n\n- Establishing a client-based remote access VPN tunnel is not possible as these default connection profiles/tunnel groups do not and cannot have an IP address pool configured.\n- This vulnerability does not allow an attacker to bypass authentication. To successfully establish a remote access VPN session, valid credentials are required, including a valid second factor if multi-factor authentication (MFA) is configured [1].\n\n## Detection\n\nIndicators of compromise for this vulnerability are as follows [1]:\n\n- Brute force attack: seeing a high rate of `syslog` message `%ASA-6-113015`, which reports a failed authentication attempt, can indicate a brute force or password spraying attack.\n- Unauthorised client-less SSL VPN session establishment: Seeing a session establishment attempt (`syslog` message `%ASA-7-734003`) or termination event (`syslog` message `%ASA-4-113019`) that reports one of the following unexpected connection profiles/tunnel groups can indicate successful or attempted establishment of an unauthorised client-less SSL VPN session: `DefaultADMINGroup` or `DefaultL2LGroup`.\n\n# Affected Products\n\nThis vulnerability affected Cisco devices if they were running a vulnerable release of Cisco Adaptive Security Appliance (ASA) Software or Cisco Firepower Threat Defence (FTD) software and some conditions are met. Please refer to the Cisco advisory to find the conditions [1].\n\nIn addition, Cisco has confirmed that this vulnerability does not affect the following Cisco products [1]:\n\n- Firepower Management Center (FMC) Software;\n- FXOS Software;\n- IOS Software;\n- IOS XE Software;\n- IOS XR Software;\n- NX-OS Software.\n\n# Recommendations\n\nCisco will release software updates that address this vulnerability. Until fixes are made available, please review and implement workarounds that address this vulnerability.\n\n## Workarounds\n\nWhile there is no method to completely prevent a brute force attack attempt, you can implement the following recommendations to protect against unauthorised client-less SSL VPN session establishment using the `DefaultADMINGroup` or `DefaultL2LGroup` connection profiles/tunnel groups [1]:\n\n- configure a dynamic access policy (DAP) to terminate VPN tunnel establishment when the `DefaultADMINGroup` or `DefaultL2LGroup` connection profile/tunnel group is used;\n- deny remote access VPN using the default group policy (`DfltGrpPolicy`);\n- restrict users in the `LOCAL` user database\n- lock users to a specific connection profile/tunnel group only;\n- prevent users from establishing remote access VPN sessions.\n\n# References\n\n[1] <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ravpn-auth-8LyfCkeC#fs>\n\n[2] <https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication>\n",
  "content_html": "<p><em>History:</em></p><ul><li><em>11/09/2023 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On July 12, 2023, Cisco released an advisory to address a vulnerability in the remote access VPN feature of Cisco Adaptive Security Appliance (ASA) and Cisco Firepower Threat Defence (FTD) software. It could allow an unauthenticated, remote attacker to conduct a brute force attack in an attempt to identify valid username and password combinations or an authenticated, remote attacker to establish a client-less SSL VPN session with an unauthorised user [1].</p><p>In addition, Cisco warns that the vulnerability could be actively exploited by ransomware groups to gain initial access to corporate networks [2].</p><h2 id=\"technical-details\">Technical Details</h2><p>This vulnerability is due to improper separation of authentication, authorisation, and accounting (AAA) between the remote access VPN feature and the HTTPS management and site-to-site VPN features. An attacker could exploit this vulnerability by specifying a default connection profile/tunnel group while conducting a brute force attack or while establishing a client-less SSL VPN session using valid credentials. A successful exploit could allow the attacker to achieve one or both of the following [1]:</p><ul><li>Identify valid credentials that could then be used to establish an unauthorised remote access VPN session.</li><li>Establish a client-less SSL VPN session (only when running Cisco ASA Software Release 9.16 or earlier).</li></ul><p>It is worth to note that:</p><ul><li>Establishing a client-based remote access VPN tunnel is not possible as these default connection profiles/tunnel groups do not and cannot have an IP address pool configured.</li><li>This vulnerability does not allow an attacker to bypass authentication. To successfully establish a remote access VPN session, valid credentials are required, including a valid second factor if multi-factor authentication (MFA) is configured [1].</li></ul><h3 id=\"detection\">Detection</h3><p>Indicators of compromise for this vulnerability are as follows [1]:</p><ul><li>Brute force attack: seeing a high rate of <code>syslog</code> message <code>%ASA-6-113015</code>, which reports a failed authentication attempt, can indicate a brute force or password spraying attack.</li><li>Unauthorised client-less SSL VPN session establishment: Seeing a session establishment attempt (<code>syslog</code> message <code>%ASA-7-734003</code>) or termination event (<code>syslog</code> message <code>%ASA-4-113019</code>) that reports one of the following unexpected connection profiles/tunnel groups can indicate successful or attempted establishment of an unauthorised client-less SSL VPN session: <code>DefaultADMINGroup</code> or <code>DefaultL2LGroup</code>.</li></ul><h2 id=\"affected-products\">Affected Products</h2><p>This vulnerability affected Cisco devices if they were running a vulnerable release of Cisco Adaptive Security Appliance (ASA) Software or Cisco Firepower Threat Defence (FTD) software and some conditions are met. Please refer to the Cisco advisory to find the conditions [1].</p><p>In addition, Cisco has confirmed that this vulnerability does not affect the following Cisco products [1]:</p><ul><li>Firepower Management Center (FMC) Software;</li><li>FXOS Software;</li><li>IOS Software;</li><li>IOS XE Software;</li><li>IOS XR Software;</li><li>NX-OS Software.</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>Cisco will release software updates that address this vulnerability. Until fixes are made available, please review and implement workarounds that address this vulnerability.</p><h3 id=\"workarounds\">Workarounds</h3><p>While there is no method to completely prevent a brute force attack attempt, you can implement the following recommendations to protect against unauthorised client-less SSL VPN session establishment using the <code>DefaultADMINGroup</code> or <code>DefaultL2LGroup</code> connection profiles/tunnel groups [1]:</p><ul><li>configure a dynamic access policy (DAP) to terminate VPN tunnel establishment when the <code>DefaultADMINGroup</code> or <code>DefaultL2LGroup</code> connection profile/tunnel group is used;</li><li>deny remote access VPN using the default group policy (<code>DfltGrpPolicy</code>);</li><li>restrict users in the <code>LOCAL</code> user database</li><li>lock users to a specific connection profile/tunnel group only;</li><li>prevent users from establishing remote access VPN sessions.</li></ul><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ravpn-auth-8LyfCkeC#fs\">https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-ravpn-auth-8LyfCkeC#fs</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication\">https://blogs.cisco.com/security/akira-ransomware-targeting-vpns-without-multi-factor-authentication</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": []
}