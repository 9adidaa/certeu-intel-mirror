{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2023-094.pdf"
  },
  "title": "Multiple Critical Vulnerabilities in Atlassian Products",
  "serial_number": "2023-094",
  "publish_date": "06-12-2023 11:11:25",
  "description": "On December 5, 2023, Atlassian released several security advisories regarding critical vulnerabilities affecting multiple Atlassian products. The exploitation of these vulnerabilities could lead to Remote Code Execution.<br>\nIt is recommended to upgrade to a fixed version as soon as possible.<br>\n",
  "url_title": "2023-094",
  "content_markdown": "---\ntitle: 'Multiple Critical Vulnerabilities in Atlassian Products'\nnumber: '2023-094'\nversion: '1.0'\noriginal_date: 'December 5, 2023'\ndate: 'December 6, 2023'\n---\n\n_History:_\n\n* _06/12/2023 --- v1.0 -- Initial publication_\n\n# Summary\n\nOn December 5, 2023, Atlassian released several security advisories regarding critical vulnerabilities affecting multiple Atlassian products [1]. The exploitation of these vulnerabilities could lead to Remote Code Execution.\n\nIt is recommended to upgrade to a fixed version as soon as possible.\n\n# Technical Details\n\n- The vulnerability **CVE-2022-1471** [2], with a CVSS score of 9.8 out 10, lies in the SnakeYaml library. This library's Constructor() class does not restrict types which can be instantiated during deserialisation. Deserialising yaml content provided by an attacker can lead to remote code execution [3].\n- The vulnerability **CVE-2023-22522** [4], with a CVSS score of 9.0 out of 10, is a Template Injection vulnerability that would allow an authenticated attacker, including one with anonymous access, to inject unsafe user input into a Confluence page. Using this approach, an attacker is able to achieve RCE on an affected instance.\n- The vulnerability **CVE-2023-22523** [5], with a CVSS score of 9.8 out of 10, lies in the Assets Discovery, which can be downloaded via Atlassian Marketplace, and which is a stand-alone network scanning tool that can be used with or without an agent with Jira Service Management Cloud, Data Center or Server. This vulnerability, if exploited, allows an attacker to perform privileged RCE (Remote Code Execution) on machines with the Assets Discovery agent installed. The vulnerability exists between the Assets Discovery application (formerly known as Insight Discovery) and the Assets Discovery agent.\n- The vulnerability **CVE-2023-22524** [6], with a CVSS score of 9.6 out of 10, exists in the Atlassian Companion App desktop application for MacOS. An attacker could utilise WebSockets to bypass Atlassian Companion’s blocklist and MacOS Gatekeeper to allow the execution of code.\n\n# Affected Products\n\n- The vulnerability **CVE-2022-1471** affects the following products:\n    - Automation for Jira app (including Server Lite edition)\n    - Bitbucket Data Center\n    - Bitbucket Server\n    - Confluence Data Center\n    - Confluence Server\n    - Confluence Cloud Migration App\n    - Jira Core Data Center\n    - Jira Core Server\n    - Jira Service Management Data Center\n    - Jira Service Management Server\n    - Jira Software Data Center\n    - Jira Software Server\n\n_Please, refer to the Atlassian advisory for the exact version identifiers._\n\n- The vulnerability **CVE-2023-22522** affects:\n    - Confluence Data Center 8.6.0, and 8.6.1.\n    - Confluence Server versions 4, 5, 6, 7, and 8 (_Please, refer to the Atlassian advisory for the exact version identifiers._)\n\n- The vulnerability **CVE-2023-22523** affects all versions prior to Assets Discovery 3.2.0-cloud / 6.2.0 data center and server.\n\n- The vulnerability **CVE-2023-22524** affects all versions of the Atlassian Companion App for MacOS before `2.0.0`.\n\n# Recommendations\n\nIt is recommended applying patches and updates as soon as possible, as per Atlassian advisories [2, 4, 5, 6].\n\n## Mitigations\n\n- **CVE-2023-22522**:\n\nIf it is not possible to apply the latest fixes, it is recommended to back up the affected instances, and remove them from the Internet until the patch is applied.\n\n- **CVE-2023-22523**:\n\nIt is possible to mitigate the vulnerability, until the latest version is applied, by blocking the port used for communication with agents (the default port is 51337). This temporary mitigation is not a replacement for uninstalling the agents.\n\n- **CVE-2023-22524**\n\nIf the Atlassian Companion App for MacOS is not showing a fixed version, and it is not possible to patch, one can completely mitigate this vulnerability by uninstalling the Atlassian Companion App.\n\n\n\n# References\n\n[1] <https://confluence.atlassian.com/security/december-2023-security-advisories-overview-1318892103.html>\n\n[2] <https://confluence.atlassian.com/security/cve-2022-1471-snakeyaml-library-rce-vulnerability-in-multiple-products-1296171009.html>\n\n[3] <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1471>\n\n[4] <https://confluence.atlassian.com/security/cve-2023-22522-rce-vulnerability-in-confluence-data-center-and-confluence-server-1319570362.html>\n\n[5] <https://confluence.atlassian.com/security/cve-2023-22523-rce-vulnerability-in-assets-discovery-1319248914.html>\n\n[6] <https://confluence.atlassian.com/security/cve-2023-22524-rce-vulnerability-in-atlassian-companion-app-for-macos-1319249492.html>",
  "content_html": "<p><em>History:</em></p><ul><li><em>06/12/2023 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On December 5, 2023, Atlassian released several security advisories regarding critical vulnerabilities affecting multiple Atlassian products [1]. The exploitation of these vulnerabilities could lead to Remote Code Execution.</p><p>It is recommended to upgrade to a fixed version as soon as possible.</p><h2 id=\"technical-details\">Technical Details</h2><ul><li>The vulnerability <strong>CVE-2022-1471</strong> [2], with a CVSS score of 9.8 out 10, lies in the SnakeYaml library. This library's Constructor() class does not restrict types which can be instantiated during deserialisation. Deserialising yaml content provided by an attacker can lead to remote code execution [3].</li><li>The vulnerability <strong>CVE-2023-22522</strong> [4], with a CVSS score of 9.0 out of 10, is a Template Injection vulnerability that would allow an authenticated attacker, including one with anonymous access, to inject unsafe user input into a Confluence page. Using this approach, an attacker is able to achieve RCE on an affected instance.</li><li>The vulnerability <strong>CVE-2023-22523</strong> [5], with a CVSS score of 9.8 out of 10, lies in the Assets Discovery, which can be downloaded via Atlassian Marketplace, and which is a stand-alone network scanning tool that can be used with or without an agent with Jira Service Management Cloud, Data Center or Server. This vulnerability, if exploited, allows an attacker to perform privileged RCE (Remote Code Execution) on machines with the Assets Discovery agent installed. The vulnerability exists between the Assets Discovery application (formerly known as Insight Discovery) and the Assets Discovery agent.</li><li>The vulnerability <strong>CVE-2023-22524</strong> [6], with a CVSS score of 9.6 out of 10, exists in the Atlassian Companion App desktop application for MacOS. An attacker could utilise WebSockets to bypass Atlassian Companion’s blocklist and MacOS Gatekeeper to allow the execution of code.</li></ul><h2 id=\"affected-products\">Affected Products</h2><ul><li>The vulnerability <strong>CVE-2022-1471</strong> affects the following products: <ul><li>Automation for Jira app (including Server Lite edition)</li><li>Bitbucket Data Center</li><li>Bitbucket Server</li><li>Confluence Data Center</li><li>Confluence Server</li><li>Confluence Cloud Migration App</li><li>Jira Core Data Center</li><li>Jira Core Server</li><li>Jira Service Management Data Center</li><li>Jira Service Management Server</li><li>Jira Software Data Center</li><li>Jira Software Server</li></ul></li></ul><p><em>Please, refer to the Atlassian advisory for the exact version identifiers.</em></p><ul><li><p>The vulnerability <strong>CVE-2023-22522</strong> affects:</p><ul><li>Confluence Data Center 8.6.0, and 8.6.1.</li><li>Confluence Server versions 4, 5, 6, 7, and 8 (<em>Please, refer to the Atlassian advisory for the exact version identifiers.</em>)</li></ul></li><li><p>The vulnerability <strong>CVE-2023-22523</strong> affects all versions prior to Assets Discovery 3.2.0-cloud / 6.2.0 data center and server.</p></li><li><p>The vulnerability <strong>CVE-2023-22524</strong> affects all versions of the Atlassian Companion App for MacOS before <code>2.0.0</code>.</p></li></ul><h2 id=\"recommendations\">Recommendations</h2><p>It is recommended applying patches and updates as soon as possible, as per Atlassian advisories [2, 4, 5, 6].</p><h3 id=\"mitigations\">Mitigations</h3><ul><li><strong>CVE-2023-22522</strong>:</li></ul><p>If it is not possible to apply the latest fixes, it is recommended to back up the affected instances, and remove them from the Internet until the patch is applied.</p><ul><li><strong>CVE-2023-22523</strong>:</li></ul><p>It is possible to mitigate the vulnerability, until the latest version is applied, by blocking the port used for communication with agents (the default port is 51337). This temporary mitigation is not a replacement for uninstalling the agents.</p><ul><li><strong>CVE-2023-22524</strong></li></ul><p>If the Atlassian Companion App for MacOS is not showing a fixed version, and it is not possible to patch, one can completely mitigate this vulnerability by uninstalling the Atlassian Companion App.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://confluence.atlassian.com/security/december-2023-security-advisories-overview-1318892103.html\">https://confluence.atlassian.com/security/december-2023-security-advisories-overview-1318892103.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://confluence.atlassian.com/security/cve-2022-1471-snakeyaml-library-rce-vulnerability-in-multiple-products-1296171009.html\">https://confluence.atlassian.com/security/cve-2022-1471-snakeyaml-library-rce-vulnerability-in-multiple-products-1296171009.html</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1471\">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1471</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://confluence.atlassian.com/security/cve-2023-22522-rce-vulnerability-in-confluence-data-center-and-confluence-server-1319570362.html\">https://confluence.atlassian.com/security/cve-2023-22522-rce-vulnerability-in-confluence-data-center-and-confluence-server-1319570362.html</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://confluence.atlassian.com/security/cve-2023-22523-rce-vulnerability-in-assets-discovery-1319248914.html\">https://confluence.atlassian.com/security/cve-2023-22523-rce-vulnerability-in-assets-discovery-1319248914.html</a></p><p>[6] <a rel=\"noopener\" target=\"_blank\" href=\"https://confluence.atlassian.com/security/cve-2023-22524-rce-vulnerability-in-atlassian-companion-app-for-macos-1319249492.html\">https://confluence.atlassian.com/security/cve-2023-22524-rce-vulnerability-in-atlassian-companion-app-for-macos-1319249492.html</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2022-1471",
    "CVE-2023-22522",
    "CVE-2023-22523",
    "CVE-2023-22524"
  ]
}