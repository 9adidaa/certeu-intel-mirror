{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2023-004.pdf"
  },
  "title": "Critical Vulnerability in Several ManageEngine Products",
  "serial_number": "2023-004",
  "publish_date": "30-01-2023 09:15:00",
  "description": "On January 18th, ManageEngine released updates to several ManageEngine OnPremise products. The potentially vulnerable products use outdated versions of the open-source library Apache Santuario (XML Security for Java). Products must have enabled Single-Sign-On (SSO) using the Security Assertion Markup Language (SAML) to be vulnerable. For some products, the SSO must be active, while for others, it is sufficient that SSO was active once. As a result, the vulnerability allows an unauthenticated adversary to execute arbitrary code. Additionally, a Proof-of-Concept exploit is available.",
  "url_title": "2023-004",
  "content_markdown": "---\ntitle: 'Critical Vulnerability in Several ManageEngine Products'\nversion: '1.0'\nnumber: '2023-004'\noriginal_date: 'January 18, 2023'\ndate: 'January 30, 2023'\n---\n\n_History:_\n\n* _30/01/2023 --- v1.0 -- Initial publication_\n  \n# Summary\n\nOn January 18th, ManageEngine released updates to several ManageEngine OnPremise products [1]. The potentially vulnerable products use outdated versions of the open-source library Apache Santuario (XML Security for Java). Products must have enabled Single-Sign-On (SSO) using the Security Assertion Markup Language (SAML) to be vulnerable. For some products, the SSO must be active, while for others, it is sufficient that SSO was active once. As a result, the vulnerability allows an unauthenticated adversary to execute arbitrary code. Additionally, a Proof-of-Concept exploit is available [2].\n\n# Technical Details\n\nManageEngine uses different versions of Apache Santuario in various products. The vulnerability CVE-2022-47966 exploits the combination of two issues in the library's version below version 2.2.3.\n\nThe primary issue affects the SAML validation order. The vulnerable library performs reference validation before signature validation. This behaviour allows the injection of arbitrary XSL Transformations, which enables the attacker to execute arbitrary Java code [3,4].\n\nSuppose Single-Sign-On (SSO) is enabled using the Security Assertion Markup Language (SAML). In that case, an attacker can exploit the vulnerability by sending a malicious SAML Response to the Assertion Consumer URL of the ManageEngine product. Based on the product, e.g., the AD-related products like AdManager, there might be additional checks on the SAML response. However, an attacker can bypass these checks without much extra effort.\n\n# Affected Products\n\n| Product Name | Impacted Version(s) | Fixed Version(s) | Released On |\n|:------------------|:-------------------:|:-------------:|:-----------:|\n| Access Manager Plus* | 4307 and below | \t4308 |  \t7/11/2022 | \n| Active Directory 360** | \t4309 and below | 4310 | 28/10/2022 | \n| ADAudit Plus** | \t7080 and below | 7081 | 28/10/2022 | \n| ADManager Plus** | 7161 and below | 7162 | 28/10/2022 | \n| ADSelfService Plus** | 6210 and below | 6211 | 28/10/2022 | \n| Analytics Plus* | 5140 and below | 5150 | 7/11/2022 | \n| Application Control Plus* | 10.1.2220.17 and below | \t10.1.2220.18 | 28/10/2022 | \n| Asset Explorer** | 6982 and below | 6983 | 27/10/2022 | \n| Browser Security Plus* | 11.1.2238.5 and below | 11.1.2238.6 | 28/10/2022 | \n| Device Control Plus* \t| 10.1.2220.17 and below | \t10.1.2220.18 | \t28/10/2022 | \n| Endpoint Central* | \t10.1.2228.10 and below | 10.1.2228.11 | 28/10/2022 | \n| Endpoint Central MSP* | 10.1.2228.10 and below | \t10.1.2228.11 | \t28/10/2022 | \n| Endpoint DLP* | 10.1.2137.5 and below | 10.1.2137.6 | \t28/10/2022 | \n| Key Manager Plus* | \t6400 and below | 6401 | 27/10/2022 | \n| OS Deployer* | 1.1.2243.0 and below | 1.1.2243.1 | \t28/10/2022 | \n| PAM 360* \t| 5712 and below | 5713 | 7/11/2022 | \n| Password Manager Pro* | 12123 and below | 12124 | 7/11/2022 | \n| Patch Manager Plus* | 10.1.2220.17 and below | 10.1.2220.18 | 28/10/2022 | \n| Remote Access Plus* | 10.1.2228.10 and below | 10.1.2228.11 | 28/10/2022 | \n| Remote Monitoring and Management (RMM)* | 10.1.40 and below | 10.1.41 | 29/10/2022 | \n| ServiceDesk Plus** | 14003 and below | 14004 | 27/10/2022 | \n| ServiceDesk Plus MSP** | 13000 and below | 13001 | 27/10/2022 | \n| SupportCenter Plus** | 11017 to 11025 | 11026 | 28/10/2022 | \n| Vulnerability Manager Plus* | 10.1.2220.17 and below | 10.1.2220.18 | 28/10/2022 | \n\n_* - Applicable only if configured SAML-based SSO and it is currently active._\n\n_** - Applicable only if configured SAML-based SSO at least once in the past, regardless of the current SAML-based SSO status._\n\n\n# Recommendations\n\nCERT-EU recommends to update potentially vulnerable products to the latest version.\n\nDeactivating the SAML-based SSO configuration can be a short-term solution for applicable products until the update could be performed.\n\n\n# References\n\n[1] <https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html>\n\n[2] <https://github.com/horizon3ai/CVE-2022-47966>\n\n[3] <https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/>\n\n[4] <https://blog.viettelcybersecurity.com/saml-show-stopper/>",
  "content_html": "<p><em>History:</em></p><ul><li><em>30/01/2023 --- v1.0 -- Initial publication</em></li></ul><h2 id=\"summary\">Summary</h2><p>On January 18th, ManageEngine released updates to several ManageEngine OnPremise products [1]. The potentially vulnerable products use outdated versions of the open-source library Apache Santuario (XML Security for Java). Products must have enabled Single-Sign-On (SSO) using the Security Assertion Markup Language (SAML) to be vulnerable. For some products, the SSO must be active, while for others, it is sufficient that SSO was active once. As a result, the vulnerability allows an unauthenticated adversary to execute arbitrary code. Additionally, a Proof-of-Concept exploit is available [2].</p><h2 id=\"technical-details\">Technical Details</h2><p>ManageEngine uses different versions of Apache Santuario in various products. The vulnerability CVE-2022-47966 exploits the combination of two issues in the library's version below version 2.2.3.</p><p>The primary issue affects the SAML validation order. The vulnerable library performs reference validation before signature validation. This behaviour allows the injection of arbitrary XSL Transformations, which enables the attacker to execute arbitrary Java code [3,4].</p><p>Suppose Single-Sign-On (SSO) is enabled using the Security Assertion Markup Language (SAML). In that case, an attacker can exploit the vulnerability by sending a malicious SAML Response to the Assertion Consumer URL of the ManageEngine product. Based on the product, e.g., the AD-related products like AdManager, there might be additional checks on the SAML response. However, an attacker can bypass these checks without much extra effort.</p><h2 id=\"affected-products\">Affected Products</h2><table><thead><tr><th style=\"text-align:left;\">Product Name</th><th style=\"text-align:center;\">Impacted Version(s)</th><th style=\"text-align:center;\">Fixed Version(s)</th><th style=\"text-align:center;\">Released On</th></tr></thead><tbody><tr><td style=\"text-align:left;\">Access Manager Plus*</td><td style=\"text-align:center;\">4307 and below</td><td style=\"text-align:center;\">4308</td><td style=\"text-align:center;\">7/11/2022</td></tr><tr><td style=\"text-align:left;\">Active Directory 360**</td><td style=\"text-align:center;\">4309 and below</td><td style=\"text-align:center;\">4310</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">ADAudit Plus**</td><td style=\"text-align:center;\">7080 and below</td><td style=\"text-align:center;\">7081</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">ADManager Plus**</td><td style=\"text-align:center;\">7161 and below</td><td style=\"text-align:center;\">7162</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">ADSelfService Plus**</td><td style=\"text-align:center;\">6210 and below</td><td style=\"text-align:center;\">6211</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Analytics Plus*</td><td style=\"text-align:center;\">5140 and below</td><td style=\"text-align:center;\">5150</td><td style=\"text-align:center;\">7/11/2022</td></tr><tr><td style=\"text-align:left;\">Application Control Plus*</td><td style=\"text-align:center;\">10.1.2220.17 and below</td><td style=\"text-align:center;\">10.1.2220.18</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Asset Explorer**</td><td style=\"text-align:center;\">6982 and below</td><td style=\"text-align:center;\">6983</td><td style=\"text-align:center;\">27/10/2022</td></tr><tr><td style=\"text-align:left;\">Browser Security Plus*</td><td style=\"text-align:center;\">11.1.2238.5 and below</td><td style=\"text-align:center;\">11.1.2238.6</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Device Control Plus*</td><td style=\"text-align:center;\">10.1.2220.17 and below</td><td style=\"text-align:center;\">10.1.2220.18</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Endpoint Central*</td><td style=\"text-align:center;\">10.1.2228.10 and below</td><td style=\"text-align:center;\">10.1.2228.11</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Endpoint Central MSP*</td><td style=\"text-align:center;\">10.1.2228.10 and below</td><td style=\"text-align:center;\">10.1.2228.11</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Endpoint DLP*</td><td style=\"text-align:center;\">10.1.2137.5 and below</td><td style=\"text-align:center;\">10.1.2137.6</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Key Manager Plus*</td><td style=\"text-align:center;\">6400 and below</td><td style=\"text-align:center;\">6401</td><td style=\"text-align:center;\">27/10/2022</td></tr><tr><td style=\"text-align:left;\">OS Deployer*</td><td style=\"text-align:center;\">1.1.2243.0 and below</td><td style=\"text-align:center;\">1.1.2243.1</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">PAM 360*</td><td style=\"text-align:center;\">5712 and below</td><td style=\"text-align:center;\">5713</td><td style=\"text-align:center;\">7/11/2022</td></tr><tr><td style=\"text-align:left;\">Password Manager Pro*</td><td style=\"text-align:center;\">12123 and below</td><td style=\"text-align:center;\">12124</td><td style=\"text-align:center;\">7/11/2022</td></tr><tr><td style=\"text-align:left;\">Patch Manager Plus*</td><td style=\"text-align:center;\">10.1.2220.17 and below</td><td style=\"text-align:center;\">10.1.2220.18</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Remote Access Plus*</td><td style=\"text-align:center;\">10.1.2228.10 and below</td><td style=\"text-align:center;\">10.1.2228.11</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Remote Monitoring and Management (RMM)*</td><td style=\"text-align:center;\">10.1.40 and below</td><td style=\"text-align:center;\">10.1.41</td><td style=\"text-align:center;\">29/10/2022</td></tr><tr><td style=\"text-align:left;\">ServiceDesk Plus**</td><td style=\"text-align:center;\">14003 and below</td><td style=\"text-align:center;\">14004</td><td style=\"text-align:center;\">27/10/2022</td></tr><tr><td style=\"text-align:left;\">ServiceDesk Plus MSP**</td><td style=\"text-align:center;\">13000 and below</td><td style=\"text-align:center;\">13001</td><td style=\"text-align:center;\">27/10/2022</td></tr><tr><td style=\"text-align:left;\">SupportCenter Plus**</td><td style=\"text-align:center;\">11017 to 11025</td><td style=\"text-align:center;\">11026</td><td style=\"text-align:center;\">28/10/2022</td></tr><tr><td style=\"text-align:left;\">Vulnerability Manager Plus*</td><td style=\"text-align:center;\">10.1.2220.17 and below</td><td style=\"text-align:center;\">10.1.2220.18</td><td style=\"text-align:center;\">28/10/2022</td></tr></tbody></table><p><em>* - Applicable only if configured SAML-based SSO and it is currently active.</em></p><p><em>** - Applicable only if configured SAML-based SSO at least once in the past, regardless of the current SAML-based SSO status.</em></p><h2 id=\"recommendations\">Recommendations</h2><p>CERT-EU recommends to update potentially vulnerable products to the latest version.</p><p>Deactivating the SAML-based SSO configuration can be a short-term solution for applicable products until the update could be performed.</p><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html\">https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://github.com/horizon3ai/CVE-2022-47966\">https://github.com/horizon3ai/CVE-2022-47966</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/\">https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://blog.viettelcybersecurity.com/saml-show-stopper/\">https://blog.viettelcybersecurity.com/saml-show-stopper/</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2022-47966"
  ]
}