{
  "file_item": {
    "filepath": "security-advisories",
    "filename": "CERT-EU-SA2023-038.pdf"
  },
  "title": "Critical Vulnerability in FortiOS",
  "serial_number": "2023-038",
  "publish_date": "13-06-2023 13:49:24",
  "description": "Fortinet has released several versions of FortiOS to patch a critical pre-authentication remote code execution (RCE) vulnerability in its Fortigate SSL VPN devices. The vulnerability, identified as CVE-2023-27997, allows a hostile agent to interfere via the VPN, even if Multi-Factor Authentication (MFA) is activated. <br>\n",
  "url_title": "2023-038",
  "content_markdown": "--- \ntitle: 'Critical Vulnerability inÂ FortiOS' \nversion: '1.1'\nnumber: '2023-038'\noriginal_date: 'June 11, 2023'\ndate: 'June 13, 2023'\n---\n\n_History:_\n\n* _12/06/2023 --- v1.0 -- Initial publication_\n* _13/06/2023 --- v1.1 -- Updated with information provided by Fortinet_\n\n# Summary\n\nFortinet has released several versions of FortiOS to patch a critical pre-authentication remote code execution (RCE) vulnerability in its Fortigate SSL VPN devices. The vulnerability, identified as CVE-2023-27997, allows a hostile agent to interfere via the VPN, even if Multi-Factor Authentication (MFA) is activated [1, 2]. \n\n# Technical Details\n\nThe vulnerability, CVE-2023-27997, does not require the attacker to be logged in to exploit it and is reachable pre-authentication on every SSL VPN appliance. The vulnerability is a heap-based overflow and may allow a remote attacker to execute arbitrary code via specifically crafted requests. While no public proof of concept is available at the writing of this security advisory, Fortinet notes that this vulnerability may have been exploited in a limited number of cases.  \nA number of additional vulnerabilities were also addressed in the patch.  \n\n| Incident ID |    NVD CVE    |  Product | CSSV | Description                                |\n|---------------|-------------------|--------|:-----:|--------------------------------------------|\n| FG-IR-23-111| CVE-2023-29180|  FortiOS |   7.3    | Null pointer de-reference in SSLVPNd       |\n| FG-IR-22-475| CVE-2023-22640|  FortiOS |   7.1    | Out-of-bound-write in SSLVPNd              |\n| FG-IR-23-119| CVE-2023-29181|  FortiOS |   8.3    | Format String Bug in Fclicense daemon      |\n| FG-IR-23-125| CVE-2023-29179|  FortiOS |   6.4    | Null pointer de-reference in SSLVPNd proxy |\n| FG-IR-22-479| CVE-2023-22641|  FortiOS |   4.1    | Open redirect in SSLVPNd                   |\n\n\n# Affected Products\n\nAt least the following FortiOS-6K7K versions are impacted:\n\n- FortiOS-6K7K version 7.0.10\n- FortiOS-6K7K version 7.0.5\n- FortiOS-6K7K version 6.4.12\n- FortiOS-6K7K version 6.4.10\n- FortiOS-6K7K version 6.4.8\n- FortiOS-6K7K version 6.4.6\n- FortiOS-6K7K version 6.4.2\n- FortiOS-6K7K version 6.2.9 through 6.2.13\n- FortiOS-6K7K version 6.2.6 through 6.2.7\n- FortiOS-6K7K version 6.2.4\n- FortiOS-6K7K version 6.0.12 through 6.0.16\n- FortiOS-6K7K version 6.0.10\n\nAt least the following FortiProxy versions are impacted:\n\n- FortiProxy version 7.2.0 through 7.2.3\n- FortiProxy version 7.0.0 through 7.0.9\n- FortiProxy version 2.0.0 through 2.0.12\n- FortiProxy 1.2 all versions\n- FortiProxy 1.1 all versions\n\nAt least the following FortiOS versions are impacted:\n\n- FortiOS version 7.2.0 through 7.2.4\n- FortiOS version 7.0.0 through 7.0.11\n- FortiOS version 6.4.0 through 6.4.12\n- FortiOS version 6.0.0 through 6.0.16\n\n# Recommendations\n\nGiven the severity of the vulnerability, enterprise administrators are advised to update their Fortigate devices as soon as possible. The vulnerability has been fixed in the following versions:  \n\n- FortiOS-6K7K version 7.0.12 or above\n- FortiOS-6K7K version 6.4.13 or above\n- FortiOS-6K7K version 6.2.15 or above\n- FortiOS-6K7K version 6.0.17 or above\n- FortiProxy version 7.2.4 or above\n- FortiProxy version 7.0.10 or above\n- FortiProxy version 2.0.13 or above\n- FortiOS version 7.4.0 or above\n- FortiOS version 7.2.5 or above\n- FortiOS version 7.0.12 or above\n- FortiOS version 6.4.13 or above\n- FortiOS version 6.2.14 or above\n- FortiOS version 6.0.17 or above\n\nIn addition of updating, the vendor recommends the following actions [3]: \n\n- review the systems for evidence of exploit of previous vulnerabilities, notably CVE-2022-04-0684 [4],\n- follow hardening recommendations [5],\n- minimise the attack surface by disabling unused features and managing devices via an out-of-band method wherever possible.\n\n# References\n\n[1] <https://www.bleepingcomputer.com/news/security/fortinet-fixes-critical-rce-flaw-in-fortigate-ssl-vpn-devices-patch-now/>\n\n[2] <https://www.helpnetsecurity.com/2023/06/11/cve-2023-27997/>\n\n[3] <https://www.fortiguard.com/psirt/FG-IR-23-097>\n\n[4] <https://www.fortiguard.com/psirt/FG-IR-22-377>\n\n[5] <https://docs.fortinet.com/document/fortigate/7.2.0/best-practices/555436/hardening>",
  "content_html": "<p><em>History:</em></p><ul><li><em>12/06/2023 --- v1.0 -- Initial publication</em></li><li><em>13/06/2023 --- v1.1 -- Updated with information provided by Fortinet</em></li></ul><h2 id=\"summary\">Summary</h2><p>Fortinet has released several versions of FortiOS to patch a critical pre-authentication remote code execution (RCE) vulnerability in its Fortigate SSL VPN devices. The vulnerability, identified as CVE-2023-27997, allows a hostile agent to interfere via the VPN, even if Multi-Factor Authentication (MFA) is activated [1, 2]. </p><h2 id=\"technical-details\">Technical Details</h2><p>The vulnerability, CVE-2023-27997, does not require the attacker to be logged in to exploit it and is reachable pre-authentication on every SSL VPN appliance. The vulnerability is a heap-based overflow and may allow a remote attacker to execute arbitrary code via specifically crafted requests. While no public proof of concept is available at the writing of this security advisory, Fortinet notes that this vulnerability may have been exploited in a limited number of cases. <br> A number of additional vulnerabilities were also addressed in the patch. </p><table><thead><tr><th>Incident ID</th><th>NVD CVE</th><th>Product</th><th style=\"text-align:center;\">CSSV</th><th>Description</th></tr></thead><tbody><tr><td>FG-IR-23-111</td><td>CVE-2023-29180</td><td>FortiOS</td><td style=\"text-align:center;\">7.3</td><td>Null pointer de-reference in SSLVPNd</td></tr><tr><td>FG-IR-22-475</td><td>CVE-2023-22640</td><td>FortiOS</td><td style=\"text-align:center;\">7.1</td><td>Out-of-bound-write in SSLVPNd</td></tr><tr><td>FG-IR-23-119</td><td>CVE-2023-29181</td><td>FortiOS</td><td style=\"text-align:center;\">8.3</td><td>Format String Bug in Fclicense daemon</td></tr><tr><td>FG-IR-23-125</td><td>CVE-2023-29179</td><td>FortiOS</td><td style=\"text-align:center;\">6.4</td><td>Null pointer de-reference in SSLVPNd proxy</td></tr><tr><td>FG-IR-22-479</td><td>CVE-2023-22641</td><td>FortiOS</td><td style=\"text-align:center;\">4.1</td><td>Open redirect in SSLVPNd</td></tr></tbody></table><h2 id=\"affected-products\">Affected Products</h2><p>At least the following FortiOS-6K7K versions are impacted:</p><ul><li>FortiOS-6K7K version 7.0.10</li><li>FortiOS-6K7K version 7.0.5</li><li>FortiOS-6K7K version 6.4.12</li><li>FortiOS-6K7K version 6.4.10</li><li>FortiOS-6K7K version 6.4.8</li><li>FortiOS-6K7K version 6.4.6</li><li>FortiOS-6K7K version 6.4.2</li><li>FortiOS-6K7K version 6.2.9 through 6.2.13</li><li>FortiOS-6K7K version 6.2.6 through 6.2.7</li><li>FortiOS-6K7K version 6.2.4</li><li>FortiOS-6K7K version 6.0.12 through 6.0.16</li><li>FortiOS-6K7K version 6.0.10</li></ul><p>At least the following FortiProxy versions are impacted:</p><ul><li>FortiProxy version 7.2.0 through 7.2.3</li><li>FortiProxy version 7.0.0 through 7.0.9</li><li>FortiProxy version 2.0.0 through 2.0.12</li><li>FortiProxy 1.2 all versions</li><li>FortiProxy 1.1 all versions</li></ul><p>At least the following FortiOS versions are impacted:</p><ul><li>FortiOS version 7.2.0 through 7.2.4</li><li>FortiOS version 7.0.0 through 7.0.11</li><li>FortiOS version 6.4.0 through 6.4.12</li><li>FortiOS version 6.0.0 through 6.0.16</li></ul><h2 id=\"recommendations\">Recommendations</h2><p>Given the severity of the vulnerability, enterprise administrators are advised to update their Fortigate devices as soon as possible. The vulnerability has been fixed in the following versions: </p><ul><li>FortiOS-6K7K version 7.0.12 or above</li><li>FortiOS-6K7K version 6.4.13 or above</li><li>FortiOS-6K7K version 6.2.15 or above</li><li>FortiOS-6K7K version 6.0.17 or above</li><li>FortiProxy version 7.2.4 or above</li><li>FortiProxy version 7.0.10 or above</li><li>FortiProxy version 2.0.13 or above</li><li>FortiOS version 7.4.0 or above</li><li>FortiOS version 7.2.5 or above</li><li>FortiOS version 7.0.12 or above</li><li>FortiOS version 6.4.13 or above</li><li>FortiOS version 6.2.14 or above</li><li>FortiOS version 6.0.17 or above</li></ul><p>In addition of updating, the vendor recommends the following actions [3]: </p><ul><li>review the systems for evidence of exploit of previous vulnerabilities, notably CVE-2022-04-0684 [4],</li><li>follow hardening recommendations [5],</li><li>minimise the attack surface by disabling unused features and managing devices via an out-of-band method wherever possible.</li></ul><h2 id=\"references\">References</h2><p>[1] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.bleepingcomputer.com/news/security/fortinet-fixes-critical-rce-flaw-in-fortigate-ssl-vpn-devices-patch-now/\">https://www.bleepingcomputer.com/news/security/fortinet-fixes-critical-rce-flaw-in-fortigate-ssl-vpn-devices-patch-now/</a></p><p>[2] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.helpnetsecurity.com/2023/06/11/cve-2023-27997/\">https://www.helpnetsecurity.com/2023/06/11/cve-2023-27997/</a></p><p>[3] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.fortiguard.com/psirt/FG-IR-23-097\">https://www.fortiguard.com/psirt/FG-IR-23-097</a></p><p>[4] <a rel=\"noopener\" target=\"_blank\" href=\"https://www.fortiguard.com/psirt/FG-IR-22-377\">https://www.fortiguard.com/psirt/FG-IR-22-377</a></p><p>[5] <a rel=\"noopener\" target=\"_blank\" href=\"https://docs.fortinet.com/document/fortigate/7.2.0/best-practices/555436/hardening\">https://docs.fortinet.com/document/fortigate/7.2.0/best-practices/555436/hardening</a></p>",
  "licence": {
    "title": "Creative Commons Attribution 4.0 International (CC-BY 4.0)",
    "link": "https://creativecommons.org/licenses/by/4.0/",
    "restrictions": "https://cert.europa.eu/legal-notice",
    "author": "The Cybersecurity Service for the Union institutions, bodies, offices and agencies"
  },
  "cves": [
    "CVE-2023-22640",
    "CVE-2023-22641",
    "CVE-2023-27997",
    "CVE-2023-29179",
    "CVE-2023-29180",
    "CVE-2023-29181"
  ]
}